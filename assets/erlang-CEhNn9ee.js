var S=["-type","-spec","-export_type","-opaque"],z=["after","begin","catch","case","cond","end","fun","if","let","of","query","receive","try","when"],W=/[\->,;]/,E=["->",";",","],U=["and","andalso","band","bnot","bor","bsl","bsr","bxor","div","not","or","orelse","rem","xor"],A=/[\+\-\*\/<>=\|:!]/,Z=["=","+","-","*","/",">",">=","<","=<","=:=","==","=/=","/=","||","<-","!"],q=/[<\(\[\{]/,m=["<<","(","[","{"],D=/[>\)\]\}]/,k=["}","]",")",">>"],N="is_atom.is_binary.is_bitstring.is_boolean.is_float.is_function.is_integer.is_list.is_number.is_pid.is_port.is_record.is_reference.is_tuple.atom.binary.bitstring.boolean.function.integer.list.number.pid.port.record.reference.tuple".split("."),O="abs.adler32.adler32_combine.alive.apply.atom_to_binary.atom_to_list.binary_to_atom.binary_to_existing_atom.binary_to_list.binary_to_term.bit_size.bitstring_to_list.byte_size.check_process_code.contact_binary.crc32.crc32_combine.date.decode_packet.delete_module.disconnect_node.element.erase.exit.float.float_to_list.garbage_collect.get.get_keys.group_leader.halt.hd.integer_to_list.internal_bif.iolist_size.iolist_to_binary.is_alive.is_atom.is_binary.is_bitstring.is_boolean.is_float.is_function.is_integer.is_list.is_number.is_pid.is_port.is_process_alive.is_record.is_reference.is_tuple.length.link.list_to_atom.list_to_binary.list_to_bitstring.list_to_existing_atom.list_to_float.list_to_integer.list_to_pid.list_to_tuple.load_module.make_ref.module_loaded.monitor_node.node.node_link.node_unlink.nodes.notalive.now.open_port.pid_to_list.port_close.port_command.port_connect.port_control.pre_loaded.process_flag.process_info.processes.purge_module.put.register.registered.round.self.setelement.size.spawn.spawn_link.spawn_monitor.spawn_opt.split_binary.statistics.term_to_binary.time.throw.tl.trunc.tuple_size.tuple_to_list.unlink.unregister.whereis".split("."),f=/[\w@Ø-ÞÀ-Öß-öø-ÿ]/,j=/[0-7]{1,3}|[bdefnrstv\\"']|\^[a-zA-Z]|x[0-9a-zA-Z]{2}|x{[0-9a-zA-Z]+}/;function C(t,e){if(e.in_string)return e.in_string=!v(t),i(e,t,"string");if(e.in_atom)return e.in_atom=!b(t),i(e,t,"atom");if(t.eatSpace())return i(e,t,"whitespace");if(!_(e)&&t.match(/-\s*[a-zß-öø-ÿ][\wØ-ÞÀ-Öß-öø-ÿ]*/))return a(t.current(),S)?i(e,t,"type"):i(e,t,"attribute");var n=t.next();if(n=="%")return t.skipToEnd(),i(e,t,"comment");if(n==":")return i(e,t,"colon");if(n=="?")return t.eatSpace(),t.eatWhile(f),i(e,t,"macro");if(n=="#")return t.eatSpace(),t.eatWhile(f),i(e,t,"record");if(n=="$")return t.next()=="\\"&&!t.match(j)?i(e,t,"error"):i(e,t,"number");if(n==".")return i(e,t,"dot");if(n=="'"){if(!(e.in_atom=!b(t))){if(t.match(/\s*\/\s*[0-9]/,!1))return t.match(/\s*\/\s*[0-9]/,!0),i(e,t,"fun");if(t.match(/\s*\(/,!1)||t.match(/\s*:/,!1))return i(e,t,"function")}return i(e,t,"atom")}if(n=='"')return e.in_string=!v(t),i(e,t,"string");if(/[A-Z_Ø-ÞÀ-Ö]/.test(n))return t.eatWhile(f),i(e,t,"variable");if(/[a-z_ß-öø-ÿ]/.test(n)){if(t.eatWhile(f),t.match(/\s*\/\s*[0-9]/,!1))return t.match(/\s*\/\s*[0-9]/,!0),i(e,t,"fun");var r=t.current();return a(r,z)?i(e,t,"keyword"):a(r,U)?i(e,t,"operator"):t.match(/\s*\(/,!1)?a(r,O)&&(_(e).token!=":"||_(e,2).token=="erlang")?i(e,t,"builtin"):a(r,N)?i(e,t,"guard"):i(e,t,"function"):F(t)==":"?r=="erlang"?i(e,t,"builtin"):i(e,t,"function"):a(r,["true","false"])?i(e,t,"boolean"):i(e,t,"atom")}var c=/[0-9]/;return c.test(n)?(t.eatWhile(c),t.eat("#")?t.eatWhile(/[0-9a-zA-Z]/)||t.backUp(1):t.eat(".")&&(t.eatWhile(c)?t.eat(/[eE]/)&&(t.eat(/[-+]/)?t.eatWhile(c)||t.backUp(2):t.eatWhile(c)||t.backUp(1)):t.backUp(1)),i(e,t,"number")):g(t,q,m)?i(e,t,"open_paren"):g(t,D,k)?i(e,t,"close_paren"):y(t,W,E)?i(e,t,"separator"):y(t,A,Z)?i(e,t,"operator"):i(e,t,null)}function g(t,e,n){if(t.current().length==1&&e.test(t.current())){for(t.backUp(1);e.test(t.peek());)if(t.next(),a(t.current(),n))return!0;t.backUp(t.current().length-1)}return!1}function y(t,e,n){if(t.current().length==1&&e.test(t.current())){for(;e.test(t.peek());)t.next();for(;0<t.current().length;){if(a(t.current(),n))return!0;t.backUp(1)}t.next()}return!1}function v(t){return w(t,'"',"\\")}function b(t){return w(t,"'","\\")}function w(t,e,n){for(;!t.eol();){var r=t.next();if(r==e)return!0;r==n&&t.next()}return!1}function F(t){var e=t.match(/^\s*([^\s%])/,!1);return e?e[1]:""}function a(t,e){return-1<e.indexOf(t)}function i(t,e,n){switch(M(t,I(n,e)),n){case"atom":return"atom";case"attribute":return"attribute";case"boolean":return"atom";case"builtin":return"builtin";case"close_paren":return null;case"colon":return null;case"comment":return"comment";case"dot":return null;case"error":return"error";case"fun":return"meta";case"function":return"tag";case"guard":return"property";case"keyword":return"keyword";case"macro":return"macroName";case"number":return"number";case"open_paren":return null;case"operator":return"operator";case"record":return"bracket";case"separator":return null;case"string":return"string";case"type":return"def";case"variable":return"variable";default:return null}}function x(t,e,n,r){return{token:t,column:e,indent:n,type:r}}function I(t,e){return x(e.current(),e.column(),e.indentation(),t)}function L(t){return x(t,0,0,t)}function _(t,e){var n=t.tokenStack.length,r=e||1;return n<r?!1:t.tokenStack[n-r]}function M(t,e){e.type=="comment"||e.type=="whitespace"||(t.tokenStack=P(t.tokenStack,e),t.tokenStack=R(t.tokenStack))}function P(t,e){var n=t.length-1;return 0<n&&t[n].type==="record"&&e.type==="dot"?t.pop():(0<n&&t[n].type==="group"&&t.pop(),t.push(e)),t}function R(t){if(!t.length)return t;var e=t.length-1;if(t[e].type==="dot")return[];if(e>1&&t[e].type==="fun"&&t[e-1].token==="fun")return t.slice(0,e-1);switch(t[e].token){case"}":return s(t,{g:["{"]});case"]":return s(t,{i:["["]});case")":return s(t,{i:["("]});case">>":return s(t,{i:["<<"]});case"end":return s(t,{i:["begin","case","fun","if","receive","try"]});case",":return s(t,{e:["begin","try","when","->",",","(","[","{","<<"]});case"->":return s(t,{r:["when"],m:["try","if","case","receive"]});case";":return s(t,{E:["case","fun","if","receive","try","when"]});case"catch":return s(t,{e:["try"]});case"of":return s(t,{e:["case"]});case"after":return s(t,{e:["receive","try"]});default:return t}}function s(t,e){for(var n in e)for(var r=t.length-1,c=e[n],o=r-1;-1<o;o--)if(a(t[o].token,c)){var u=t.slice(0,o);switch(n){case"m":return u.concat(t[o]).concat(t[r]);case"r":return u.concat(t[r]);case"i":return u;case"g":return u.concat(L("group"));case"E":return u.concat(t[o]);case"e":return u.concat(t[o])}}return n=="E"?[]:t}function $(t,e,n){var r,c=B(e),o=_(t,1),u=_(t,2);return t.in_string||t.in_atom?null:u?o.token=="when"?o.column+n.unit:c==="when"&&u.type==="function"?u.indent+n.unit:c==="("&&o.token==="fun"?o.column+3:c==="catch"&&(r=d(t,["try"]))?r.column:a(c,["end","after","of"])?(r=d(t,["begin","case","fun","if","receive","try"]),r?r.column:null):a(c,k)?(r=d(t,m),r?r.column:null):a(o.token,[",","|","||"])||a(c,[",","|","||"])?(r=G(t),r?r.column+r.token.length:n.unit):o.token=="->"?a(u.token,["receive","case","if","try"])?u.column+n.unit+n.unit:u.column+n.unit:a(o.token,m)?o.column+o.token.length:(r=H(t),l(r)?r.column+n.unit:0):0}function B(t){var e=t.match(/,|[a-z]+|\}|\]|\)|>>|\|+|\(/);return l(e)&&e.index===0?e[0]:""}function G(t){var e=t.tokenStack.slice(0,-1),n=p(e,"type",["open_paren"]);return l(e[n])?e[n]:!1}function H(t){var e=t.tokenStack,n=p(e,"type",["open_paren","separator","keyword"]),r=p(e,"type",["operator"]);return l(n)&&l(r)&&n<r?e[n+1]:l(n)?e[n]:!1}function d(t,e){var n=t.tokenStack,r=p(n,"token",e);return l(n[r])?n[r]:!1}function p(t,e,n){for(var r=t.length-1;-1<r;r--)if(a(t[r][e],n))return r;return!1}function l(t){return t!==!1&&t!=null}const J={name:"erlang",startState(){return{tokenStack:[],in_string:!1,in_atom:!1}},token:C,indent:$,languageData:{commentTokens:{line:"%"}}};export{J as t};
