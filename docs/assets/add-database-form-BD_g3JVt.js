var Oe=Object.defineProperty;var Ue=(t,e,s)=>e in t?Oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var oe=(t,e,s)=>Ue(t,typeof e!="symbol"?e+"":e,s);import{s as G}from"./chunk-DZLz74EQ.js";import{t as Ke}from"./react-BcIddLXZ.js";import{E as He,tr as h,ut as We}from"./cells-B6jS0AIj.js";import{A as m,E as O,F as u,O as re,_ as ue,i as Me,m as Qe,z as d}from"./zod-U2NFpcFA.js";import{n as be,t as Ge}from"./jsx-runtime-DvsdsEjx.js";import{t as Ve}from"./_createAggregator-DL8RwNg0.js";import{d as ze}from"./hotkeys-Lbk6RHir.js";import{t as fe}from"./cn-C5VTNYKf.js";import{t as ie}from"./button-nRVaalxL.js";import{t as Je}from"./key-DWQdrH_J.js";import{c as Ye,i as Xe,n as Ze,r as et,s as tt,t as st}from"./select-DJ0A_oCR.js";import{t as nt}from"./circle-plus-B5Yc1YKq.js";import{a as ce,c as ge,o as ot,p as rt,r as it,t as ct}from"./dropdown-menu-1SGi7wHR.js";import{o as at,r as lt}from"./input-BPw9p_8N.js";import{a as dt,c as ht,i as pt,n as mt,o as ut,p as bt,r as ft,s as gt,u as yt}from"./form-b4A0F_Lr.js";import{n as ae}from"./useNonce-DECX9FAH.js";import{a as _t,c as St,l as wt,n as xt,r as kt,t as $t}from"./dialog-CEqVOFHc.js";import{n as Ct}from"./ImperativeModal-CmOSTULR.js";import{n as jt}from"./useAsyncData-CsBCDF11.js";import{t as At}from"./links-DCKgyNFq.js";import{o as vt,t as Rt,u as i}from"./form-CDF8FirJ.js";import{o as It}from"./focus-NSCHuycv.js";import{t as Tt}from"./request-registry-BfJOJz6S.js";import{n as Dt,t as qt}from"./write-secret-modal-DLxqNGHo.js";var Lt=Ve(function(t,e,s){t[s?0:1].push(e)},function(){return[[],[]]});function C(){return d().optional().describe(i.of({label:"Password",inputType:"password",placeholder:"password",optionRegex:".*password.*"}))}function le(t,e){let s=d();return s=e?s.nonempty():s.optional(),s=s.describe(i.of({label:t||"Token",inputType:"password",placeholder:"token",optionRegex:".*token.*"})),s}function V(){return d().optional().describe(i.of({label:"Warehouse Name",placeholder:"warehouse",optionRegex:".*warehouse.*"}))}function de(t,e){let s=d();return s=e?s.nonempty():s.optional(),s.describe(i.of({label:t||"URI",optionRegex:".*uri.*"}))}function x(t){return d().nonempty().describe(i.of({label:t||"Host",placeholder:"localhost",optionRegex:".*host.*"}))}function w(){return d().describe(i.of({label:"Database",placeholder:"db name",optionRegex:".*database.*"}))}function Nt(){return d().describe(i.of({label:"Schema",placeholder:"schema name",optionRegex:".*schema.*"}))}function j(){return d().nonempty().describe(i.of({label:"Username",placeholder:"username",optionRegex:".*username.*"}))}function A(t){let e=Me().describe(i.of({label:"Port",inputType:"number",placeholder:t==null?void 0:t.toString()})).transform(Number).refine(s=>s>=0&&s<=65535,{message:"Port must be between 0 and 65535"});return t===void 0?e:e.default(t)}function ye(){return O().default(!1).describe(i.of({label:"Read Only"}))}const _e=u({type:m("postgres"),host:x(),port:A(5432).optional(),database:w(),username:j(),password:C(),ssl:O().default(!1).describe(i.of({label:"Use SSL"}))}).describe(i.of({direction:"two-columns"})),Se=u({type:m("mysql"),host:x(),port:A(3306),database:w(),username:j(),password:C(),ssl:O().default(!1).describe(i.of({label:"Use SSL"}))}).describe(i.of({direction:"two-columns"})),we=u({type:m("sqlite"),database:w().describe(i.of({label:"Database Path"}))}).describe(i.of({direction:"two-columns"})),xe=u({type:m("duckdb"),database:w().describe(i.of({label:"Database Path"})),read_only:ye()}).describe(i.of({direction:"two-columns"})),ke=u({type:m("motherduck"),database:w().default("my_db").describe(i.of({label:"Database Name"})),token:le()}).describe(i.of({direction:"two-columns"})),$e=u({type:m("snowflake"),account:d().nonempty().describe(i.of({label:"Account",optionRegex:".*snowflake.*"})),warehouse:d().optional().describe(i.of({label:"Warehouse",optionRegex:".*snowflake.*"})),database:w(),schema:d().optional().describe(i.of({label:"Schema",optionRegex:".*snowflake.*"})),username:j(),password:C(),role:d().optional().describe(i.of({label:"Role"}))}).describe(i.of({direction:"two-columns"})),Ce=u({type:m("bigquery"),project:d().nonempty().describe(i.of({label:"Project ID",optionRegex:".*bigquery.*"})),dataset:d().nonempty().describe(i.of({label:"Dataset",optionRegex:".*bigquery.*"})),credentials_json:d().describe(i.of({label:"Credentials JSON",inputType:"textarea"}))}).describe(i.of({direction:"two-columns"})),je=u({type:m("clickhouse_connect"),host:x(),port:A(8123).optional(),username:j(),password:C(),secure:O().default(!1).describe(i.of({label:"Use HTTPs"}))}).describe(i.of({direction:"two-columns"})),Ae=u({type:m("timeplus"),host:x().default("localhost"),port:A(8123).optional(),username:j().default("default"),password:C().default("")}).describe(i.of({direction:"two-columns"})),ve=u({type:m("chdb"),database:w().describe(i.of({label:"Database Path"})),read_only:ye()}).describe(i.of({direction:"two-columns"})),Re=u({type:m("trino"),host:x(),port:A(8080),database:w(),schema:Nt().optional(),username:j(),password:C(),async_support:O().default(!1).describe(i.of({label:"Async Support"}))}).describe(i.of({direction:"two-columns"})),Ie=u({type:m("iceberg"),name:d().describe(i.of({label:"Catalog Name"})),catalog:re("type",[u({type:m("REST"),warehouse:V(),uri:d().optional().describe(i.of({label:"URI",placeholder:"https://",optionRegex:".*uri.*"})),token:le()}),u({type:m("SQL"),warehouse:V(),uri:d().optional().describe(i.of({label:"URI",placeholder:"jdbc:iceberg://host:port/database",optionRegex:".*uri.*"}))}),u({type:m("Hive"),warehouse:V(),uri:de()}),u({type:m("Glue"),warehouse:V(),uri:de()}),u({type:m("DynamoDB"),"dynamodb.profile-name":d().optional().describe(i.of({label:"Profile Name"})),"dynamodb.region":d().optional().describe(i.of({label:"Region"})),"dynamodb.access-key-id":d().optional().describe(i.of({label:"Access Key ID"})),"dynamodb.secret-access-key":d().optional().describe(i.of({label:"Secret Access Key",inputType:"password"})),"dynamodb.session-token":d().optional().describe(i.of({label:"Session Token",inputType:"password"}))})]).default({type:"REST",token:void 0}).describe(i.of({special:"tabs"}))}),Te=u({type:m("datafusion"),sessionContext:O().optional().describe(i.of({label:"Use Session Context"}))}),De=u({type:m("pyspark"),host:x().optional(),port:A().optional()}),qe=u({type:m("redshift"),host:x(),port:A(5439),connectionType:re("type",[u({type:m("IAM credentials"),region:d().describe(i.of({label:"Region"})),aws_access_key_id:d().nonempty().describe(i.of({label:"AWS Access Key ID",inputType:"password",optionRegex:".*aws_access_key_id.*"})),aws_secret_access_key:d().nonempty().describe(i.of({label:"AWS Secret Access Key",inputType:"password",optionRegex:".*aws_secret_access_key.*"})),aws_session_token:d().optional().describe(i.of({label:"AWS Session Token",inputType:"password",optionRegex:".*aws_session_token.*"}))}),u({type:m("DB credentials"),user:j(),password:C()})]).default({type:"IAM credentials",aws_access_key_id:"",aws_secret_access_key:"",region:""}),database:w()}).describe(i.of({direction:"two-columns"})),Le=u({type:m("databricks"),access_token:le("Access Token",!0),server_hostname:x("Server Hostname"),http_path:de("HTTP Path",!0),catalog:d().optional().describe(i.of({label:"Catalog"})),schema:d().optional().describe(i.of({label:"Schema"}))}).describe(i.of({direction:"two-columns"})),Pt=re("type",[_e,Se,we,xe,ke,$e,Ce,je,Ae,ve,Re,Ie,Te,De,qe,Le]);var he="env:";function Ws(t){return t}function z(t){return typeof t=="string"?t.startsWith(he):!1}function pe(t){return`${he}${t}`}function Et(t){return t.replace(he,"")}const Ne={sqlmodel:"SQLModel",sqlalchemy:"SQLAlchemy",duckdb:"DuckDB",clickhouse_connect:"ClickHouse Connect",chdb:"chDB",pyiceberg:"PyIceberg",ibis:"Ibis",motherduck:"MotherDuck",redshift:"Redshift",databricks:"Databricks"};var _=class{constructor(t,e,s){this.connection=t,this.orm=e,this.secrets=s}get imports(){let t=new Set(this.generateImports());switch(this.orm){case"sqlalchemy":t.add("import sqlalchemy");break;case"sqlmodel":t.add("import sqlmodel");break;case"duckdb":t.add("import duckdb");break;case"ibis":t.add("import ibis");break}return t}},Ft=t=>`_${t}`,Bt=class{constructor(){oe(this,"secrets",{})}get imports(){return Object.keys(this.secrets).length===0?new Set:new Set(["import os"])}print(t,e,s){if(t=Ft(t),z(e)){let o=Et(e),n=s?`os.environ.get("${o}", "${s}")`:`os.environ.get("${o}")`;return this.secrets[t]=n,t}if(s!=null){let o=`os.environ.get("${e}", "${s}")`;return this.secrets[t]=o,t}return typeof e=="number"||typeof e=="number"?`${e}`:typeof e=="boolean"?U(e):e?`"${e}"`:""}printInFString(t,e,s){if(e===void 0)return"";if(typeof e=="number")return`${e}`;if(typeof e=="boolean")return U(e);let o=this.print(t,e,s);return o.startsWith('"')&&o.endsWith('"')?o.slice(1,-1):`{${o}}`}printPassword(t,e,s,o){let n=s?this.printInFString.bind(this):this.print.bind(this);return z(t)?n(o||"password",t):n(o||"password",e,t)}getSecrets(){return this.secrets}formatSecrets(){return Object.keys(this.secrets).length===0?"":Object.entries(this.secrets).map(([t,e])=>`${t} = ${e}`).join(`
`)}},Ot=class extends _{generateImports(){return[]}generateConnectionCode(){let t=this.connection.ssl?", connect_args={'sslmode': 'require'}":"",e=this.secrets.printPassword(this.connection.password,"POSTGRES_PASSWORD",!0);return h(`
      DATABASE_URL = f"postgresql://${this.secrets.printInFString("username",this.connection.username)}:${e}@${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}/${this.secrets.printInFString("database",this.connection.database)}"
      engine = ${this.orm}.create_engine(DATABASE_URL${t})
    `)}},Ut=class extends _{generateImports(){return[]}generateConnectionCode(){let t=this.connection.ssl?", connect_args={'ssl': {'ssl-mode': 'preferred'}}":"",e=this.secrets.printPassword(this.connection.password,"MYSQL_PASSWORD",!0),s=this.secrets.printInFString("database",this.connection.database);return h(`
      DATABASE_URL = f"mysql+pymysql://${this.secrets.printInFString("username",this.connection.username)}:${e}@${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}/${s}"
      engine = ${this.orm}.create_engine(DATABASE_URL${t})
    `)}},Kt=class extends _{generateImports(){return[]}generateConnectionCode(){let t=this.connection.database?this.secrets.printInFString("database",this.connection.database):"";return h(`
      ${t.startsWith("{")&&t.endsWith("}")?`DATABASE_URL = f"sqlite:///${t}"`:`DATABASE_URL = "sqlite:///${t}"`}
      engine = ${this.orm}.create_engine(DATABASE_URL)
    `)}},Ht=class extends _{generateImports(){return["from snowflake.sqlalchemy import URL"]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"SNOWFLAKE_PASSWORD",!1),e={account:this.secrets.print("account",this.connection.account),user:this.secrets.print("user",this.connection.username),database:this.secrets.print("database",this.connection.database),warehouse:this.connection.warehouse?this.secrets.print("warehouse",this.connection.warehouse):void 0,schema:this.connection.schema?this.secrets.print("schema",this.connection.schema):void 0,role:this.connection.role?this.secrets.print("role",this.connection.role):void 0,password:t};return h(`
      engine = ${this.orm}.create_engine(
        URL(
${J(e,s=>`          ${s}`)},
        )
      )
    `)}},Wt=class extends _{generateImports(){return["import json"]}generateConnectionCode(){let t=this.secrets.printInFString("project",this.connection.project),e=this.secrets.printInFString("dataset",this.connection.dataset);return h(`
      credentials = json.loads("""${this.connection.credentials_json}""")
      engine = ${this.orm}.create_engine(f"bigquery://${t}/${e}", credentials_info=credentials)
    `)}},Mt=class extends _{generateImports(){return[]}generateConnectionCode(){return h(`
      DATABASE_URL = "${this.secrets.printInFString("database",this.connection.database||":memory:")}"
      engine = ${this.orm}.connect(DATABASE_URL, read_only=${U(this.connection.read_only)})
    `)}},Qt=class extends _{generateImports(){return[]}generateConnectionCode(){let t=this.secrets.printInFString("database",this.connection.database);return this.connection.token?h(`
      conn = duckdb.connect("md:${t}", config={"motherduck_token": ${this.secrets.printPassword(this.connection.token,"MOTHERDUCK_TOKEN",!1)}})
    `):h(`
        conn = duckdb.connect("md:${t}")
        `)}},Gt=class extends _{generateImports(){return["import clickhouse_connect"]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"CLICKHOUSE_PASSWORD",!1),e={host:this.secrets.print("host",this.connection.host),user:this.secrets.print("user",this.connection.username),secure:this.secrets.print("secure",this.connection.secure),port:this.connection.port?this.secrets.print("port",this.connection.port):void 0,password:this.connection.password?t:void 0};return h(`
      engine = ${this.orm}.get_client(
${J(e,s=>`        ${s}`)},
      )
    `)}},Vt=class extends _{generateImports(){return[]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"TIMEPLUS_PASSWORD",!0);return h(`
      DATABASE_URL = f"timeplus://${this.secrets.printInFString("username",this.connection.username)}:${t}@${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}"
      engine = ${this.orm}.create_engine(DATABASE_URL)
    `)}},zt=class extends _{generateImports(){return["import chdb"]}generateConnectionCode(){let t=this.secrets.print("database",this.connection.database)||'""';return h(`
      engine = ${this.orm}.connect(${t}, read_only=${U(this.connection.read_only)})
    `)}},Jt=class extends _{generateImports(){return this.connection.async_support?["import aiotrino"]:["import trino.sqlalchemy"]}generateConnectionCode(){let t=this.connection.async_support?"aiotrino":"trino",e=this.connection.schema?`/${this.connection.schema}`:"",s=this.secrets.printInFString("username",this.connection.username),o=this.secrets.printInFString("host",this.connection.host),n=this.secrets.printInFString("port",this.connection.port),c=this.secrets.printInFString("database",this.connection.database),a=this.secrets.printPassword(this.connection.password,"TRINO_PASSWORD",!0);return h(`
      engine = ${this.orm}.create_engine(f"${t}://${s}:${a}@${o}:${n}/${c}${e}")
    `)}},Yt=class extends _{generateImports(){switch(this.connection.catalog.type){case"REST":return["from pyiceberg.catalog.rest import RestCatalog"];case"SQL":return["from pyiceberg.catalog.sql import SqlCatalog"];case"Hive":return["from pyiceberg.catalog.hive import HiveCatalog"];case"Glue":return["from pyiceberg.catalog.glue import GlueCatalog"];case"DynamoDB":return["from pyiceberg.catalog.dynamodb import DynamoDBCatalog"];default:ae(this.connection.catalog)}}generateConnectionCode(){let t={...this.connection.catalog};t=Object.fromEntries(Object.entries(t).filter(([o,n])=>n!=null&&n!==""&&o!=="type"));for(let[o,n]of Object.entries(t))z(n)?t[o]=this.secrets.print(o,n):typeof n=="string"&&(t[o]=`"${n}"`);let e=os(t,o=>`              ${o}`),s=`"${this.connection.name}"`;switch(this.connection.catalog.type){case"REST":return h(`
          catalog = RestCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"SQL":return h(`
          catalog = SqlCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"Hive":return h(`
          catalog = HiveCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"Glue":return h(`
          catalog = GlueCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"DynamoDB":return h(`
          catalog = DynamoDBCatalog(
            ${s},
            **{
${e}
            },
          )
        `);default:ae(this.connection.catalog)}}},Xt=class extends _{generateImports(){return["from datafusion import SessionContext"]}generateConnectionCode(){return this.connection.sessionContext?h(`
        ctx = SessionContext()
        # Sample table
        _ = ctx.from_pydict({"a": [1, 2, 3]}, "my_table")

        con = ibis.datafusion.connect(ctx)
      `):h(`
      con = ibis.datafusion.connect()
    `)}},Zt=class extends _{generateImports(){return["from pyspark.sql import SparkSession"]}generateConnectionCode(){return this.connection.host||this.connection.port?h(`
        session = SparkSession.builder.remote(f"sc://${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}").getOrCreate()
        con = ibis.pyspark.connect(session)
      `):h(`
      con = ibis.pyspark.connect()
    `)}},es=class extends _{generateImports(){return["import redshift_connector"]}generateConnectionCode(){let t=this.secrets.print("host",this.connection.host),e=this.secrets.print("port",this.connection.port),s=this.secrets.print("database",this.connection.database);if(this.connection.connectionType.type==="IAM credentials"){let c=this.secrets.print("aws_access_key_id",this.connection.connectionType.aws_access_key_id),a=this.secrets.print("aws_secret_access_key",this.connection.connectionType.aws_secret_access_key),l=this.connection.connectionType.aws_session_token?this.secrets.print("aws_session_token",this.connection.connectionType.aws_session_token):void 0;return h(`
        con = redshift_connector.connect(
${J({iam:!0,host:t,port:e,region:`"${this.connection.connectionType.region}"`,database:s,access_key_id:c,secret_access_key:a,...l&&{session_token:l}},b=>`          ${b}`)},
        )
      `)}let o=this.connection.connectionType.user?this.secrets.print("user",this.connection.connectionType.user):void 0,n=this.connection.connectionType.password?this.secrets.printPassword(this.connection.connectionType.password,"REDSHIFT_PASSWORD",!1):void 0;return h(`
      con = redshift_connector.connect(
${J({host:t,port:e,database:s,...o&&{user:o},...n&&{password:n}},c=>`          ${c}`)},
      )
    `)}},ts=class extends _{generateImports(){return[]}generateConnectionCode(){let t=this.orm!=="ibis",e=this.secrets.printPassword(this.connection.access_token,"DATABRICKS_ACCESS_TOKEN",t,"access_token"),s=this.secrets.printPassword(this.connection.server_hostname,"DATABRICKS_SERVER_HOSTNAME",t,"server_hostname"),o=this.secrets.printPassword(this.connection.http_path,"DATABRICKS_HTTP_PATH",t,"http_path"),n=this.connection.catalog?this.secrets.printInFString("catalog",this.connection.catalog):void 0,c=this.connection.schema?this.secrets.printInFString("schema",this.connection.schema):void 0,a=`databricks://token:${e}@${s}?http_path=${o}`;return n&&(a+=`&catalog=${n}`),c&&(a+=`&schema=${c}`),this.orm==="ibis"?h(`
        engine = ibis.databricks.connect(
          server_hostname=${s},
          http_path=${o},${n?`
          catalog=${n},`:""}${c?`
          schema=${c},`:""}
          access_token=${e}
        )
      `):h(`
      DATABASE_URL = f"${a}"
      engine = ${this.orm}.create_engine(DATABASE_URL)
      `)}},ss=class{constructor(){oe(this,"secrets",new Bt)}createGenerator(t,e){switch(t.type){case"postgres":return new Ot(t,e,this.secrets);case"mysql":return new Ut(t,e,this.secrets);case"sqlite":return new Kt(t,e,this.secrets);case"snowflake":return new Ht(t,e,this.secrets);case"bigquery":return new Wt(t,e,this.secrets);case"duckdb":return new Mt(t,e,this.secrets);case"motherduck":return new Qt(t,e,this.secrets);case"clickhouse_connect":return new Gt(t,e,this.secrets);case"timeplus":return new Vt(t,e,this.secrets);case"chdb":return new zt(t,e,this.secrets);case"trino":return new Jt(t,e,this.secrets);case"iceberg":return new Yt(t,e,this.secrets);case"datafusion":return new Xt(t,e,this.secrets);case"pyspark":return new Zt(t,e,this.secrets);case"redshift":return new es(t,e,this.secrets);case"databricks":return new ts(t,e,this.secrets);default:ae(t)}}};function ns(t,e){if(!(e in Ne))throw Error(`Unsupported library: ${e}`);Pt.parse(t);let s=new ss,o=s.createGenerator(t,e),n=o.generateConnectionCode(),c=s.secrets,a=[...new Set([...c.imports,...o.imports])].sort();a.push("");let l=c.formatSecrets();return l&&a.push(l),a.push(n.trim()),a.join(`
`)}function U(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function J(t,e){return Object.entries(t).filter(([,s])=>s!=null&&s!=="").map(([s,o])=>e(typeof o=="boolean"?`${s}=${U(o)}`:`${s}=${o}`)).join(`,
`)}function os(t,e){return Object.entries(t).filter(([,s])=>s!=null&&s!=="").map(([s,o])=>{let n=`"${s}"`;return e(typeof o=="boolean"?`${n}: ${U(o)}`:`${n}: ${o}`)}).join(`,
`)}var rs=G(be(),1),K=G(Ke(),1),r=G(Ge(),1),Pe=(0,K.createContext)({providerNames:[],secretKeys:[],loading:!1,error:void 0,refreshSecrets:ze.NOOP});const is=()=>(0,K.use)(Pe),cs=t=>{let e=(0,rs.c)(14),{children:s}=t,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],e[0]=o):o=e[0];let{data:n,isPending:c,error:a,refetch:l}=jt(ps,o),b;e[1]===(n==null?void 0:n.secretKeys)?b=e[2]:(b=(n==null?void 0:n.secretKeys)||[],e[1]=n==null?void 0:n.secretKeys,e[2]=b);let p;e[3]===(n==null?void 0:n.providerNames)?p=e[4]:(p=(n==null?void 0:n.providerNames)||[],e[3]=n==null?void 0:n.providerNames,e[4]=p);let f;e[5]!==a||e[6]!==c||e[7]!==l||e[8]!==b||e[9]!==p?(f={secretKeys:b,providerNames:p,loading:c,error:a,refreshSecrets:l},e[5]=a,e[6]=c,e[7]=l,e[8]=b,e[9]=p,e[10]=f):f=e[10];let y;return e[11]!==s||e[12]!==f?(y=(0,r.jsx)(Pe,{value:f,children:s}),e[11]=s,e[12]=f,e[13]=y):y=e[13],y},as={isMatch:t=>{if(t instanceof ue||t instanceof Qe){let{optionRegex:e}=i.parse(t.description||"");return!!e}return!1},Component:({schema:t,form:e,path:s})=>{let{secretKeys:o,providerNames:n,refreshSecrets:c}=is(),{openModal:a,closeModal:l}=Ct(),{label:b,description:p,optionRegex:f=""}=i.parse(t.description||""),[y,k]=Lt(o,g=>new RegExp(f,"i").test(g));return(0,r.jsx)(dt,{control:e.control,name:s,render:({field:g})=>(0,r.jsxs)(ut,{children:[(0,r.jsx)(gt,{children:b}),(0,r.jsx)(ft,{children:p}),(0,r.jsx)(mt,{children:(0,r.jsxs)("div",{className:"flex gap-2",children:[t instanceof ue?(0,r.jsx)(lt,{...g,value:g.value,onChange:g.onChange,className:fe("flex-1")}):(0,r.jsx)(at,{...g,value:g.value,onChange:g.onChange,className:"flex-1"}),(0,r.jsxs)(ct,{children:[(0,r.jsx)(rt,{asChild:!0,children:(0,r.jsx)(ie,{variant:"outline",size:"icon",className:fe(z(g.value)&&"bg-accent"),children:(0,r.jsx)(Je,{className:"h-3 w-3"})})}),(0,r.jsxs)(it,{align:"end",className:"max-h-60 overflow-y-auto",children:[(0,r.jsxs)(ce,{onSelect:()=>{a((0,r.jsx)(qt,{providerNames:n,onSuccess:S=>{c(),g.onChange(pe(S)),l()},onClose:l}))},children:[(0,r.jsx)(nt,{className:"mr-2 h-3.5 w-3.5"}),"Create a new secret"]}),y.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ge,{}),(0,r.jsx)(ot,{children:"Recommended"})]}),y.map(S=>(0,r.jsx)(ce,{onSelect:()=>g.onChange(pe(S)),children:S},S)),k.length>0&&(0,r.jsx)(ge,{}),k.map(S=>(0,r.jsx)(ce,{onSelect:()=>g.onChange(pe(S)),children:S},S))]})]})]})}),(0,r.jsx)(ht,{})]})})}};function ls(t){return t.provider!=="env"}function ds(t){return t.name}function hs(t){return t.keys}async function ps(){let t=await Tt.request({}),e=Dt(t.secrets).filter(ls).map(ds);return{secretKeys:t.secrets.flatMap(hs).sort(),providerNames:e}}var H=G(be(),1),Ee=[{name:"PostgreSQL",schema:_e,color:"#336791",logo:"postgres",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"MySQL",schema:Se,color:"#00758F",logo:"mysql",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"SQLite",schema:we,color:"#003B57",logo:"sqlite",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"DuckDB",schema:xe,color:"#FFD700",logo:"duckdb",connectionLibraries:{libraries:["duckdb"],preferred:"duckdb"}},{name:"MotherDuck",schema:ke,color:"#ff9538",logo:"motherduck",connectionLibraries:{libraries:["duckdb"],preferred:"duckdb"}},{name:"Snowflake",schema:$e,color:"#29B5E8",logo:"snowflake",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"ClickHouse",schema:je,color:"#2C2C1D",logo:"clickhouse",connectionLibraries:{libraries:["clickhouse_connect"],preferred:"clickhouse_connect"}},{name:"Timeplus",schema:Ae,color:"#B83280",logo:"timeplus",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"BigQuery",schema:Ce,color:"#4285F4",logo:"bigquery",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"ClickHouse Embedded",schema:ve,color:"#f2b611",logo:"clickhouse",connectionLibraries:{libraries:["chdb"],preferred:"chdb"}},{name:"Trino",schema:Re,color:"#d466b6",logo:"trino",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"DataFusion",schema:Te,color:"#202A37",logo:"datafusion",connectionLibraries:{libraries:["ibis"],preferred:"ibis"}},{name:"PySpark",schema:De,color:"#1C5162",logo:"pyspark",connectionLibraries:{libraries:["ibis"],preferred:"ibis"}},{name:"Redshift",schema:qe,color:"#522BAE",logo:"redshift",connectionLibraries:{libraries:["redshift"],preferred:"redshift"}},{name:"Databricks",schema:Le,color:"#c41e0c",logo:"databricks",connectionLibraries:{libraries:["sqlalchemy","sqlmodel","ibis"],preferred:"sqlalchemy"}}],Fe=[{name:"Iceberg",schema:Ie,color:"#000000",logo:"iceberg",connectionLibraries:{libraries:["pyiceberg"],preferred:"pyiceberg"}}],ms=t=>{let e=(0,H.c)(14),{onSelect:s}=t,o;e[0]===s?o=e[1]:(o=y=>{let{name:k,schema:g,color:S,logo:v}=y;return(0,r.jsxs)("button",{type:"button",className:"py-3 flex flex-col items-center justify-center gap-1 transition-all hover:scale-105 hover:brightness-110 rounded shadow-sm-solid hover:shadow-md-solid",style:{backgroundColor:S},onClick:()=>s(g),children:[(0,r.jsx)(We,{name:v,className:"w-8 h-8 text-white brightness-0 invert dark:invert"}),(0,r.jsx)("span",{className:"text-white font-medium text-lg",children:k})]},k)},e[0]=s,e[1]=o);let n=o,c;e[2]===n?c=e[3]:(c=Ee.map(n),e[2]=n,e[3]=c);let a;e[4]===c?a=e[5]:(a=(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:c}),e[4]=c,e[5]=a);let l;e[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,r.jsxs)("h4",{className:"font-semibold text-muted-foreground text-lg flex items-center gap-4",children:["Data Catalogs",(0,r.jsx)("hr",{className:"flex-1"})]}),e[6]=l):l=e[6];let b;e[7]===n?b=e[8]:(b=Fe.map(n),e[7]=n,e[8]=b);let p;e[9]===b?p=e[10]:(p=(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:b}),e[9]=b,e[10]=p);let f;return e[11]!==a||e[12]!==p?(f=(0,r.jsxs)(r.Fragment,{children:[a,l,p]}),e[11]=a,e[12]=p,e[13]=f):f=e[13],f},us=[as],bs=t=>{var me;let e=(0,H.c)(49),{schema:s,onSubmit:o,onBack:n}=t,c;e[0]===s?c=e[1]:(c=vt(s),e[0]=s,e[1]=c);let a=s,l;e[2]===a?l=e[3]:(l=yt(a),e[2]=a,e[3]=l);let b;e[4]!==c||e[5]!==l?(b={defaultValues:c,resolver:l,reValidateMode:"onChange"},e[4]=c,e[5]=l,e[6]=b):b=e[6];let p=bt(b),f=(me=[...Ee,...Fe].find($=>$.schema===s))==null?void 0:me.connectionLibraries,[y,k]=(0,K.useState)((f==null?void 0:f.preferred)??"sqlalchemy"),{createNewCell:g}=He(),S=It(),v;e[7]!==g||e[8]!==S?(v=$=>{g({code:$,before:!1,cellId:S??"__end__",skipIfCodeExists:!0})},e[7]=g,e[8]=S,e[9]=v):v=e[9];let Y=v,W;e[10]!==Y||e[11]!==o||e[12]!==y?(W=$=>{Y(ns($,y)),o()},e[10]=Y,e[11]=o,e[12]=y,e[13]=W):W=e[13];let X=W,R;e[14]!==p||e[15]!==X?(R=p.handleSubmit(X),e[14]=p,e[15]=X,e[16]=R):R=e[16];let M;e[17]===Symbol.for("react.memo_cache_sentinel")?(M=(0,r.jsx)(pt,{}),e[17]=M):M=e[17];let I;e[18]!==p||e[19]!==s?(I=(0,r.jsx)(cs,{children:(0,r.jsx)(Rt,{schema:s,form:p,renderers:us,children:M})}),e[18]=p,e[19]=s,e[20]=I):I=e[20];let T;e[21]===n?T=e[22]:(T=(0,r.jsx)(ie,{type:"button",variant:"outline",onClick:n,children:"Back"}),e[21]=n,e[22]=T);let Z=!p.formState.isValid,D;e[23]===Z?D=e[24]:(D=(0,r.jsx)(ie,{type:"submit",disabled:Z,children:"Add"}),e[23]=Z,e[24]=D);let q;e[25]!==T||e[26]!==D?(q=(0,r.jsxs)("div",{className:"flex gap-2",children:[T,D]}),e[25]=T,e[26]=D,e[27]=q):q=e[27];let ee=st,L;e[28]===Symbol.for("react.memo_cache_sentinel")?(L=$=>k($),e[28]=L):L=e[28];let N;e[29]===Symbol.for("react.memo_cache_sentinel")?(N=(0,r.jsxs)("div",{className:"flex flex-col gap-1 items-end",children:[(0,r.jsx)(tt,{children:(0,r.jsx)(Ye,{placeholder:"Select a library"})}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Preferred connection library"})]}),e[29]=N):N=e[29];let te=Ze,se=et,ne=f==null?void 0:f.libraries.map(ys),P;e[30]!==se||e[31]!==ne?(P=(0,r.jsx)(se,{children:ne}),e[30]=se,e[31]=ne,e[32]=P):P=e[32];let E;e[33]!==te||e[34]!==P?(E=(0,r.jsx)(te,{children:P}),e[33]=te,e[34]=P,e[35]=E):E=e[35];let F;e[36]!==ee||e[37]!==y||e[38]!==L||e[39]!==N||e[40]!==E?(F=(0,r.jsx)("div",{children:(0,r.jsxs)(ee,{value:y,onValueChange:L,children:[N,E]})}),e[36]=ee,e[37]=y,e[38]=L,e[39]=N,e[40]=E,e[41]=F):F=e[41];let B;e[42]!==q||e[43]!==F?(B=(0,r.jsxs)("div",{className:"flex gap-2 justify-between",children:[q,F]}),e[42]=q,e[43]=F,e[44]=B):B=e[44];let Q;return e[45]!==I||e[46]!==B||e[47]!==R?(Q=(0,r.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[I,B]}),e[45]=I,e[46]=B,e[47]=R,e[48]=Q):Q=e[48],Q},fs=t=>{let e=(0,H.c)(5),{onSubmit:s}=t,[o,n]=(0,K.useState)(null);if(!o){let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,r.jsx)(ms,{onSelect:n}),e[0]=l):l=e[0],l}let c;e[1]===Symbol.for("react.memo_cache_sentinel")?(c=()=>n(null),e[1]=c):c=e[1];let a;return e[2]!==s||e[3]!==o?(a=(0,r.jsx)(bs,{schema:o,onSubmit:s,onBack:c}),e[2]=s,e[3]=o,e[4]=a):a=e[4],a};const gs=t=>{let e=(0,H.c)(6),{children:s}=t,[o,n]=(0,K.useState)(!1),c;e[0]===s?c=e[1]:(c=(0,r.jsx)(wt,{asChild:!0,children:s}),e[0]=s,e[1]=c);let a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,r.jsx)(Be,{onClose:()=>n(!1)}),e[2]=a):a=e[2];let l;return e[3]!==o||e[4]!==c?(l=(0,r.jsxs)($t,{open:o,onOpenChange:n,children:[c,a]}),e[3]=o,e[4]=c,e[5]=l):l=e[5],l},Be=t=>{let e=(0,H.c)(4),{onClose:s}=t,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,r.jsx)(St,{children:"Add Connection"}),e[0]=o):o=e[0];let n;e[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsxs)(_t,{className:"mb-4",children:[o,(0,r.jsxs)(kt,{children:["Connect to your database or data catalog to query data directly from your notebook. Learn more about how to connect to your database in our"," ",(0,r.jsx)(At,{href:"https://docs.marimo.io/guides/working_with_data/sql/#connecting-to-a-custom-database",children:"docs."})]})]}),e[1]=n):n=e[1];let c;return e[2]===s?c=e[3]:(c=(0,r.jsxs)(xt,{className:"max-h-[75vh] overflow-y-auto",children:[n,(0,r.jsx)(fs,{onSubmit:()=>s()})]}),e[2]=s,e[3]=c),c};function ys(t){return(0,r.jsx)(Xe,{value:t,children:Ne[t]},t)}export{Be as n,gs as t};
