import{s as ne}from"./chunk-DZLz74EQ.js";import{c as $e,l as Ut,s as Xt,u as Yt}from"./jotai-DDOP7CKM.js";import{t as qt}from"./react-BcIddLXZ.js";import{At as Vt,E as Bt,Pt as Jt,X as $t}from"./cells-B6jS0AIj.js";import"./react-dom-D6bRRS5R.js";import{C as Ke,E as Kt,F as Qt,z as at}from"./zod-U2NFpcFA.js";import{n as ze,t as Zt}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-D5Z9rM2X.js";import"./isSymbol-xTSywenE.js";import"./_arrayMap-DQI2GUNb.js";import"./toString-CBnct2wx.js";import"./toNumber-CTOPJrpu.js";import"./toInteger-Bor4StOs.js";import"./isArrayLikeObject-DKyJYtr8.js";import"./_getTag-CVRrQL_Q.js";import"./_baseIsEqual-BF8660ot.js";import"./_toKey-Di_xoXjD.js";import"./memoize-CAcr7Wct.js";import"./get-BYzWDFJH.js";import"./merge-BgA7kxZb.js";import"./_baseSlice-B27Cqkm6.js";import"./upperFirst-DOlTOwhh.js";import"./_hasUnicode-CPHpt5EV.js";import"./capitalize-CkrfIDeS.js";import"./_arrayReduce-DDpPg0Qh.js";import"./startCase-DOk4LYuA.js";import"./_baseProperty-CIKnF2iY.js";import"./now-B6JN1xKT.js";import"./debounce-70y9MzDK.js";import{t as nt}from"./isEmpty-z92iM7uZ.js";import"./client-D7HR2pz-.js";import{u as B}from"./hotkeys-Lbk6RHir.js";import"./invariant-DPGusy7Z.js";import{n as Gt,r as er}from"./utils-DnJCRgaX.js";import"./constants-DIZnpo2K.js";import{a as tr}from"./config-BjdJmdrN.js";import"./useHotkey-BxEtU0rE.js";import{o as ie}from"./useEventListener-C5BS4xuN.js";import{t as V}from"./cn-C5VTNYKf.js";import{t as Y}from"./button-nRVaalxL.js";import"./dist-BPcMnGQn.js";import"./dist-pZAIwcZo.js";import"./once-Co7xi2Ip.js";import"./capabilities-DdXtcIOa.js";import"./createReducer-80xvKyHq.js";import{r as rr}from"./requests-D3Z6okhb.js";import"./preload-helper-BpItL31i.js";import"./dist-C13bkrcz.js";import"./dist-DZNGKufD.js";import"./dist-DBeOBCHw.js";import"./dist-Ba10OKR3.js";import"./dist-D-CsU-_R.js";import"./dist-ClBFnEcy.js";import"./stex-LEaAsvUb.js";import"./Deferred-zIiWPYX3.js";import"./uuid-Dj56ryH_.js";import"./key-DWQdrH_J.js";import{t as or}from"./use-toast-BiL_AQz9.js";import"./main-CD7jouuS.js";import"./marked.esm-DCf1d_lA.js";import"./connection-DnLUBy9M.js";import"./dist-Q3T6mWQ0.js";import"./useTheme-BMknLtnH.js";import"./createLucideIcon-DA8ZBm4D.js";import{D as lr,O as sr,S as ar,T as nr,_ as ir,c as it,d as cr,f as dr,l as mr,m as ur,n as ct,p as pr,u as dt,y as hr}from"./add-cell-with-ai-DsqPH829.js";import"./between-horizontal-start-T2r-KWkg.js";import{n as Qe,t as fr}from"./square-CF_LAdAS.js";import{c as xr,o as vr,t as gr}from"./ai-model-dropdown-CtXN4x7s.js";import{i as br,n as mt}from"./state-CDeJMOf9.js";import"./type-Cpth3na1.js";import"./check-BUgsJwxM.js";import{a as wr,i as jr,n as yr,p as Sr,r as Nr,s as Cr,t as _r}from"./select-DJ0A_oCR.js";import"./chevron-right-WxQzIptp.js";import"./ansi_up-HmF1kpkv.js";import{n as Rr}from"./plug-p5jUW51S.js";import"./toDate-sQp07c5U.js";import{t as Ar}from"./circle-x-DGA84U3r.js";import"./dropdown-menu-1SGi7wHR.js";import"./copy-CWjpIcfl.js";import"./download-B7wrfIWv.js";import"./file-text-Cng4_CT2.js";import"./file-CEq0dl8f.js";import"./image-C0wlzN76.js";import{n as ut}from"./spinner-FaMZ5NTl.js";import{n as Tr,t as Er}from"./send-BWOx6HDI.js";import"./play-BOSd7i5f.js";import{t as Pr}from"./plus-CmzxQYgQ.js";import"./refresh-cw-9lSVG80g.js";import{Ft as Lr,r as pt}from"./input-BPw9p_8N.js";import{t as kr}from"./settings-BR_jkuLF.js";import"./sparkles-CyIU0Xy_.js";import"./form-b4A0F_Lr.js";import"./trash-2-DtsdG6Pf.js";import"./VisuallyHidden-DioJ3bf_.js";import{c as zr}from"./datasource-CzmVjgw7.js";import"./useNonce-DECX9FAH.js";import"./badge-CFi0nvIx.js";import{S as Ir,_ as Ie,b as J,h as fe,m as $,y as Dr}from"./Combination-DR4iFoRS.js";import"./dist-Cei_8ikW.js";import{i as ht,t as ce}from"./tooltip-BQKXsEoT.js";import"./useLifecycle-CuZnZLRp.js";import{u as Mr}from"./menu-items-DOc2hwO2.js";import"./tslib.es6-sakIzgHM.js";import{i as Fr}from"./dates-CSR6KU2P.js";import"./en-US-CUvYxyLA.js";import"./isValid-BcG0nMKW.js";import"./alert-dialog-DM1h8RhU.js";import"./dialog-CEqVOFHc.js";import{t as Or}from"./context-BMtIGcq8.js";import"./useNumberFormatter-DynX1ecE.js";import"./shim-Bk8nzKPV.js";import"./SelectionIndicator-BZgcq5mv.js";import"./numbers-Hxwz5HuE.js";import{n as K}from"./useEvent-d8iQXgui.js";import"./useDebounce-BDmbJDbT.js";import"./ImperativeModal-CmOSTULR.js";import"./strings-DSmr2a_p.js";import"./errors-5BnWGoql.js";import"./copy-DAqXDCGN.js";import{t as Wr}from"./copy-icon-5DWltDxB.js";import"./useRunCells-uzADaSkg.js";import{i as ft,n as xt,r as vt,t as gt}from"./accordion-BlX0p_kD.js";import"./extends-C-tvimwN.js";import"./objectWithoutPropertiesLoose-DDvr5cHq.js";import"./useAsyncData-CsBCDF11.js";import{n as Hr}from"./error-banner-RIuTelB8.js";import"./kbd-CZFOBQmt.js";import"./renderShortcut-GP8-boTA.js";import"./label-6DIjJ2sP.js";import"./LazyAnyLanguageCodeMirror-PGusm5pp.js";import{i as Ur,r as Xr,t as Yr}from"./popover-BM0PuIZH.js";import"./cell-link-D9FNaXGs.js";import"./es-Bvr8zSR1.js";import"./dom-DaBOvHqM.js";import"./blob-COEMBEnt.js";import"./useDeleteCell-BSTJX7_O.js";import"./add-missing-import-BJfCTctT.js";import"./esm-ChGlv0th.js";import"./icons-j8BJ30se.js";import"./table-mB7CFPse.js";import"./links-DCKgyNFq.js";import{r as bt,t as qr}from"./state-CMOQfD_O.js";import"./tabs-CwHEUPW2.js";import"./focus-NSCHuycv.js";import"./textarea-CuEW04Ze.js";import"./switch-CEMEIJww.js";import{n as Vr,r as Ze,t as Br}from"./chat-components-BLmXAcnM.js";import"./katex-D-wkbNrJ.js";import{t as Ge}from"./empty-state-NyXKwoVS.js";var wt=ne(ze(),1),h=ne(qt(),1);const Jr=({chatState:t,chatId:e,messages:r})=>{if(!e)return B.warn("No active chat"),t;let a=t.chats.get(e);if(!a)return B.warn("No active chat"),t;let l=new Map(t.chats),s=Date.now();return l.set(a.id,{...a,messages:r,updatedAt:s}),{...t,chats:l}};var o=ne(Zt(),1);function $r(t,e){return h.useReducer((r,a)=>e[r][a]??r,t)}var et="ScrollArea",[jt,Pa]=Ir(et),[Kr,O]=jt(et),yt=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,type:a="hover",dir:l,scrollHideDelay:s=600,...n}=t,[i,c]=h.useState(null),[m,d]=h.useState(null),[u,p]=h.useState(null),[f,v]=h.useState(null),[j,b]=h.useState(null),[x,S]=h.useState(0),[R,y]=h.useState(0),[C,_]=h.useState(!1),[P,L]=h.useState(!1),w=ie(e,k=>c(k)),T=Mr(l);return(0,o.jsx)(Kr,{scope:r,type:a,dir:T,scrollHideDelay:s,scrollArea:i,viewport:m,onViewportChange:d,content:u,onContentChange:p,scrollbarX:f,onScrollbarXChange:v,scrollbarXEnabled:C,onScrollbarXEnabledChange:_,scrollbarY:j,onScrollbarYChange:b,scrollbarYEnabled:P,onScrollbarYEnabledChange:L,onCornerWidthChange:S,onCornerHeightChange:y,children:(0,o.jsx)(fe.div,{dir:T,...n,ref:w,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":R+"px",...t.style}})})});yt.displayName=et;var St="ScrollAreaViewport",Nt=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,children:a,nonce:l,...s}=t,n=O(St,r),i=ie(e,h.useRef(null),n.onViewportChange);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),(0,o.jsx)(fe.div,{"data-radix-scroll-area-viewport":"",...s,ref:i,style:{overflowX:n.scrollbarXEnabled?"scroll":"hidden",overflowY:n.scrollbarYEnabled?"scroll":"hidden",...t.style},children:(0,o.jsx)("div",{ref:n.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});Nt.displayName=St;var H="ScrollAreaScrollbar",tt=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=O(H,t.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:n}=l,i=t.orientation==="horizontal";return h.useEffect(()=>(i?s(!0):n(!0),()=>{i?s(!1):n(!1)}),[i,s,n]),l.type==="hover"?(0,o.jsx)(Qr,{...a,ref:e,forceMount:r}):l.type==="scroll"?(0,o.jsx)(Zr,{...a,ref:e,forceMount:r}):l.type==="auto"?(0,o.jsx)(Ct,{...a,ref:e,forceMount:r}):l.type==="always"?(0,o.jsx)(rt,{...a,ref:e}):null});tt.displayName=H;var Qr=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=O(H,t.__scopeScrollArea),[s,n]=h.useState(!1);return h.useEffect(()=>{let i=l.scrollArea,c=0;if(i){let m=()=>{window.clearTimeout(c),n(!0)},d=()=>{c=window.setTimeout(()=>n(!1),l.scrollHideDelay)};return i.addEventListener("pointerenter",m),i.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),i.removeEventListener("pointerenter",m),i.removeEventListener("pointerleave",d)}}},[l.scrollArea,l.scrollHideDelay]),(0,o.jsx)(Ie,{present:r||s,children:(0,o.jsx)(Ct,{"data-state":s?"visible":"hidden",...a,ref:e})})}),Zr=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=O(H,t.__scopeScrollArea),s=t.orientation==="horizontal",n=Oe(()=>c("SCROLL_END"),100),[i,c]=$r("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return h.useEffect(()=>{if(i==="idle"){let m=window.setTimeout(()=>c("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(m)}},[i,l.scrollHideDelay,c]),h.useEffect(()=>{let m=l.viewport,d=s?"scrollLeft":"scrollTop";if(m){let u=m[d],p=()=>{let f=m[d];u!==f&&(c("SCROLL"),n()),u=f};return m.addEventListener("scroll",p),()=>m.removeEventListener("scroll",p)}},[l.viewport,s,c,n]),(0,o.jsx)(Ie,{present:r||i!=="hidden",children:(0,o.jsx)(rt,{"data-state":i==="hidden"?"hidden":"visible",...a,ref:e,onPointerEnter:J(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:J(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Ct=h.forwardRef((t,e)=>{let r=O(H,t.__scopeScrollArea),{forceMount:a,...l}=t,[s,n]=h.useState(!1),i=t.orientation==="horizontal",c=Oe(()=>{if(r.viewport){let m=r.viewport.offsetWidth<r.viewport.scrollWidth,d=r.viewport.offsetHeight<r.viewport.scrollHeight;n(i?m:d)}},10);return de(r.viewport,c),de(r.content,c),(0,o.jsx)(Ie,{present:a||s,children:(0,o.jsx)(rt,{"data-state":s?"visible":"hidden",...l,ref:e})})}),rt=h.forwardRef((t,e)=>{let{orientation:r="vertical",...a}=t,l=O(H,t.__scopeScrollArea),s=h.useRef(null),n=h.useRef(0),[i,c]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=Et(i.viewport,i.content),d={...a,sizes:i,onSizesChange:c,hasThumb:m>0&&m<1,onThumbChange:p=>s.current=p,onThumbPointerUp:()=>n.current=0,onThumbPointerDown:p=>n.current=p};function u(p,f){return lo(p,n.current,i,f)}return r==="horizontal"?(0,o.jsx)(Gr,{...d,ref:e,onThumbPositionChange:()=>{if(l.viewport&&s.current){let p=l.viewport.scrollLeft,f=Pt(p,i,l.dir);s.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:p=>{l.viewport&&(l.viewport.scrollLeft=p)},onDragScroll:p=>{l.viewport&&(l.viewport.scrollLeft=u(p,l.dir))}}):r==="vertical"?(0,o.jsx)(eo,{...d,ref:e,onThumbPositionChange:()=>{if(l.viewport&&s.current){let p=l.viewport.scrollTop,f=Pt(p,i);s.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:p=>{l.viewport&&(l.viewport.scrollTop=p)},onDragScroll:p=>{l.viewport&&(l.viewport.scrollTop=u(p))}}):null}),Gr=h.forwardRef((t,e)=>{let{sizes:r,onSizesChange:a,...l}=t,s=O(H,t.__scopeScrollArea),[n,i]=h.useState(),c=h.useRef(null),m=ie(e,c,s.onScrollbarXChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),(0,o.jsx)(Rt,{"data-orientation":"horizontal",...l,ref:m,sizes:r,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Fe(r)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,u)=>{if(s.viewport){let p=s.viewport.scrollLeft+d.deltaX;t.onWheelScroll(p),kt(p,u)&&d.preventDefault()}},onResize:()=>{c.current&&s.viewport&&n&&a({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Me(n.paddingLeft),paddingEnd:Me(n.paddingRight)}})}})}),eo=h.forwardRef((t,e)=>{let{sizes:r,onSizesChange:a,...l}=t,s=O(H,t.__scopeScrollArea),[n,i]=h.useState(),c=h.useRef(null),m=ie(e,c,s.onScrollbarYChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),(0,o.jsx)(Rt,{"data-orientation":"vertical",...l,ref:m,sizes:r,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Fe(r)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,u)=>{if(s.viewport){let p=s.viewport.scrollTop+d.deltaY;t.onWheelScroll(p),kt(p,u)&&d.preventDefault()}},onResize:()=>{c.current&&s.viewport&&n&&a({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Me(n.paddingTop),paddingEnd:Me(n.paddingBottom)}})}})}),[to,_t]=jt(H),Rt=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,sizes:a,hasThumb:l,onThumbChange:s,onThumbPointerUp:n,onThumbPointerDown:i,onThumbPositionChange:c,onDragScroll:m,onWheelScroll:d,onResize:u,...p}=t,f=O(H,r),[v,j]=h.useState(null),b=ie(e,w=>j(w)),x=h.useRef(null),S=h.useRef(""),R=f.viewport,y=a.content-a.viewport,C=$(d),_=$(c),P=Oe(u,10);function L(w){x.current&&m({x:w.clientX-x.current.left,y:w.clientY-x.current.top})}return h.useEffect(()=>{let w=T=>{let k=T.target;v!=null&&v.contains(k)&&C(T,y)};return document.addEventListener("wheel",w,{passive:!1}),()=>document.removeEventListener("wheel",w,{passive:!1})},[R,v,y,C]),h.useEffect(_,[a,_]),de(v,P),de(f.content,P),(0,o.jsx)(to,{scope:r,scrollbar:v,hasThumb:l,onThumbChange:$(s),onThumbPointerUp:$(n),onThumbPositionChange:_,onThumbPointerDown:$(i),children:(0,o.jsx)(fe.div,{...p,ref:b,style:{position:"absolute",...p.style},onPointerDown:J(t.onPointerDown,w=>{w.button===0&&(w.target.setPointerCapture(w.pointerId),x.current=v.getBoundingClientRect(),S.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),L(w))}),onPointerMove:J(t.onPointerMove,L),onPointerUp:J(t.onPointerUp,w=>{let T=w.target;T.hasPointerCapture(w.pointerId)&&T.releasePointerCapture(w.pointerId),document.body.style.webkitUserSelect=S.current,f.viewport&&(f.viewport.style.scrollBehavior=""),x.current=null})})})}),De="ScrollAreaThumb",At=h.forwardRef((t,e)=>{let{forceMount:r,...a}=t,l=_t(De,t.__scopeScrollArea);return(0,o.jsx)(Ie,{present:r||l.hasThumb,children:(0,o.jsx)(ro,{ref:e,...a})})}),ro=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,style:a,...l}=t,s=O(De,r),n=_t(De,r),{onThumbPositionChange:i}=n,c=ie(e,u=>n.onThumbChange(u)),m=h.useRef(void 0),d=Oe(()=>{m.current&&(m.current=(m.current(),void 0))},100);return h.useEffect(()=>{let u=s.viewport;if(u){let p=()=>{d(),m.current||(m.current=so(u,i),i())};return i(),u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[s.viewport,d,i]),(0,o.jsx)(fe.div,{"data-state":n.hasThumb?"visible":"hidden",...l,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:J(t.onPointerDownCapture,u=>{let p=u.target.getBoundingClientRect(),f=u.clientX-p.left,v=u.clientY-p.top;n.onThumbPointerDown({x:f,y:v})}),onPointerUp:J(t.onPointerUp,n.onThumbPointerUp)})});At.displayName=De;var ot="ScrollAreaCorner",Tt=h.forwardRef((t,e)=>{let r=O(ot,t.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&a?(0,o.jsx)(oo,{...t,ref:e}):null});Tt.displayName=ot;var oo=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,...a}=t,l=O(ot,r),[s,n]=h.useState(0),[i,c]=h.useState(0),m=!!(s&&i);return de(l.scrollbarX,()=>{var u;let d=((u=l.scrollbarX)==null?void 0:u.offsetHeight)||0;l.onCornerHeightChange(d),c(d)}),de(l.scrollbarY,()=>{var u;let d=((u=l.scrollbarY)==null?void 0:u.offsetWidth)||0;l.onCornerWidthChange(d),n(d)}),m?(0,o.jsx)(fe.div,{...a,ref:e,style:{width:s,height:i,position:"absolute",right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Me(t){return t?parseInt(t,10):0}function Et(t,e){let r=t/e;return isNaN(r)?0:r}function Fe(t){let e=Et(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-r)*e;return Math.max(a,18)}function lo(t,e,r,a="ltr"){let l=Fe(r),s=l/2,n=e||s,i=l-n,c=r.scrollbar.paddingStart+n,m=r.scrollbar.size-r.scrollbar.paddingEnd-i,d=r.content-r.viewport,u=a==="ltr"?[0,d]:[d*-1,0];return Lt([c,m],u)(t)}function Pt(t,e,r="ltr"){let a=Fe(e),l=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=e.scrollbar.size-l,n=e.content-e.viewport,i=s-a,c=Sr(t,r==="ltr"?[0,n]:[n*-1,0]);return Lt([0,n],[0,i])(c)}function Lt(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];let a=(e[1]-e[0])/(t[1]-t[0]);return e[0]+a*(r-t[0])}}function kt(t,e){return t>0&&t<e}var so=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},a=0;return(function l(){let s={left:t.scrollLeft,top:t.scrollTop},n=r.left!==s.left,i=r.top!==s.top;(n||i)&&e(),r=s,a=window.requestAnimationFrame(l)})(),()=>window.cancelAnimationFrame(a)};function Oe(t,e){let r=$(t),a=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(a.current),[]),h.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,e)},[r,e])}function de(t,e){let r=$(e);Dr(()=>{let a=0;if(t){let l=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(r)});return l.observe(t),()=>{window.cancelAnimationFrame(a),l.unobserve(t)}}},[t,r])}var zt=yt,ao=Nt,no=Tt,It=h.forwardRef((t,e)=>{let r=(0,wt.c)(15),a,l,s;r[0]===t?(a=r[1],l=r[2],s=r[3]):({className:l,children:a,...s}=t,r[0]=t,r[1]=a,r[2]=l,r[3]=s);let n;r[4]===l?n=r[5]:(n=V("relative overflow-hidden",l),r[4]=l,r[5]=n);let i;r[6]===a?i=r[7]:(i=(0,o.jsx)(ao,{className:"h-full w-full rounded-[inherit]",children:a}),r[6]=a,r[7]=i);let c,m;r[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Dt,{}),m=(0,o.jsx)(no,{}),r[8]=c,r[9]=m):(c=r[8],m=r[9]);let d;return r[10]!==s||r[11]!==e||r[12]!==n||r[13]!==i?(d=(0,o.jsxs)(zt,{ref:e,className:n,...s,children:[i,c,m]}),r[10]=s,r[11]=e,r[12]=n,r[13]=i,r[14]=d):d=r[14],d});It.displayName=zt.displayName;var Dt=h.forwardRef((t,e)=>{let r=(0,wt.c)(14),a,l,s;r[0]===t?(a=r[1],l=r[2],s=r[3]):({className:a,orientation:s,...l}=t,r[0]=t,r[1]=a,r[2]=l,r[3]=s);let n=s===void 0?"vertical":s,i=n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",c=n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-px",m;r[4]!==a||r[5]!==i||r[6]!==c?(m=V("flex touch-none select-none transition-colors",i,c,a),r[4]=a,r[5]=i,r[6]=c,r[7]=m):m=r[7];let d;r[8]===Symbol.for("react.memo_cache_sentinel")?(d=(0,o.jsx)(At,{className:"relative flex-1 rounded-full bg-border"}),r[8]=d):d=r[8];let u;return r[9]!==n||r[10]!==l||r[11]!==e||r[12]!==m?(u=(0,o.jsx)(tt,{ref:e,orientation:n,className:m,...l,children:d}),r[9]=n,r[10]=l,r[11]=e,r[12]=m,r[13]=u):u=r[13],u});Dt.displayName=tt.displayName;var io=[{label:"Today",days:0},{label:"Yesterday",days:1},{label:"2d ago",days:2},{label:"3d ago",days:3},{label:"This week",days:7},{label:"This month",days:30}];const co=t=>{let e=Date.now(),r=io.map(s=>({...s,chats:[]})),a={label:"Older",days:1/0,chats:[]},l=s=>{switch(s){case 0:return r[0];case 1:return r[1];case 2:return r[2];case 3:return r[3];default:return s>=4&&s<=7?r[4]:s>=8&&s<=30?r[5]:a}};for(let s of t)l(Math.floor((e-s.updatedAt)/864e5)).chats.push(s);return[...r,a].filter(s=>s.chats.length>0)},mo=({activeChatId:t,setActiveChat:e})=>{let r=$e(bt),{locale:a}=Or(),[l,s]=(0,h.useState)(""),n=(0,h.useMemo)(()=>[...r.chats.values()].sort((m,d)=>d.updatedAt-m.updatedAt),[r.chats]),i=(0,h.useMemo)(()=>l.trim()?n.filter(m=>m.title.toLowerCase().includes(l.toLowerCase())):n,[n,l]),c=(0,h.useMemo)(()=>co(i),[i]);return(0,o.jsxs)(Yr,{children:[(0,o.jsx)(ce,{content:"Previous chats",children:(0,o.jsx)(Ur,{asChild:!0,children:(0,o.jsx)(Y,{variant:"text",size:"icon",children:(0,o.jsx)(Jt,{className:"h-4 w-4"})})})}),(0,o.jsxs)(Xr,{className:"w-[480px] p-0",align:"start",side:"right",children:[(0,o.jsx)("div",{className:"pt-3 px-3 w-full",children:(0,o.jsx)(pt,{placeholder:"Search chat history...",value:l,onChange:m=>s(m.target.value),className:"text-xs"})}),(0,o.jsx)(It,{className:"h-[450px] p-2",children:(0,o.jsxs)("div",{className:"space-y-3",children:[n.length===0&&(0,o.jsx)(Ge,{title:"No chats yet",description:"Start a new chat to get started",icon:(0,o.jsx)(Qe,{})}),i.length===0&&l&&n.length>0&&(0,o.jsx)(Ge,{title:"No chats found",description:`No chats match "${l}"`,icon:(0,o.jsx)(Lr,{})}),c.map((m,d)=>(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("div",{className:"text-xs px-1 text-muted-foreground/60",children:m.label}),(0,o.jsx)("div",{children:m.chats.map(u=>(0,o.jsxs)("button",{className:V("w-full p-1 rounded-md cursor-pointer text-left flex items-center justify-between",u.id===t&&"bg-accent",u.id!==t&&"hover:bg-muted/20"),onClick:()=>{e(u.id)},type:"button",children:[(0,o.jsx)("div",{className:"flex-1 min-w-0",children:(0,o.jsx)("div",{className:"text-sm truncate",children:u.title})}),(0,o.jsx)("div",{className:"text-xs text-muted-foreground/60 ml-2 flex-shrink-0",children:Fr(u.updatedAt,a)})]},u.id))}),d!==c.length-1&&(0,o.jsx)("hr",{})]},m.label))]})})]})]})};var uo=ne(ze(),1);const po=t=>{let e=(0,uo.c)(13),{reasoning:r,index:a,isStreaming:l}=t,s=a===void 0?0:a,n=l===void 0?!1:l,i=n?"reasoning":void 0,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Qe,{className:"h-3 w-3"}),e[0]=c):c=e[0];let m=n?"Thinking":"View reasoning",d;e[1]!==r.length||e[2]!==m?(d=(0,o.jsx)(ft,{className:"text-xs text-muted-foreground hover:bg-muted/50 px-2 py-1 h-auto rounded-sm [&[data-state=open]>svg]:rotate-180",children:(0,o.jsxs)("span",{className:"flex items-center gap-2",children:[c,m," (",r.length," ","chars)"]})}),e[1]=r.length,e[2]=m,e[3]=d):d=e[3];let u;e[4]===r?u=e[5]:(u=(0,o.jsx)(xt,{className:"pb-2 px-2",children:(0,o.jsx)("div",{className:"bg-muted/30 border border-muted/50 rounded-md p-3 italic text-muted-foreground/90 relative",children:(0,o.jsx)("div",{className:"pr-6",children:(0,o.jsx)(Ze,{content:r})})})}),e[4]=r,e[5]=u);let p;e[6]!==d||e[7]!==u?(p=(0,o.jsxs)(vt,{value:"reasoning",className:"border-0",children:[d,u]}),e[6]=d,e[7]=u,e[8]=p):p=e[8];let f;return e[9]!==s||e[10]!==i||e[11]!==p?(f=(0,o.jsx)(gt,{type:"single",collapsible:!0,className:"w-full mb-2",value:i,children:p},s),e[9]=s,e[10]=i,e[11]=p,e[12]=f):f=e[12],f};var We=ne(ze(),1),ho=Qt({status:at().default("success"),auth_required:Kt().default(!1),action_url:Ke(),next_steps:Ke(),meta:Ke(),message:at().nullish()}).passthrough(),fo=t=>{let e=(0,We.c)(12),{data:r}=t,a;if(e[0]!==r){let{status:l,auth_required:s,action_url:n,meta:i,next_steps:c,message:m,...d}=r,u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=(0,o.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground",children:"Tool Result"}),e[2]=u):u=e[2];let p;e[3]===l?p=e[4]:(p=(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--grass-2)] text-[var(--grass-11)] rounded-full font-medium capitalize",children:l}),e[3]=l,e[4]=p);let f;e[5]===s?f=e[6]:(f=s&&(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--amber-2)] text-[var(--amber-11)] rounded-full",children:"Auth Required"}),e[5]=s,e[6]=f);let v;e[7]!==p||e[8]!==f?(v=(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[u,(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[p,f]})]}),e[7]=p,e[8]=f,e[9]=v):v=e[9];let j;e[10]===m?j=e[11]:(j=m&&(0,o.jsxs)("div",{className:"flex items-start gap-2",children:[(0,o.jsx)(Vt,{className:"h-3 w-3 text-[var(--blue-11)] mt-0.5 flex-shrink-0"}),(0,o.jsx)("div",{className:"text-xs text-foreground",children:m})]}),e[10]=m,e[11]=j),a=(0,o.jsxs)("div",{className:"flex flex-col gap-1.5",children:[v,j,d&&(0,o.jsx)("div",{className:"space-y-3",children:Object.entries(d).map(bo)})]}),e[0]=r,e[1]=a}else a=e[1];return a},xo=t=>{let e=(0,We.c)(8),{result:r}=t,a;e[0]===r?a=e[1]:(a=ho.safeParse(r),e[0]=r,e[1]=a);let l=a;if(l.success){let i;return e[2]===l.data?i=e[3]:(i=(0,o.jsx)(fo,{data:l.data}),e[2]=l.data,e[3]=i),i}let s;e[4]===r?s=e[5]:(s=typeof r=="string"?r:JSON.stringify(r,null,2),e[4]=r,e[5]=s);let n;return e[6]===s?n=e[7]:(n=(0,o.jsx)("div",{className:"text-xs font-medium text-muted-foreground mb-1 max-h-64 overflow-y-auto scrollbar-thin",children:s}),e[6]=s,e[7]=n),n},vo=t=>{let e=(0,We.c)(9),{input:r}=t;if(!(r&&r!==null))return null;let a;e[0]===r?a=e[1]:(a=nt(r),e[0]=r,e[1]=a);let l=a,s=typeof r=="object"&&Object.keys(r).length>0,n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground",children:"Tool Request"}),e[2]=n):n=e[2];let i;e[3]!==r||e[4]!==l||e[5]!==s?(i=l?"{}":s?JSON.stringify(r,null,2):String(r),e[3]=r,e[4]=l,e[5]=s,e[6]=i):i=e[6];let c;return e[7]===i?c=e[8]:(c=(0,o.jsxs)("div",{className:"space-y-2",children:[n,(0,o.jsx)("pre",{className:"bg-[var(--slate-2)] p-2 text-muted-foreground border border-[var(--slate-4)] rounded text-xs overflow-auto scrollbar-thin max-h-64",children:i})]}),e[7]=i,e[8]=c),c};const Mt=t=>{let e=(0,We.c)(38),{toolName:r,result:a,error:l,index:s,state:n,className:i,input:c}=t,m=s===void 0?0:s,d=n==="output-available"&&(a||l),u=l?"error":d?"success":"loading",p;e[0]===u?p=e[1]:(p=()=>{switch(u){case"loading":return(0,o.jsx)(ut,{className:"h-3 w-3 animate-spin"});case"error":return(0,o.jsx)(Ar,{className:"h-3 w-3 text-[var(--red-11)]"});case"success":return(0,o.jsx)(Rr,{className:"h-3 w-3 text-[var(--grass-11)]"});default:return(0,o.jsx)(zr,{className:"h-3 w-3"})}},e[0]=u,e[1]=p);let f=p,v;e[2]!==l||e[3]!==d||e[4]!==u?(v=()=>u==="loading"?"Running":l?"Failed":d?"Done":"Tool call",e[2]=l,e[3]=d,e[4]=u,e[5]=v):v=e[5];let j=v,b=`tool-${m}`,x;e[6]===i?x=e[7]:(x=V("w-full",i),e[6]=i,e[7]=x);let S=u==="error"&&"text-[var(--red-11)]/80",R=u==="success"&&"text-[var(--grass-11)]/80",y;e[8]!==S||e[9]!==R?(y=V("h-6 text-xs border-border shadow-none! ring-0! bg-muted/60 hover:bg-muted py-0 px-2 gap-1 rounded-sm [&[data-state=open]>svg]:rotate-180 hover:no-underline",S,R),e[8]=S,e[9]=R,e[10]=y):y=e[10];let C;e[11]===f?C=e[12]:(C=f(),e[11]=f,e[12]=C);let _=j(),P;e[13]===r?P=e[14]:(P=go(r),e[13]=r,e[14]=P);let L;e[15]===P?L=e[16]:(L=(0,o.jsx)("code",{className:"font-mono text-xs",children:P}),e[15]=P,e[16]=L);let w;e[17]!==_||e[18]!==L||e[19]!==C?(w=(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[C,_,":",L]}),e[17]=_,e[18]=L,e[19]=C,e[20]=w):w=e[20];let T;e[21]!==w||e[22]!==y?(T=(0,o.jsx)(ft,{className:y,children:w}),e[21]=w,e[22]=y,e[23]=T):T=e[23];let k;e[24]!==l||e[25]!==d||e[26]!==c||e[27]!==a?(k=d&&(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)(vo,{input:c}),a!=null&&(0,o.jsx)(xo,{result:a}),l&&(0,o.jsxs)("div",{className:"bg-[var(--red-2)] border border-[var(--red-6)] rounded-lg p-3",children:[(0,o.jsxs)("div",{className:"text-xs font-semibold text-[var(--red-11)] mb-2 flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-[var(--red-9)] rounded-full"}),"Error"]}),(0,o.jsx)("div",{className:"text-sm text-[var(--red-11)] leading-relaxed",children:l})]})]}),e[24]=l,e[25]=d,e[26]=c,e[27]=a,e[28]=k):k=e[28];let A;e[29]===k?A=e[30]:(A=(0,o.jsx)(xt,{className:"py-2 px-2",children:k}),e[29]=k,e[30]=A);let E;e[31]!==T||e[32]!==A?(E=(0,o.jsxs)(vt,{value:"tool-call",className:"border-0",children:[T,A]}),e[31]=T,e[32]=A,e[33]=E):E=e[33];let I;return e[34]!==E||e[35]!==b||e[36]!==x?(I=(0,o.jsx)(gt,{type:"single",collapsible:!0,className:x,children:E},b),e[34]=E,e[35]=b,e[36]=x,e[37]=I):I=e[37],I};function go(t){return t.replace("tool-","")}function bo(t){let[e,r]=t;return nt(r)?null:(0,o.jsxs)("div",{className:"space-y-1.5",children:[(0,o.jsxs)("div",{className:"text-xs font-medium text-muted-foreground capitalize flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-[var(--blue-9)] rounded-full"}),e]}),(0,o.jsx)("pre",{className:"bg-[var(--slate-2)] p-2 text-muted-foreground border border-[var(--slate-4)] rounded text-xs overflow-auto scrollbar-thin max-h-64",children:JSON.stringify(r,null,2)})]},e)}var me=ne(ze(),1),wo="manual",jo=new Set(["openai","google","anthropic"]),yo=["image/*","text/*"],So=1024*1024*50,No=t=>{let e=(0,me.c)(18),{onNewChat:r,activeChatId:a,setActiveChat:l}=t,{handleClick:s}=mt(),n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,o.jsx)(Pr,{className:"h-4 w-4"}),e[0]=n):n=e[0];let i;e[1]===r?i=e[2]:(i=(0,o.jsx)(ce,{content:"New chat",children:(0,o.jsx)(Y,{variant:"text",size:"icon",onClick:r,children:n})}),e[1]=r,e[2]=i);let c;e[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(br,{}),e[3]=c):c=e[3];let m;e[4]===s?m=e[5]:(m=()=>s("ai"),e[4]=s,e[5]=m);let d;e[6]===Symbol.for("react.memo_cache_sentinel")?(d=(0,o.jsx)(kr,{className:"h-4 w-4"}),e[6]=d):d=e[6];let u;e[7]===m?u=e[8]:(u=(0,o.jsx)(ce,{content:"AI Settings",children:(0,o.jsx)(Y,{variant:"text",size:"xs",className:"hover:bg-foreground/10 py-2",onClick:m,children:d})}),e[7]=m,e[8]=u);let p;e[9]!==a||e[10]!==l?(p=(0,o.jsx)(mo,{activeChatId:a,setActiveChat:l}),e[9]=a,e[10]=l,e[11]=p):p=e[11];let f;e[12]!==u||e[13]!==p?(f=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[c,u,p]}),e[12]=u,e[13]=p,e[14]=f):f=e[14];let v;return e[15]!==i||e[16]!==f?(v=(0,o.jsxs)("div",{className:"flex border-b px-2 py-1 justify-between shrink-0 items-center",children:[i,f]}),e[15]=i,e[16]=f,e[17]=v):v=e[17],v};function Co(t){return t.type.startsWith("tool-")}var Ft=(0,h.memo)(t=>{let e=(0,me.c)(15),{message:r,index:a,onEdit:l,isStreamingReasoning:s,isLast:n}=t,i;e[0]!==a||e[1]!==l?(i=j=>{var S,R,y;let b=(R=(S=j.parts)==null?void 0:S.filter(To))==null?void 0:R.map(Eo).join(`
`),x=(y=j.parts)==null?void 0:y.filter(Po);return(0,o.jsxs)("div",{className:"w-[95%] bg-background border p-1 rounded-sm",children:[x==null?void 0:x.map(Lo),(0,o.jsx)(ct,{value:b,placeholder:"Type your message...",onChange:ko,onSubmit:(C,_)=>{_.trim()&&l(a,_)},onClose:zo},j.id)]})},e[0]=a,e[1]=l,e[2]=i):i=e[2];let c=i,m;e[3]!==n||e[4]!==s?(m=j=>(0,o.jsxs)("div",{className:"w-[95%] break-words",children:[(0,o.jsx)("div",{className:"absolute right-1 top-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,o.jsx)(Wr,{className:"h-3 w-3",value:j.parts.filter(Io).map(Do).join(`
`)||""})}),j.parts.map((b,x)=>{if(Co(b))return(0,o.jsx)(Mt,{index:x,toolName:b.type,result:b.output,className:"my-2",state:b.state,input:b.input},x);switch(b.type){case"text":return(0,o.jsx)(Ze,{content:b.text},x);case"reasoning":return(0,o.jsx)(po,{reasoning:b.text,index:x,isStreaming:n&&s&&x===(j.parts.length||0)-1},x);case"dynamic-tool":return(0,o.jsx)(Mt,{index:x,toolName:b.type,result:b.output,state:b.state,input:b.input,className:"my-2"},x);case"data-reasoning-signature":return null;default:if(b.type.startsWith("data-"))return B.log("Found data part",b),null;B.error("Unhandled part type:",b.type);try{return(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,o.jsx)(Ze,{content:JSON.stringify(b,null,2)})},x)}catch(S){let R=S;return B.error("Error rendering part:",b.type,R),null}}})]}),e[3]=n,e[4]=s,e[5]=m):m=e[5];let d=m,u=r.role==="user"?"justify-end":"justify-start",p;e[6]===u?p=e[7]:(p=V("flex group relative",u),e[6]=u,e[7]=p);let f;e[8]!==r||e[9]!==d||e[10]!==c?(f=r.role==="user"?c(r):d(r),e[8]=r,e[9]=d,e[10]=c,e[11]=f):f=e[11];let v;return e[12]!==p||e[13]!==f?(v=(0,o.jsx)("div",{className:p,children:f}),e[12]=p,e[13]=f,e[14]=v):v=e[14],v});Ft.displayName="ChatMessage";var Ot=(0,h.memo)(t=>{var xe;let e=(0,me.c)(37),{isEmpty:r,onSendClick:a,isLoading:l,onStop:s,fileInputRef:n,onAddFiles:i,onAddContext:c}=t,m=$e(Gt),d=(m==null?void 0:m.mode)||wo,u=((xe=m==null?void 0:m.models)==null?void 0:xe.chat_model)||"openai/gpt-4o",p=vr.parse(u).providerId,{saveModeChange:f}=xr(),v;e[0]===Symbol.for("react.memo_cache_sentinel")?(v=[{value:"ask",label:"Ask",subtitle:"Use AI with access to read-only tools like documentation search"},{value:"manual",label:"Manual",subtitle:"Pure chat, no tool usage"},{value:"agent",label:"Agent (beta)",subtitle:"Use AI with access to read and write tools"}],e[0]=v):v=e[0];let j=v,b=jo.has(p),x;e[1]===d?x=e[2]:(x=(0,o.jsx)(Cr,{className:"h-6 text-xs border-border shadow-none! ring-0! bg-muted hover:bg-muted/30 py-0 px-2 gap-1 capitalize",children:d}),e[1]=d,e[2]=x);let S;e[3]===Symbol.for("react.memo_cache_sentinel")?(S=(0,o.jsx)(wr,{children:"AI Mode"}),e[3]=S):S=e[3];let R;e[4]===j?R=e[5]:(R=(0,o.jsx)(yr,{children:(0,o.jsxs)(Nr,{children:[S,j.map(Mo)]})}),e[4]=j,e[5]=R);let y;e[6]!==d||e[7]!==f||e[8]!==x||e[9]!==R?(y=(0,o.jsx)($t,{feature:"chat_modes",children:(0,o.jsxs)(_r,{value:d,onValueChange:f,children:[x,R]})}),e[6]=d,e[7]=f,e[8]=x,e[9]=R,e[10]=y):y=e[10];let C;e[11]===Symbol.for("react.memo_cache_sentinel")?(C=(0,o.jsx)(gr,{placeholder:"Model",triggerClassName:"h-6 text-xs shadow-none! ring-0! bg-muted hover:bg-muted/30 rounded-sm",iconSize:"small",showAddCustomModelDocs:!0,forRole:"chat"}),e[11]=C):C=e[11];let _;e[12]===y?_=e[13]:(_=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[y,C]}),e[12]=y,e[13]=_);let P;e[14]===Symbol.for("react.memo_cache_sentinel")?(P=(0,o.jsx)(sr,{className:"h-3.5 w-3.5"}),e[14]=P):P=e[14];let L;e[15]===c?L=e[16]:(L=(0,o.jsx)(ce,{content:"Add context",children:(0,o.jsx)(Y,{variant:"text",size:"icon",onClick:c,children:P})}),e[15]=c,e[16]=L);let w;e[17]!==n||e[18]!==b||e[19]!==i?(w=b&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ce,{content:"Attach a file",children:(0,o.jsx)(Y,{variant:"text",size:"icon",className:"cursor-pointer",onClick:()=>{var X;return(X=n.current)==null?void 0:X.click()},title:"Attach a file",children:(0,o.jsx)(Tr,{className:"h-3.5 w-3.5"})})}),(0,o.jsx)(pt,{ref:n,type:"file",multiple:!0,hidden:!0,onChange:X=>{X.target.files&&i([...X.target.files])},accept:yo.join(",")})]}),e[17]=n,e[18]=b,e[19]=i,e[20]=w):w=e[20];let T=l?"Stop":"Submit",k=l?s:a,A=l?!1:r,E;e[21]===l?E=e[22]:(E=l?(0,o.jsx)(fr,{className:"h-3 w-3 fill-current"}):(0,o.jsx)(Er,{className:"h-3 w-3"}),e[21]=l,e[22]=E);let I;e[23]!==k||e[24]!==A||e[25]!==E?(I=(0,o.jsx)(Y,{variant:"text",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted/30 cursor-pointer",onClick:k,disabled:A,children:E}),e[23]=k,e[24]=A,e[25]=E,e[26]=I):I=e[26];let U;e[27]!==T||e[28]!==I?(U=(0,o.jsx)(ce,{content:T,children:I}),e[27]=T,e[28]=I,e[29]=U):U=e[29];let W;e[30]!==w||e[31]!==U||e[32]!==L?(W=(0,o.jsxs)("div",{className:"flex flex-row",children:[L,w,U]}),e[30]=w,e[31]=U,e[32]=L,e[33]=W):W=e[33];let M;return e[34]!==W||e[35]!==_?(M=(0,o.jsx)(ht,{children:(0,o.jsxs)("div",{className:"px-3 py-2 border-t border-border/20 flex flex-row items-center justify-between",children:[_,W]})}),e[34]=W,e[35]=_,e[36]=M):M=e[36],M});Ot.displayName="ChatInputFooter";var lt=(0,h.memo)(t=>{let e=(0,me.c)(29),{placeholder:r,input:a,inputClassName:l,setInput:s,onSubmit:n,inputRef:i,isLoading:c,onStop:m,fileInputRef:d,onAddFiles:u,onClose:p}=t,f;e[0]!==a||e[1]!==n?(f=()=>{a.trim()&&n(void 0,a)},e[0]=a,e[1]=n,e[2]=f):f=e[2];let v=K(f),j;e[3]===l?j=e[4]:(j=V("px-2 py-3 flex-1",l),e[3]=l,e[4]=j);let b=r||"Type your message...",x;e[5]!==a||e[6]!==i||e[7]!==u||e[8]!==p||e[9]!==n||e[10]!==s||e[11]!==b?(x=(0,o.jsx)(ct,{inputRef:i,value:a,onChange:s,onSubmit:n,onClose:p,onAddFiles:u,placeholder:b}),e[5]=a,e[6]=i,e[7]=u,e[8]=p,e[9]=n,e[10]=s,e[11]=b,e[12]=x):x=e[12];let S;e[13]!==j||e[14]!==x?(S=(0,o.jsx)("div",{className:j,children:x}),e[13]=j,e[14]=x,e[15]=S):S=e[15];let R=!a.trim(),y;e[16]===i?y=e[17]:(y=()=>ar(i),e[16]=i,e[17]=y);let C;e[18]!==d||e[19]!==v||e[20]!==c||e[21]!==u||e[22]!==m||e[23]!==R||e[24]!==y?(C=(0,o.jsx)(Ot,{isEmpty:R,onAddContext:y,onSendClick:v,isLoading:c,onStop:m,fileInputRef:d,onAddFiles:u}),e[18]=d,e[19]=v,e[20]=c,e[21]=u,e[22]=m,e[23]=R,e[24]=y,e[25]=C):C=e[25];let _;return e[26]!==S||e[27]!==C?(_=(0,o.jsxs)("div",{className:"relative shrink-0 min-h-[80px] flex flex-col border-t",children:[S,C]}),e[26]=S,e[27]=C,e[28]=_):_=e[28],_});lt.displayName="ChatInput";var _o=()=>{let t=(0,me.c)(6),e=$e(er),{handleClick:r}=mt();if(!e){let l;t[0]===r?l=t[1]:(l=(0,o.jsx)(Y,{variant:"outline",size:"sm",onClick:()=>r("ai"),children:"Edit AI settings"}),t[0]=r,t[1]=l);let s;t[2]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsx)(Qe,{}),t[2]=s):s=t[2];let n;return t[3]===l?n=t[4]:(n=(0,o.jsx)(Ge,{title:"Chat with AI",description:"AI is currently disabled. Add your API key to enable.",action:l,icon:s}),t[3]=l,t[4]=n),n}let a;return t[5]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(Ro,{}),t[5]=a):a=t[5],a},Ro=()=>{let t=(0,me.c)(92),e=Ut(bt),[r,a]=Xt(qr),[l,s]=(0,h.useState)(""),[n,i]=(0,h.useState)(""),[c,m]=(0,h.useState)(),d=(0,h.useRef)(null),u=(0,h.useRef)(null),p=(0,h.useRef)(null),f=(0,h.useRef)(null),v=(0,h.useRef)(null),j=tr(),{invokeAiTool:b,sendRun:x}=rr(),S=r==null?void 0:r.id,R=Yt(),{addStagedCell:y}=hr(),{createNewCell:C,prepareForRun:_}=Bt(),P;t[0]!==y||t[1]!==C||t[2]!==_||t[3]!==x||t[4]!==R?(P={addStagedCell:y,createNewCell:C,prepareForRun:_,sendRun:x,store:R},t[0]=y,t[1]=C,t[2]=_,t[3]=x,t[4]=R,t[5]=P):P=t[5];let L=P,w;t[6]===(r==null?void 0:r.messages)?w=t[7]:(w=(r==null?void 0:r.messages)||[],t[6]=r==null?void 0:r.messages,t[7]=w);let T;t[8]===j?T=t[9]:(T=new lr({api:j.getAiURL("chat").toString(),headers:j.headers(),prepareSendMessagesRequest:Oo}),t[8]=j,t[9]=T);let k;t[10]===e?k=t[11]:(k=g=>{let{messages:N}=g;e(z=>Jr({chatState:z,chatId:z.activeChatId,messages:N}))},t[10]=e,t[11]=k);let{messages:A,sendMessage:E,error:I,status:U,regenerate:W,stop:M,addToolResult:xe,id:X}=nr({id:S,sendAutomaticallyWhen:Fo,messages:w,transport:T,onFinish:k,onToolCall:async g=>{let{toolCall:N}=g;if(N.dynamic){B.debug("Skipping dynamic tool call",N);return}await dr({invokeAiTool:b,addToolResult:Wt,toolCall:{toolName:N.toolName,toolCallId:N.toolCallId,input:N.input},toolContext:L})},onError:Wo}),Wt=xe,ve;t[12]===Symbol.for("react.memo_cache_sentinel")?(ve=g=>{if(g.length===0)return;let N=0;for(let z of g)N+=z.size;if(N>So){or({title:"File size exceeds 50MB limit",description:"Please remove some files and try again."});return}m(z=>[...z??[],...g])},t[12]=ve):ve=t[12];let ge=K(ve),be;t[13]===c?be=t[14]:(be=g=>{c&&m(c.filter(N=>N!==g))},t[13]=c,t[14]=be);let He=K(be),D=U==="submitted"||U==="streaming",we;t[15]!==D||t[16]!==A?(we=D&&A.length>0&&ur(A),t[15]=D,t[16]=A,t[17]=we):we=t[17];let ue=we,je;t[18]===Symbol.for("react.memo_cache_sentinel")?(je=()=>{requestAnimationFrame(()=>{if(p.current){let g=p.current;g.scrollTop=g.scrollHeight}})},t[18]=je):je=t[18];let ye;t[19]===S?ye=t[20]:(ye=[S],t[19]=S,t[20]=ye),(0,h.useEffect)(je,ye);let Se;t[21]!==X||t[22]!==E||t[23]!==e?(Se=async(g,N)=>{let z=Date.now(),q={id:X,title:cr(g),messages:[],createdAt:z,updatedAt:z};e(he=>{let st=new Map(he.chats);return st.set(q.id,q),{...he,chats:st,activeChatId:q.id}});let Je=N&&N.length>0?await dt(N):void 0;E({role:"user",parts:[{type:"text",text:g},...Je??[]]}),m(void 0),s("")},t[21]=X,t[22]=E,t[23]=e,t[24]=Se):Se=t[24];let Ue=Se,Ne;t[25]===a?Ne=t[26]:(Ne=()=>{a(null),s(""),i(""),m(void 0)},t[25]=a,t[26]=Ne);let Xe=K(Ne),Ce;t[27]!==A||t[28]!==E?(Ce=(g,N)=>{var he;let z=A[g],q=(he=z.parts)==null?void 0:he.filter(Ho),Je=z.id;E({messageId:Je,role:"user",parts:[{type:"text",text:N},...q]})},t[27]=A,t[28]=E,t[29]=Ce):Ce=t[29];let pe=K(Ce),_e;t[30]!==c||t[31]!==E?(_e=async(g,N)=>{var q;if(!N.trim())return;(q=u.current)!=null&&q.view&&it(u.current.view);let z=c?await dt(c):void 0;g==null||g.preventDefault(),E({text:N,files:z}),s(""),m(void 0)},t[30]=c,t[31]=E,t[32]=_e):_e=t[32];let Ye=K(_e),Re;t[33]===W?Re=t[34]:(Re=()=>{W()},t[33]=W,t[34]=Re);let qe=Re,Ae;t[35]!==Ue||t[36]!==c||t[37]!==n?(Ae=()=>{var g;n.trim()&&((g=d.current)!=null&&g.view&&it(d.current.view),Ue(n.trim(),c))},t[35]=Ue,t[36]=c,t[37]=n,t[38]=Ae):Ae=t[38];let Ve=K(Ae),Te;t[39]===Symbol.for("react.memo_cache_sentinel")?(Te=()=>{var g,N;return(N=(g=d.current)==null?void 0:g.editor)==null?void 0:N.blur()},t[39]=Te):Te=t[39];let Ht=Te,F=A.length===0,Ee;t[40]!==Ye||t[41]!==Ve||t[42]!==l||t[43]!==D||t[44]!==F||t[45]!==n||t[46]!==ge||t[47]!==M?(Ee=F?(0,o.jsx)(lt,{placeholder:"Ask anything, @ to include context about tables or dataframes",input:n,inputRef:d,inputClassName:"px-1 py-0",setInput:i,onSubmit:Ve,isLoading:D,onStop:M,fileInputRef:f,onAddFiles:ge,onClose:Ht},"new-thread-input"):(0,o.jsx)(lt,{input:l,setInput:s,onSubmit:Ye,inputRef:u,isLoading:D,onStop:M,onClose:()=>{var g,N;return(N=(g=u.current)==null?void 0:g.editor)==null?void 0:N.blur()},fileInputRef:f,onAddFiles:ge}),t[40]=Ye,t[41]=Ve,t[42]=l,t[43]=D,t[44]=F,t[45]=n,t[46]=ge,t[47]=M,t[48]=Ee):Ee=t[48];let Q=Ee,Pe;t[49]!==c||t[50]!==F||t[51]!==He?(Pe=c&&c.length>0&&(0,o.jsx)("div",{className:V("flex flex-row gap-1 flex-wrap p-1",F&&"py-2 px-1"),children:c==null?void 0:c.map(g=>(0,o.jsx)(Vr,{file:g,onRemove:()=>He(g)},g.name))}),t[49]=c,t[50]=F,t[51]=He,t[52]=Pe):Pe=t[52];let Z=Pe,Be=r==null?void 0:r.id,G;t[53]!==Xe||t[54]!==a||t[55]!==Be?(G=(0,o.jsx)(ht,{children:(0,o.jsx)(No,{onNewChat:Xe,activeChatId:Be,setActiveChat:a})}),t[53]=Xe,t[54]=a,t[55]=Be,t[56]=G):G=t[56];let ee;t[57]!==Q||t[58]!==Z||t[59]!==F?(ee=F&&(0,o.jsxs)("div",{className:"rounded-md border bg-background",children:[Z,Q]}),t[57]=Q,t[58]=Z,t[59]=F,t[60]=ee):ee=t[60];let te;if(t[61]!==pe||t[62]!==ue||t[63]!==A){let g;t[65]!==pe||t[66]!==ue||t[67]!==A.length?(g=(N,z)=>(0,o.jsx)(Ft,{message:N,index:z,onEdit:pe,isStreamingReasoning:ue,isLast:z===A.length-1},N.id),t[65]=pe,t[66]=ue,t[67]=A.length,t[68]=g):g=t[68],te=A.map(g),t[61]=pe,t[62]=ue,t[63]=A,t[64]=te}else te=t[64];let re;t[69]===D?re=t[70]:(re=D&&(0,o.jsx)("div",{className:"flex justify-center py-4",children:(0,o.jsx)(ut,{className:"h-4 w-4 animate-spin"})}),t[69]=D,t[70]=re);let oe;t[71]!==I||t[72]!==qe?(oe=I&&(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[(0,o.jsx)(Hr,{error:I}),(0,o.jsx)(Y,{variant:"outline",size:"sm",onClick:qe,children:"Retry"})]}),t[71]=I,t[72]=qe,t[73]=oe):oe=t[73];let Le;t[74]===Symbol.for("react.memo_cache_sentinel")?(Le=(0,o.jsx)("div",{ref:v}),t[74]=Le):Le=t[74];let le;t[75]!==ee||t[76]!==te||t[77]!==re||t[78]!==oe?(le=(0,o.jsxs)("div",{className:"flex-1 px-3 bg-(--slate-1) gap-4 py-3 flex flex-col overflow-y-auto",ref:p,children:[ee,te,re,oe,Le]}),t[75]=ee,t[76]=te,t[77]=re,t[78]=oe,t[79]=le):le=t[79];let se;t[80]!==D||t[81]!==M?(se=D&&(0,o.jsx)("div",{className:"w-full flex justify-center items-center z-20 border-t",children:(0,o.jsx)(Y,{variant:"linkDestructive",size:"sm",onClick:M,children:"Stop"})}),t[80]=D,t[81]=M,t[82]=se):se=t[82];let ae;t[83]!==Q||t[84]!==Z||t[85]!==F?(ae=!F&&(0,o.jsxs)(o.Fragment,{children:[Z,Q]}),t[83]=Q,t[84]=Z,t[85]=F,t[86]=ae):ae=t[86];let ke;return t[87]!==G||t[88]!==le||t[89]!==se||t[90]!==ae?(ke=(0,o.jsxs)("div",{className:"flex flex-col h-[calc(100%-53px)]",children:[G,le,se,ae]}),t[87]=G,t[88]=le,t[89]=se,t[90]=ae,t[91]=ke):ke=t[91],ke},Ao=_o;function To(t){return t.type==="text"}function Eo(t){return t.text}function Po(t){return t.type==="file"}function Lo(t,e){return(0,o.jsx)(Br,{attachment:t},e)}function ko(){}function zo(){}function Io(t){return t.type==="text"}function Do(t){return t.text}function Mo(t){return(0,o.jsx)(jr,{value:t.value,className:"text-xs",children:(0,o.jsxs)("div",{className:"flex flex-col",children:[t.label,(0,o.jsx)("div",{className:"text-muted-foreground text-xs pt-1 block",children:t.subtitle})]})},t.value)}function Fo(t){let{messages:e}=t;return pr(e)}async function Oo(t){let e=await mr(t.messages);return{body:{tools:ir.getToolSchemas(),...t,...e}}}function Wo(t){B.error("An error occurred:",t)}function Ho(t){return t.type==="file"}export{Ao as default};
