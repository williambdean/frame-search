import{s as me,t as he}from"./chunk-DZLz74EQ.js";const D=e=>e.flatMap(ue),ue=e=>G(ye(e)).map(Oe);var Oe=e=>e.replace(/ +/g," ").trim(),ye=e=>({type:"mandatory_block",items:V(e,0)[0]}),V=(e,s,t)=>{let E=[];for(;e[s];){let[l,I]=Le(e,s);if(E.push(l),s=I,e[s]==="|")s++;else if(e[s]==="}"||e[s]==="]"){if(t!==e[s])throw Error(`Unbalanced parenthesis in: ${e}`);return s++,[E,s]}else if(s===e.length){if(t)throw Error(`Unbalanced parenthesis in: ${e}`);return[E,s]}else throw Error(`Unexpected "${e[s]}"`)}return[E,s]},Le=(e,s)=>{let t=[];for(;;){let[E,l]=Ce(e,s);if(E)t.push(E),s=l;else break}return t.length===1?[t[0],s]:[{type:"concatenation",items:t},s]},Ce=(e,s)=>{if(e[s]==="{")return de(e,s+1);if(e[s]==="[")return fe(e,s+1);{let t="";for(;e[s]&&/[A-Za-z0-9_ ]/.test(e[s]);)t+=e[s],s++;return[t,s]}},de=(e,s)=>{let[t,E]=V(e,s,"}");return[{type:"mandatory_block",items:t},E]},fe=(e,s)=>{let[t,E]=V(e,s,"]");return[{type:"optional_block",items:t},E]},G=e=>{if(typeof e=="string")return[e];if(e.type==="concatenation")return e.items.map(G).reduce(De,[""]);if(e.type==="mandatory_block")return e.items.flatMap(G);if(e.type==="optional_block")return["",...e.items.flatMap(G)];throw Error(`Unknown node type: ${e}`)},De=(e,s)=>{let t=[];for(let E of e)for(let l of s)t.push(E+l);return t},i;(function(e){e.QUOTED_IDENTIFIER="QUOTED_IDENTIFIER",e.IDENTIFIER="IDENTIFIER",e.STRING="STRING",e.VARIABLE="VARIABLE",e.RESERVED_DATA_TYPE="RESERVED_DATA_TYPE",e.RESERVED_PARAMETERIZED_DATA_TYPE="RESERVED_PARAMETERIZED_DATA_TYPE",e.RESERVED_KEYWORD="RESERVED_KEYWORD",e.RESERVED_FUNCTION_NAME="RESERVED_FUNCTION_NAME",e.RESERVED_PHRASE="RESERVED_PHRASE",e.RESERVED_SET_OPERATION="RESERVED_SET_OPERATION",e.RESERVED_CLAUSE="RESERVED_CLAUSE",e.RESERVED_SELECT="RESERVED_SELECT",e.RESERVED_JOIN="RESERVED_JOIN",e.ARRAY_IDENTIFIER="ARRAY_IDENTIFIER",e.ARRAY_KEYWORD="ARRAY_KEYWORD",e.CASE="CASE",e.END="END",e.WHEN="WHEN",e.ELSE="ELSE",e.THEN="THEN",e.LIMIT="LIMIT",e.BETWEEN="BETWEEN",e.AND="AND",e.OR="OR",e.XOR="XOR",e.OPERATOR="OPERATOR",e.COMMA="COMMA",e.ASTERISK="ASTERISK",e.PROPERTY_ACCESS_OPERATOR="PROPERTY_ACCESS_OPERATOR",e.OPEN_PAREN="OPEN_PAREN",e.CLOSE_PAREN="CLOSE_PAREN",e.LINE_COMMENT="LINE_COMMENT",e.BLOCK_COMMENT="BLOCK_COMMENT",e.DISABLE_COMMENT="DISABLE_COMMENT",e.NUMBER="NUMBER",e.NAMED_PARAMETER="NAMED_PARAMETER",e.QUOTED_PARAMETER="QUOTED_PARAMETER",e.NUMBERED_PARAMETER="NUMBERED_PARAMETER",e.POSITIONAL_PARAMETER="POSITIONAL_PARAMETER",e.CUSTOM_PARAMETER="CUSTOM_PARAMETER",e.DELIMITER="DELIMITER",e.EOF="EOF"})(i=i||(i={}));const j=e=>({type:i.EOF,raw:"\xABEOF\xBB",text:"\xABEOF\xBB",start:e});j(1/0),i.RESERVED_DATA_TYPE,i.RESERVED_KEYWORD,i.RESERVED_CLAUSE,i.RESERVED_DATA_TYPE,i.RESERVED_CLAUSE,i.RESERVED_CLAUSE;const Pe=e=>e===i.RESERVED_DATA_TYPE||e===i.RESERVED_KEYWORD||e===i.RESERVED_FUNCTION_NAME||e===i.RESERVED_PHRASE||e===i.RESERVED_CLAUSE||e===i.RESERVED_SELECT||e===i.RESERVED_SET_OPERATION||e===i.RESERVED_JOIN||e===i.ARRAY_KEYWORD||e===i.CASE||e===i.END||e===i.WHEN||e===i.ELSE||e===i.THEN||e===i.LIMIT||e===i.BETWEEN||e===i.AND||e===i.OR||e===i.XOR,be=e=>e===i.AND||e===i.OR||e===i.XOR,xe="ABS.ACOS.ADD.ADD_PARQUET_KEY.AGE.AGGREGATE.ALIAS.ALL_PROFILING_OUTPUT.ANY_VALUE.APPLY.APPROX_COUNT_DISTINCT.APPROX_QUANTILE.ARBITRARY.ARGMAX.ARGMIN.ARG_MAX.ARG_MAX_NULL.ARG_MIN.ARG_MIN_NULL.ARRAY_AGG.ARRAY_AGGR.ARRAY_AGGREGATE.ARRAY_APPEND.ARRAY_APPLY.ARRAY_CAT.ARRAY_CONCAT.ARRAY_CONTAINS.ARRAY_COSINE_SIMILARITY.ARRAY_CROSS_PRODUCT.ARRAY_DISTANCE.ARRAY_DISTINCT.ARRAY_DOT_PRODUCT.ARRAY_EXTRACT.ARRAY_FILTER.ARRAY_GRADE_UP.ARRAY_HAS.ARRAY_HAS_ALL.ARRAY_HAS_ANY.ARRAY_INDEXOF.ARRAY_INNER_PRODUCT.ARRAY_INTERSECT.ARRAY_LENGTH.ARRAY_POP_BACK.ARRAY_POP_FRONT.ARRAY_POSITION.ARRAY_PREPEND.ARRAY_PUSH_BACK.ARRAY_PUSH_FRONT.ARRAY_REDUCE.ARRAY_RESIZE.ARRAY_REVERSE.ARRAY_REVERSE_SORT.ARRAY_SELECT.ARRAY_SLICE.ARRAY_SORT.ARRAY_TO_JSON.ARRAY_TO_STRING.ARRAY_TRANSFORM.ARRAY_UNIQUE.ARRAY_VALUE.ARRAY_WHERE.ARRAY_ZIP.ARROW_SCAN.ARROW_SCAN_DUMB.ASCII.ASIN.ATAN.ATAN2.AVG.BASE64.BIN.BITSTRING.BITSTRING_AGG.BIT_AND.BIT_COUNT.BIT_LENGTH.BIT_OR.BIT_POSITION.BIT_XOR.BOOL_AND.BOOL_OR.CARDINALITY.CBRT.CEIL.CEILING.CENTURY.CHECKPOINT.CHR.COLLATIONS.COL_DESCRIPTION.COMBINE.CONCAT.CONCAT_WS.CONSTANT_OR_NULL.CONTAINS.COPY_DATABASE.CORR.COS.COT.COUNT.COUNT_IF.COUNT_STAR.COVAR_POP.COVAR_SAMP.CREATE_SORT_KEY.CURRENT_CATALOG.CURRENT_DATABASE.CURRENT_DATE.CURRENT_LOCALTIME.CURRENT_LOCALTIMESTAMP.CURRENT_QUERY.CURRENT_ROLE.CURRENT_SCHEMA.CURRENT_SCHEMAS.CURRENT_SETTING.CURRENT_USER.CURRVAL.DAMERAU_LEVENSHTEIN.DATABASE_LIST.DATABASE_SIZE.DATEDIFF.DATEPART.DATESUB.DATETRUNC.DATE_ADD.DATE_DIFF.DATE_PART.DATE_SUB.DATE_TRUNC.DAY.DAYNAME.DAYOFMONTH.DAYOFWEEK.DAYOFYEAR.DECADE.DECODE.DEGREES.DISABLE_CHECKPOINT_ON_SHUTDOWN.DISABLE_OBJECT_CACHE.DISABLE_OPTIMIZER.DISABLE_PRINT_PROGRESS_BAR.DISABLE_PROFILE.DISABLE_PROFILING.DISABLE_PROGRESS_BAR.DISABLE_VERIFICATION.DISABLE_VERIFY_EXTERNAL.DISABLE_VERIFY_FETCH_ROW.DISABLE_VERIFY_PARALLELISM.DISABLE_VERIFY_SERIALIZER.DIVIDE.DUCKDB_COLUMNS.DUCKDB_CONSTRAINTS.DUCKDB_DATABASES.DUCKDB_DEPENDENCIES.DUCKDB_EXTENSIONS.DUCKDB_FUNCTIONS.DUCKDB_INDEXES.DUCKDB_KEYWORDS.DUCKDB_MEMORY.DUCKDB_OPTIMIZERS.DUCKDB_SCHEMAS.DUCKDB_SECRETS.DUCKDB_SEQUENCES.DUCKDB_SETTINGS.DUCKDB_TABLES.DUCKDB_TEMPORARY_FILES.DUCKDB_TYPES.DUCKDB_VIEWS.EDIT.EDITDIST3.ELEMENT_AT.ENABLE_CHECKPOINT_ON_SHUTDOWN.ENABLE_OBJECT_CACHE.ENABLE_OPTIMIZER.ENABLE_PRINT_PROGRESS_BAR.ENABLE_PROFILE.ENABLE_PROFILING.ENABLE_PROGRESS_BAR.ENABLE_VERIFICATION.ENCODE.ENDS_WITH.ENTROPY.ENUM_CODE.ENUM_FIRST.ENUM_LAST.ENUM_RANGE.ENUM_RANGE_BOUNDARY.EPOCH.EPOCH_MS.EPOCH_NS.EPOCH_US.ERA.ERROR.EVEN.EXP.FACTORIAL.FAVG.FDIV.FILTER.FINALIZE.FIRST.FLATTEN.FLOOR.FMOD.FORCE_CHECKPOINT.FORMAT.FORMATREADABLEDECIMALSIZE.FORMATREADABLESIZE.FORMAT_BYTES.FORMAT_PG_TYPE.FORMAT_TYPE.FROM_BASE64.FROM_BINARY.FROM_HEX.FROM_JSON.FROM_JSON_STRICT.FSUM.FUNCTIONS.GAMMA.GCD.GENERATE_SERIES.GENERATE_SUBSCRIPTS.GEN_RANDOM_UUID.GEOMEAN.GEOMETRIC_MEAN.GETENV.GET_BIT.GET_BLOCK_SIZE.GET_CURRENT_TIME.GET_CURRENT_TIMESTAMP.GLOB.GRADE_UP.GREATEST.GREATEST_COMMON_DIVISOR.GROUP_CONCAT.HAMMING.HASH.HAS_ANY_COLUMN_PRIVILEGE.HAS_COLUMN_PRIVILEGE.HAS_DATABASE_PRIVILEGE.HAS_FOREIGN_DATA_WRAPPER_PRIVILEGE.HAS_FUNCTION_PRIVILEGE.HAS_LANGUAGE_PRIVILEGE.HAS_SCHEMA_PRIVILEGE.HAS_SEQUENCE_PRIVILEGE.HAS_SERVER_PRIVILEGE.HAS_TABLESPACE_PRIVILEGE.HAS_TABLE_PRIVILEGE.HEX.HISTOGRAM.HOUR.ICU_CALENDAR_NAMES.ICU_SORT_KEY.ILIKE_ESCAPE.IMPORT_DATABASE.INDEX_SCAN.INET_CLIENT_ADDR.INET_CLIENT_PORT.INET_SERVER_ADDR.INET_SERVER_PORT.INSTR.IN_SEARCH_PATH.ISFINITE.ISINF.ISNAN.ISODOW.ISOYEAR.JACCARD.JARO_SIMILARITY.JARO_WINKLER_SIMILARITY.JSON_ARRAY.JSON_ARRAY_LENGTH.JSON_CONTAINS.JSON_DESERIALIZE_SQL.JSON_EXECUTE_SERIALIZED_SQL.JSON_EXTRACT.JSON_EXTRACT_PATH.JSON_EXTRACT_PATH_TEXT.JSON_EXTRACT_STRING.JSON_GROUP_ARRAY.JSON_GROUP_OBJECT.JSON_GROUP_STRUCTURE.JSON_KEYS.JSON_MERGE_PATCH.JSON_OBJECT.JSON_QUOTE.JSON_SERIALIZE_PLAN.JSON_SERIALIZE_SQL.JSON_STRUCTURE.JSON_TRANSFORM.JSON_TRANSFORM_STRICT.JSON_TYPE.JSON_VALID.JULIAN.KAHAN_SUM.KURTOSIS.KURTOSIS_POP.LAST.LAST_DAY.LCASE.LCM.LEAST.LEAST_COMMON_MULTIPLE.LEFT.LEFT_GRAPHEME.LEN.LENGTH.LENGTH_GRAPHEME.LEVENSHTEIN.LGAMMA.LIKE_ESCAPE.LIST.LISTAGG.LIST_AGGR.LIST_AGGREGATE.LIST_ANY_VALUE.LIST_APPEND.LIST_APPLY.LIST_APPROX_COUNT_DISTINCT.LIST_AVG.LIST_BIT_AND.LIST_BIT_OR.LIST_BIT_XOR.LIST_BOOL_AND.LIST_BOOL_OR.LIST_CAT.LIST_CONCAT.LIST_CONTAINS.LIST_COSINE_SIMILARITY.LIST_COUNT.LIST_DISTANCE.LIST_DISTINCT.LIST_DOT_PRODUCT.LIST_ELEMENT.LIST_ENTROPY.LIST_EXTRACT.LIST_FILTER.LIST_FIRST.LIST_GRADE_UP.LIST_HAS.LIST_HAS_ALL.LIST_HAS_ANY.LIST_HISTOGRAM.LIST_INDEXOF.LIST_INNER_PRODUCT.LIST_INTERSECT.LIST_KURTOSIS.LIST_KURTOSIS_POP.LIST_LAST.LIST_MAD.LIST_MAX.LIST_MEDIAN.LIST_MIN.LIST_MODE.LIST_PACK.LIST_POSITION.LIST_PREPEND.LIST_PRODUCT.LIST_REDUCE.LIST_RESIZE.LIST_REVERSE.LIST_REVERSE_SORT.LIST_SELECT.LIST_SEM.LIST_SKEWNESS.LIST_SLICE.LIST_SORT.LIST_STDDEV_POP.LIST_STDDEV_SAMP.LIST_STRING_AGG.LIST_SUM.LIST_TRANSFORM.LIST_UNIQUE.LIST_VALUE.LIST_VAR_POP.LIST_VAR_SAMP.LIST_WHERE.LIST_ZIP.LN.LOG.LOG10.LOG2.LOWER.LPAD.LSMODE.LTRIM.MAD.MAKE_DATE.MAKE_TIME.MAKE_TIMESTAMP.MAKE_TIMESTAMPTZ.MAP.MAP_CONCAT.MAP_ENTRIES.MAP_EXTRACT.MAP_FROM_ENTRIES.MAP_KEYS.MAP_VALUES.MAX.MAX_BY.MD5.MD5_NUMBER.MD5_NUMBER_LOWER.MD5_NUMBER_UPPER.MEAN.MEDIAN.METADATA_INFO.MICROSECOND.MILLENNIUM.MILLISECOND.MIN.MINUTE.MIN_BY.MISMATCHES.MOD.MODE.MONTH.MONTHNAME.MULTIPLY.NEXTAFTER.NEXTVAL.NFC_NORMALIZE.NOT_ILIKE_ESCAPE.NOT_LIKE_ESCAPE.NOW.NULLIF.OBJ_DESCRIPTION.OCTET_LENGTH.ORD.PARQUET_FILE_METADATA.PARQUET_KV_METADATA.PARQUET_METADATA.PARQUET_SCAN.PARQUET_SCHEMA.PARSE_DIRNAME.PARSE_DIRPATH.PARSE_FILENAME.PARSE_PATH.PG_COLLATION_IS_VISIBLE.PG_CONF_LOAD_TIME.PG_CONVERSION_IS_VISIBLE.PG_FUNCTION_IS_VISIBLE.PG_GET_CONSTRAINTDEF.PG_GET_EXPR.PG_GET_VIEWDEF.PG_HAS_ROLE.PG_IS_OTHER_TEMP_SCHEMA.PG_MY_TEMP_SCHEMA.PG_OPCLASS_IS_VISIBLE.PG_OPERATOR_IS_VISIBLE.PG_OPFAMILY_IS_VISIBLE.PG_POSTMASTER_START_TIME.PG_SIZE_PRETTY.PG_TABLE_IS_VISIBLE.PG_TIMEZONE_NAMES.PG_TS_CONFIG_IS_VISIBLE.PG_TS_DICT_IS_VISIBLE.PG_TS_PARSER_IS_VISIBLE.PG_TS_TEMPLATE_IS_VISIBLE.PG_TYPEOF.PG_TYPE_IS_VISIBLE.PI.PLATFORM.POSITION.POW.POWER.PRAGMA_COLLATIONS.PRAGMA_DATABASE_SIZE.PRAGMA_METADATA_INFO.PRAGMA_PLATFORM.PRAGMA_SHOW.PRAGMA_STORAGE_INFO.PRAGMA_TABLE_INFO.PRAGMA_USER_AGENT.PRAGMA_VERSION.PREFIX.PRINTF.PRODUCT.QUANTILE.QUANTILE_CONT.QUANTILE_DISC.QUARTER.RADIANS.RANDOM.RANGE.READFILE.READ_BLOB.READ_CSV.READ_CSV_AUTO.READ_JSON.READ_JSON_AUTO.READ_JSON_OBJECTS.READ_JSON_OBJECTS_AUTO.READ_NDJSON.READ_NDJSON_AUTO.READ_NDJSON_OBJECTS.READ_PARQUET.READ_TEXT.REDUCE.REGEXP_ESCAPE.REGEXP_EXTRACT.REGEXP_EXTRACT_ALL.REGEXP_FULL_MATCH.REGEXP_MATCHES.REGEXP_REPLACE.REGEXP_SPLIT_TO_ARRAY.REGEXP_SPLIT_TO_TABLE.REGR_AVGX.REGR_AVGY.REGR_COUNT.REGR_INTERCEPT.REGR_R2.REGR_SLOPE.REGR_SXX.REGR_SXY.REGR_SYY.REPEAT.REPEAT_ROW.REPLACE.RESERVOIR_QUANTILE.REVERSE.RIGHT.RIGHT_GRAPHEME.ROUND.ROUNDBANKERS.ROUND_EVEN.ROW.ROW_TO_JSON.RPAD.RTRIM.SECOND.SEM.SEQ_SCAN.SESSION_USER.SETSEED.SET_BIT.SHA256.SHA3.SHELL_ADD_SCHEMA.SHELL_ESCAPE_CRNL.SHELL_IDQUOTE.SHELL_MODULE_SCHEMA.SHELL_PUTSNL.SHOBJ_DESCRIPTION.SHOW.SHOW_DATABASES.SHOW_TABLES.SHOW_TABLES_EXPANDED.SIGN.SIGNBIT.SIN.SKEWNESS.SNIFF_CSV.SPLIT.SPLIT_PART.SQL_AUTO_COMPLETE.SQRT.STARTS_WITH.STATS.STDDEV.STDDEV_POP.STDDEV_SAMP.STORAGE_INFO.STRFTIME.STRING_AGG.STRING_SPLIT.STRING_SPLIT_REGEX.STRING_TO_ARRAY.STRIP_ACCENTS.STRLEN.STRPOS.STRPTIME.STRUCT_EXTRACT.STRUCT_INSERT.STRUCT_PACK.STR_SPLIT.STR_SPLIT_REGEX.SUBSTR.SUBSTRING.SUBSTRING_GRAPHEME.SUBTRACT.SUFFIX.SUM.SUMKAHAN.SUMMARY.SUM_NO_OVERFLOW.TABLE_INFO.TAN.TEST_ALL_TYPES.TEST_VECTOR_TYPES.TIMEZONE.TIMEZONE_HOUR.TIMEZONE_MINUTE.TIME_BUCKET.TODAY.TO_BASE.TO_BASE64.TO_BINARY.TO_CENTURIES.TO_DAYS.TO_DECADES.TO_HEX.TO_HOURS.TO_JSON.TO_MICROSECONDS.TO_MILLENNIA.TO_MILLISECONDS.TO_MINUTES.TO_MONTHS.TO_SECONDS.TO_TIMESTAMP.TO_WEEKS.TO_YEARS.TRANSACTION_TIMESTAMP.TRANSLATE.TRIM.TRUNC.TRY_STRPTIME.TXID_CURRENT.TYPEOF.UCASE.UNBIN.UNHEX.UNICODE.UNION_EXTRACT.UNION_TAG.UNION_VALUE.UNNEST.UNPIVOT_LIST.UPPER.USER.USER_AGENT.UUID.VARIANCE.VAR_POP.VAR_SAMP.VECTOR_TYPE.VERIFY_EXTERNAL.VERIFY_FETCH_ROW.VERIFY_PARALLELISM.VERIFY_SERIALIZER.VERSION.WEEK.WEEKDAY.WEEKOFYEAR.WHICH_SECRET.WRITEFILE.XOR.YEAR.YEARWEEK.CAST.COALESCE.RANK.ROW_NUMBER".split("."),Me="ALL.ANALYSE.ANALYZE.AND.ANY.AS.ASC.ATTACH.ASYMMETRIC.BOTH.CASE.CAST.CHECK.COLLATE.COLUMN.CONSTRAINT.CREATE.DEFAULT.DEFERRABLE.DESC.DESCRIBE.DETACH.DISTINCT.DO.ELSE.END.EXCEPT.FALSE.FETCH.FOR.FOREIGN.FROM.GRANT.GROUP.HAVING.IN.INITIALLY.INTERSECT.INTO.IS.LATERAL.LEADING.LIMIT.NOT.NULL.OFFSET.ON.ONLY.OR.ORDER.PIVOT.PIVOT_LONGER.PIVOT_WIDER.PLACING.PRIMARY.REFERENCES.RETURNING.SELECT.SHOW.SOME.SUMMARIZE.SYMMETRIC.TABLE.THEN.TO.TRAILING.TRUE.UNION.UNIQUE.UNPIVOT.USING.VARIADIC.WHEN.WHERE.WINDOW.WITH".split("."),$e="ARRAY.BIGINT.BINARY.BIT.BITSTRING.BLOB.BOOL.BOOLEAN.BPCHAR.BYTEA.CHAR.DATE.DATETIME.DEC.DECIMAL.DOUBLE.ENUM.FLOAT.FLOAT4.FLOAT8.GUID.HUGEINT.INET.INT.INT1.INT128.INT16.INT2.INT32.INT4.INT64.INT8.INTEGER.INTEGRAL.INTERVAL.JSON.LIST.LOGICAL.LONG.MAP.NUMERIC.NVARCHAR.OID.REAL.ROW.SHORT.SIGNED.SMALLINT.STRING.STRUCT.TEXT.TIME.TIMESTAMP_MS.TIMESTAMP_NS.TIMESTAMP_S.TIMESTAMP_US.TIMESTAMP.TIMESTAMPTZ.TIMETZ.TINYINT.UBIGINT.UHUGEINT.UINT128.UINT16.UINT32.UINT64.UINT8.UINTEGER.UNION.USMALLINT.UTINYINT.UUID.VARBINARY.VARCHAR".split(".");var ge=D(["SELECT [ALL | DISTINCT]"]),Ue=D(["WITH [RECURSIVE]","FROM","WHERE","GROUP BY [ALL]","HAVING","WINDOW","PARTITION BY","ORDER BY [ALL]","LIMIT","OFFSET","USING SAMPLE","QUALIFY","INSERT [OR REPLACE] INTO","VALUES","DEFAULT VALUES","SET","RETURNING"]),Q=D(["CREATE [OR REPLACE] [TEMPORARY | TEMP] TABLE [IF NOT EXISTS]"]),H=D("UPDATE.ON CONFLICT.DELETE FROM.DROP TABLE [IF EXISTS].TRUNCATE.ALTER TABLE.ADD [COLUMN] [IF NOT EXISTS].ADD PRIMARY KEY.DROP [COLUMN] [IF EXISTS].ALTER [COLUMN].RENAME [COLUMN].RENAME TO.SET [DATA] TYPE.{SET | DROP} DEFAULT.{SET | DROP} NOT NULL.CREATE [OR REPLACE] [TEMPORARY | TEMP] {MACRO | FUNCTION}.DROP MACRO [TABLE] [IF EXISTS].DROP FUNCTION [IF EXISTS].CREATE [UNIQUE] INDEX [IF NOT EXISTS].DROP INDEX [IF EXISTS].CREATE [OR REPLACE] SCHEMA [IF NOT EXISTS].DROP SCHEMA [IF EXISTS].CREATE [OR REPLACE] [PERSISTENT | TEMPORARY] SECRET [IF NOT EXISTS].DROP [PERSISTENT | TEMPORARY] SECRET [IF EXISTS].CREATE [OR REPLACE] [TEMPORARY | TEMP] SEQUENCE.DROP SEQUENCE [IF EXISTS].CREATE [OR REPLACE] [TEMPORARY | TEMP] VIEW [IF NOT EXISTS].DROP VIEW [IF EXISTS].ALTER VIEW.CREATE TYPE.DROP TYPE [IF EXISTS].ANALYZE.ATTACH [DATABASE] [IF NOT EXISTS].DETACH [DATABASE] [IF EXISTS].CALL.[FORCE] CHECKPOINT.COMMENT ON [TABLE | COLUMN | VIEW | INDEX | SEQUENCE | TYPE | MACRO | MACRO TABLE].COPY [FROM DATABASE].DESCRIBE.EXPORT DATABASE.IMPORT DATABASE.INSTALL.LOAD.PIVOT.PIVOT_WIDER.UNPIVOT.EXPLAIN [ANALYZE].SET {LOCAL | SESSION | GLOBAL}.RESET [LOCAL | SESSION | GLOBAL].{SET | RESET} VARIABLE.SUMMARIZE.BEGIN TRANSACTION.ROLLBACK.COMMIT.ABORT.USE.VACUUM [ANALYZE].PREPARE.EXECUTE.DEALLOCATE [PREPARE]".split(".")),we=D(["UNION [ALL | BY NAME]","EXCEPT [ALL]","INTERSECT [ALL]"]),Be=D(["JOIN","{LEFT | RIGHT | FULL} [OUTER] JOIN","{INNER | CROSS} JOIN","{NATURAL | ASOF} [INNER] JOIN","{NATURAL | ASOF} {LEFT | RIGHT | FULL} [OUTER] JOIN","POSITIONAL JOIN","ANTI JOIN","SEMI JOIN"]),Ge=D(["{ROWS | RANGE | GROUPS} BETWEEN","SIMILAR TO","IS [NOT] DISTINCT FROM","TIMESTAMP WITH TIME ZONE"]);const Ye={name:"duckdb",tokenizerOptions:{reservedSelect:ge,reservedClauses:[...Ue,...Q,...H],reservedSetOperations:we,reservedJoins:Be,reservedPhrases:Ge,supportsXor:!0,reservedKeywords:Me,reservedDataTypes:$e,reservedFunctionNames:xe,nestedBlockComments:!0,extraParens:["[]","{}"],stringTypes:["$$","''-qq",{quote:"''-qq-bs",prefixes:["E"],requirePrefix:!0},{quote:"''-raw",prefixes:["B","X"],requirePrefix:!0}],identTypes:['""-qq'],identChars:{rest:"$"},paramTypes:{positional:!0,numbered:["$"],quoted:["$"]},operators:"//.%.**.^.!.&.|.~.<<.>>.::.==.->.->>.:.:=.=>.~~.!~~.~~*.!~~*.~~~.~.!~.~*.!~*.^@.||.>>=.<<=".split(".")},formatOptions:{alwaysDenseOperators:["::"],onelineClauses:[...Q,...H],tabularOnelineClauses:H}},B=e=>e[e.length-1],Z=e=>e.sort((s,t)=>t.length-s.length||s.localeCompare(t)),Y=e=>e.replace(/\s+/gu," "),W=e=>/\n/.test(e),C=e=>e.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&"),z=/\s+/uy,x=e=>RegExp(`(?:${e})`,"uy"),Fe=e=>e.split("").map(s=>/ /gu.test(s)?"\\s+":`[${s.toUpperCase()}${s.toLowerCase()}]`).join(""),Ve=e=>e+"(?:-"+e+")*",He=({prefixes:e,requirePrefix:s})=>`(?:${e.map(Fe).join("|")}${s?"":"|"})`,We=e=>RegExp(`(?:${e.map(C).join("|")}).*?(?=\r
|\r|
|$)`,"uy"),ee=(e,s=[])=>{let t=e==="open"?0:1;return x(["()",...s].map(E=>E[t]).map(C).join("|"))},se=e=>x(`${Z(e).map(C).join("|")}`);var ke=({rest:e,dashes:s})=>e||s?`(?![${e||""}${s?"-":""}])`:"";const P=(e,s={})=>{if(e.length===0)return/^\b$/u;let t=ke(s),E=Z(e).map(C).join("|").replace(/ /gu,"\\s+");return RegExp(`(?:${E})${t}\\b`,"iuy")},k=(e,s)=>{if(e.length)return x(`(?:${e.map(C).join("|")})(?:${s})`)};var Ke=()=>{let e={"<":">","[":"]","(":")","{":"}"},s=Object.entries(e).map(([E,l])=>"{left}(?:(?!{right}').)*?{right}".replace(/{left}/g,C(E)).replace(/{right}/g,C(l))),t=C(Object.keys(e).join(""));return`[Qq]'(?:${String.raw`(?<tag>[^\s${t}])(?:(?!\k<tag>').)*?\k<tag>`}|${s.join("|")})'`};const te={"``":"(?:`[^`]*`)+","[]":String.raw`(?:\[[^\]]*\])(?:\][^\]]*\])*`,'""-qq':String.raw`(?:"[^"]*")+`,'""-bs':String.raw`(?:"[^"\\]*(?:\\.[^"\\]*)*")`,'""-qq-bs':String.raw`(?:"[^"\\]*(?:\\.[^"\\]*)*")+`,'""-raw':String.raw`(?:"[^"]*")`,"''-qq":String.raw`(?:'[^']*')+`,"''-bs":String.raw`(?:'[^'\\]*(?:\\.[^'\\]*)*')`,"''-qq-bs":String.raw`(?:'[^'\\]*(?:\\.[^'\\]*)*')+`,"''-raw":String.raw`(?:'[^']*')`,$$:String.raw`(?<tag>\$\w*\$)[\s\S]*?\k<tag>`,"'''..'''":String.raw`'''[^\\]*?(?:\\.[^\\]*?)*?'''`,'""".."""':String.raw`"""[^\\]*?(?:\\.[^\\]*?)*?"""`,"{}":String.raw`(?:\{[^\}]*\})`,"q''":Ke()};var re=e=>typeof e=="string"?te[e]:"regex"in e?e.regex:He(e)+te[e.quote];const ve=e=>x(e.map(s=>"regex"in s?s.regex:re(s)).join("|")),Ee=e=>e.map(re).join("|"),ae=e=>x(Ee(e)),Xe=(e={})=>x(ie(e)),ie=({first:e,rest:s,dashes:t,allowFirstCharNumber:E}={})=>{let l="\\p{Alphabetic}\\p{Mark}_",I="\\p{Decimal_Number}",c=C(e??""),N=C(s??""),L=E?`[${l}${I}${c}][${l}${I}${N}]*`:`[${l}${c}][${l}${I}${N}]*`;return t?Ve(L):L};function ne(e,s){let t=e.slice(0,s).split(/\n/);return{line:t.length,col:t[t.length-1].length+1}}var Je=class{constructor(e,s){this.rules=e,this.dialectName=s,this.input="",this.index=0}tokenize(e){this.input=e,this.index=0;let s=[],t;for(;this.index<this.input.length;){let E=this.getWhitespace();if(this.index<this.input.length){if(t=this.getNextToken(),!t)throw this.createParseError();s.push(Object.assign(Object.assign({},t),{precedingWhitespace:E}))}}return s}createParseError(){let e=this.input.slice(this.index,this.index+10),{line:s,col:t}=ne(this.input,this.index);return Error(`Parse error: Unexpected "${e}" at line ${s} column ${t}.
${this.dialectInfo()}`)}dialectInfo(){return this.dialectName==="sql"?`This likely happens because you're using the default "sql" dialect.
If possible, please select a more specific dialect (like sqlite, postgresql, etc).`:`SQL dialect used: "${this.dialectName}".`}getWhitespace(){z.lastIndex=this.index;let e=z.exec(this.input);if(e)return this.index+=e[0].length,e[0]}getNextToken(){for(let e of this.rules){let s=this.match(e);if(s)return s}}match(e){e.regex.lastIndex=this.index;let s=e.regex.exec(this.input);if(s){let t=s[0],E={type:e.type,raw:t,text:e.text?e.text(t):t,start:this.index};return e.key&&(E.key=e.key(t)),this.index+=t.length,E}}},oe=/\/\*/uy,qe=/[\s\S]/uy,je=/\*\//uy,Qe=class{constructor(){this.lastIndex=0}exec(e){let s="",t,E=0;if(t=this.matchSection(oe,e))s+=t,E++;else return null;for(;E>0;)if(t=this.matchSection(oe,e))s+=t,E++;else if(t=this.matchSection(je,e))s+=t,E--;else if(t=this.matchSection(qe,e))s+=t;else return null;return[s]}matchSection(e,s){e.lastIndex=this.lastIndex;let t=e.exec(s);return t&&(this.lastIndex+=t[0].length),t?t[0]:null}},Ze=class{constructor(e,s){this.cfg=e,this.dialectName=s,this.rulesBeforeParams=this.buildRulesBeforeParams(e),this.rulesAfterParams=this.buildRulesAfterParams(e)}tokenize(e,s){let t=new Je([...this.rulesBeforeParams,...this.buildParamRules(this.cfg,s),...this.rulesAfterParams],this.dialectName).tokenize(e);return this.cfg.postProcess?this.cfg.postProcess(t):t}buildRulesBeforeParams(e){return this.validRules([{type:i.BLOCK_COMMENT,regex:/(\/\* *sql-formatter-disable *\*\/[\s\S]*?(?:\/\* *sql-formatter-enable *\*\/|$))/uy},{type:i.BLOCK_COMMENT,regex:e.nestedBlockComments?new Qe:/(\/\*[^]*?\*\/)/uy},{type:i.LINE_COMMENT,regex:We(e.lineCommentTypes??["--"])},{type:i.QUOTED_IDENTIFIER,regex:ae(e.identTypes)},{type:i.NUMBER,regex:/(?:0x[0-9a-fA-F]+|0b[01]+|(?:-\s*)?(?:[0-9]*\.[0-9]+|[0-9]+(?:\.[0-9]*)?)(?:[eE][-+]?[0-9]+(?:\.[0-9]+)?)?)(?![\w\p{Alphabetic}])/uy},{type:i.RESERVED_PHRASE,regex:P(e.reservedPhrases??[],e.identChars),text:h},{type:i.CASE,regex:/CASE\b/iuy,text:h},{type:i.END,regex:/END\b/iuy,text:h},{type:i.BETWEEN,regex:/BETWEEN\b/iuy,text:h},{type:i.LIMIT,regex:e.reservedClauses.includes("LIMIT")?/LIMIT\b/iuy:void 0,text:h},{type:i.RESERVED_CLAUSE,regex:P(e.reservedClauses,e.identChars),text:h},{type:i.RESERVED_SELECT,regex:P(e.reservedSelect,e.identChars),text:h},{type:i.RESERVED_SET_OPERATION,regex:P(e.reservedSetOperations,e.identChars),text:h},{type:i.WHEN,regex:/WHEN\b/iuy,text:h},{type:i.ELSE,regex:/ELSE\b/iuy,text:h},{type:i.THEN,regex:/THEN\b/iuy,text:h},{type:i.RESERVED_JOIN,regex:P(e.reservedJoins,e.identChars),text:h},{type:i.AND,regex:/AND\b/iuy,text:h},{type:i.OR,regex:/OR\b/iuy,text:h},{type:i.XOR,regex:e.supportsXor?/XOR\b/iuy:void 0,text:h},...e.operatorKeyword?[{type:i.OPERATOR,regex:/OPERATOR *\([^)]+\)/iuy}]:[],{type:i.RESERVED_FUNCTION_NAME,regex:P(e.reservedFunctionNames,e.identChars),text:h},{type:i.RESERVED_DATA_TYPE,regex:P(e.reservedDataTypes,e.identChars),text:h},{type:i.RESERVED_KEYWORD,regex:P(e.reservedKeywords,e.identChars),text:h}])}buildRulesAfterParams(e){return this.validRules([{type:i.VARIABLE,regex:e.variableTypes?ve(e.variableTypes):void 0},{type:i.STRING,regex:ae(e.stringTypes)},{type:i.IDENTIFIER,regex:Xe(e.identChars)},{type:i.DELIMITER,regex:/[;]/uy},{type:i.COMMA,regex:/[,]/y},{type:i.OPEN_PAREN,regex:ee("open",e.extraParens)},{type:i.CLOSE_PAREN,regex:ee("close",e.extraParens)},{type:i.OPERATOR,regex:se(["+","-","/",">","<","=","<>","<=",">=","!=",...e.operators??[]])},{type:i.ASTERISK,regex:/[*]/uy},{type:i.PROPERTY_ACCESS_OPERATOR,regex:se([".",...e.propertyAccessOperators??[]])}])}buildParamRules(e,s){var E,l,I,c,N;let t={named:(s==null?void 0:s.named)||((E=e.paramTypes)==null?void 0:E.named)||[],quoted:(s==null?void 0:s.quoted)||((l=e.paramTypes)==null?void 0:l.quoted)||[],numbered:(s==null?void 0:s.numbered)||((I=e.paramTypes)==null?void 0:I.numbered)||[],positional:typeof(s==null?void 0:s.positional)=="boolean"?s.positional:(c=e.paramTypes)==null?void 0:c.positional,custom:(s==null?void 0:s.custom)||((N=e.paramTypes)==null?void 0:N.custom)||[]};return this.validRules([{type:i.NAMED_PARAMETER,regex:k(t.named,ie(e.paramChars||e.identChars)),key:L=>L.slice(1)},{type:i.QUOTED_PARAMETER,regex:k(t.quoted,Ee(e.identTypes)),key:L=>(({tokenKey:b,quoteChar:a})=>b.replace(new RegExp(C("\\"+a),"gu"),a))({tokenKey:L.slice(2,-1),quoteChar:L.slice(-1)})},{type:i.NUMBERED_PARAMETER,regex:k(t.numbered,"[0-9]+"),key:L=>L.slice(1)},{type:i.POSITIONAL_PARAMETER,regex:t.positional?/[?]/y:void 0},...t.custom.map(L=>({type:i.CUSTOM_PARAMETER,regex:x(L.regex),key:L.key??(b=>b)}))])}validRules(e){return e.filter(s=>!!s.regex)}},h=e=>Y(e.toUpperCase()),_e=new Map;const ze=e=>{let s=_e.get(e);return s||(s=es(e),_e.set(e,s)),s};var es=e=>({tokenizer:new Ze(e.tokenizerOptions,e.name),formatOptions:ss(e.formatOptions)}),ss=e=>({alwaysDenseOperators:e.alwaysDenseOperators||[],onelineClauses:Object.fromEntries(e.onelineClauses.map(s=>[s,!0])),tabularOnelineClauses:Object.fromEntries((e.tabularOnelineClauses??e.onelineClauses).map(s=>[s,!0]))});function ts(e){return e.indentStyle==="tabularLeft"||e.indentStyle==="tabularRight"?" ".repeat(10):e.useTabs?"	":" ".repeat(e.tabWidth)}function $(e){return e.indentStyle==="tabularLeft"||e.indentStyle==="tabularRight"}var rs=class{constructor(e){this.params=e,this.index=0}get({key:e,text:s}){return this.params?e?this.params[e]:this.params[this.index++]:s}getPositionalParameterIndex(){return this.index}setPositionalParameterIndex(e){this.index=e}},Es=me(he(((e,s)=>{(function(t,E){typeof s=="object"&&s.exports?s.exports=E():t.nearley=E()})(e,function(){function t(a,n,o){return this.id=++t.highestId,this.name=a,this.symbols=n,this.postprocess=o,this}t.highestId=0,t.prototype.toString=function(a){var n=a===void 0?this.symbols.map(b).join(" "):this.symbols.slice(0,a).map(b).join(" ")+" \u25CF "+this.symbols.slice(a).map(b).join(" ");return this.name+" \u2192 "+n};function E(a,n,o,R){this.rule=a,this.dot=n,this.reference=o,this.data=[],this.wantedBy=R,this.isComplete=this.dot===a.symbols.length}E.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},E.prototype.nextState=function(a){var n=new E(this.rule,this.dot+1,this.reference,this.wantedBy);return n.left=this,n.right=a,n.isComplete&&(n.data=n.build(),n.right=void 0),n},E.prototype.build=function(){var a=[],n=this;do a.push(n.right.data),n=n.left;while(n.left);return a.reverse(),a},E.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,N.fail))};function l(a,n){this.grammar=a,this.index=n,this.states=[],this.wants={},this.scannable=[],this.completed={}}l.prototype.process=function(a){for(var n=this.states,o=this.wants,R=this.completed,p=0;p<n.length;p++){var A=n[p];if(A.isComplete){if(A.finish(),A.data!==N.fail){for(var S=A.wantedBy,y=S.length;y--;){var d=S[y];this.complete(d,A)}if(A.reference===this.index){var m=A.rule.name;(this.completed[m]=this.completed[m]||[]).push(A)}}}else{var m=A.rule.symbols[A.dot];if(typeof m!="string"){this.scannable.push(A);continue}if(o[m]){if(o[m].push(A),R.hasOwnProperty(m))for(var f=R[m],y=0;y<f.length;y++){var U=f[y];this.complete(A,U)}}else o[m]=[A],this.predict(m)}}},l.prototype.predict=function(a){for(var n=this.grammar.byName[a]||[],o=0;o<n.length;o++){var R=n[o],p=this.wants[a],A=new E(R,0,this.index,p);this.states.push(A)}},l.prototype.complete=function(a,n){var o=a.nextState(n);this.states.push(o)};function I(a,n){this.rules=a,this.start=n||this.rules[0].name;var o=this.byName={};this.rules.forEach(function(R){o.hasOwnProperty(R.name)||(o[R.name]=[]),o[R.name].push(R)})}I.fromCompiled=function(R,n){var o=R.Lexer;R.ParserStart&&(n=R.ParserStart,R=R.ParserRules);var R=R.map(function(A){return new t(A.name,A.symbols,A.postprocess)}),p=new I(R,n);return p.lexer=o,p};function c(){this.reset("")}c.prototype.reset=function(a,n){this.buffer=a,this.index=0,this.line=n?n.line:1,this.lastLineBreak=n?-n.col:0},c.prototype.next=function(){if(this.index<this.buffer.length){var a=this.buffer[this.index++];return a===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:a}}},c.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},c.prototype.formatError=function(a,n){var o=this.buffer;if(typeof o=="string"){var R=o.split(`
`).slice(Math.max(0,this.line-5),this.line),p=o.indexOf(`
`,this.index);p===-1&&(p=o.length);var A=this.index-this.lastLineBreak,S=String(this.line).length;return n+=" at line "+this.line+" col "+A+`:

`,n+=R.map(function(d,m){return y(this.line-R.length+m+1,S)+" "+d},this).join(`
`),n+=`
`+y("",S+A)+`^
`,n}else return n+" at index "+(this.index-1);function y(d,m){var f=String(d);return Array(m-f.length+1).join(" ")+f}};function N(a,n,R){if(a instanceof I)var p=a,R=n;else var p=I.fromCompiled(a,n);for(var A in this.grammar=p,this.options={keepHistory:!1,lexer:p.lexer||new c},R||{})this.options[A]=R[A];this.lexer=this.options.lexer,this.lexerState=void 0;var S=new l(p,0);this.table=[S],S.wants[p.start]=[],S.predict(p.start),S.process(),this.current=0}N.fail={},N.prototype.feed=function(a){var n=this.lexer;n.reset(a,this.lexerState);for(var o;;){try{if(o=n.next(),!o)break}catch(q){var S=new l(this.grammar,this.current+1);this.table.push(S);var R=Error(this.reportLexerError(q));throw R.offset=this.current,R.token=q.token,R}var p=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var A=this.current+1,S=new l(this.grammar,A);this.table.push(S);for(var y=o.text===void 0?o.value:o.text,d=n.constructor===c?o.value:o,m=p.scannable,f=m.length;f--;){var U=m[f],w=U.rule.symbols[U.dot];if(w.test?w.test(d):w.type?w.type===o.type:w.literal===y){var ce=U.nextState({data:d,token:o,isToken:!0,reference:A-1});S.states.push(ce)}}if(S.process(),S.states.length===0){var R=Error(this.reportError(o));throw R.offset=this.current,R.token=o,R}this.options.keepHistory&&(p.lexerState=n.save()),this.current++}return p&&(this.lexerState=n.save()),this.results=this.finish(),this},N.prototype.reportLexerError=function(a){var n,o,R=a.token;return R?(n="input "+JSON.stringify(R.text[0])+" (lexer error)",o=this.lexer.formatError(R,"Syntax error")):(n="input (lexer error)",o=a.message),this.reportErrorCommon(o,n)},N.prototype.reportError=function(a){var n=(a.type?a.type+" token: ":"")+JSON.stringify(a.value===void 0?a:a.value),o=this.lexer.formatError(a,"Syntax error");return this.reportErrorCommon(o,n)},N.prototype.reportErrorCommon=function(a,n){var o=[];o.push(a);var R=this.table.length-2,p=this.table[R],A=p.states.filter(function(S){var y=S.rule.symbols[S.dot];return y&&typeof y!="string"});return A.length===0?(o.push("Unexpected "+n+`. I did not expect any more input. Here is the state of my parse table:
`),this.displayStateStack(p.states,o)):(o.push("Unexpected "+n+`. Instead, I was expecting to see one of the following:
`),A.map(function(S){return this.buildFirstStateStack(S,[])||[S]},this).forEach(function(S){var y=S[0],d=y.rule.symbols[y.dot],m=this.getSymbolDisplay(d);o.push("A "+m+" based on:"),this.displayStateStack(S,o)},this)),o.push(""),o.join(`
`)},N.prototype.displayStateStack=function(a,n){for(var o,R=0,p=0;p<a.length;p++){var A=a[p],S=A.rule.toString(A.dot);S===o?R++:(R>0&&n.push("    ^ "+R+" more lines identical to this"),R=0,n.push("    "+S)),o=S}},N.prototype.getSymbolDisplay=function(a){return L(a)},N.prototype.buildFirstStateStack=function(a,n){if(n.indexOf(a)!==-1)return null;if(a.wantedBy.length===0)return[a];var o=a.wantedBy[0],R=[a].concat(n),p=this.buildFirstStateStack(o,R);return p===null?null:[a].concat(p)},N.prototype.save=function(){var a=this.table[this.current];return a.lexerState=this.lexerState,a},N.prototype.restore=function(a){var n=a.index;this.current=n,this.table[n]=a,this.table.splice(n+1),this.lexerState=a.lexerState,this.results=this.finish()},N.prototype.rewind=function(a){if(!this.options.keepHistory)throw Error("set option `keepHistory` to enable rewinding");this.restore(this.table[a])},N.prototype.finish=function(){var a=[],n=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(o){o.rule.name===n&&o.dot===o.rule.symbols.length&&o.reference===0&&o.data!==N.fail&&a.push(o)}),a.map(function(o){return o.data})};function L(a){var n=typeof a;if(n==="string")return a;if(n==="object"){if(a.literal)return JSON.stringify(a.literal);if(a instanceof RegExp)return"character matching "+a;if(a.type)return a.type+" token";if(a.test)return"token matching "+String(a.test);throw Error("Unknown symbol type: "+a)}}function b(a){var n=typeof a;if(n==="string")return a;if(n==="object"){if(a.literal)return JSON.stringify(a.literal);if(a instanceof RegExp)return a.toString();if(a.type)return"%"+a.type;if(a.test)return"<"+String(a.test)+">";throw Error("Unknown symbol type: "+a)}}return{Parser:N,Grammar:I,Rule:t}})}))(),1);function as(e){return e.map(is).map(ns).map(os).map(_s).map(ls)}var is=(e,s,t)=>{if(Pe(e.type)){let E=Ts(t,s);if(E&&E.type===i.PROPERTY_ACCESS_OPERATOR)return Object.assign(Object.assign({},e),{type:i.IDENTIFIER,text:e.raw});let l=g(t,s);if(l&&l.type===i.PROPERTY_ACCESS_OPERATOR)return Object.assign(Object.assign({},e),{type:i.IDENTIFIER,text:e.raw})}return e},ns=(e,s,t)=>{if(e.type===i.RESERVED_FUNCTION_NAME){let E=g(t,s);if(!E||!le(E))return Object.assign(Object.assign({},e),{type:i.IDENTIFIER,text:e.raw})}return e},os=(e,s,t)=>{if(e.type===i.RESERVED_DATA_TYPE){let E=g(t,s);if(E&&le(E))return Object.assign(Object.assign({},e),{type:i.RESERVED_PARAMETERIZED_DATA_TYPE})}return e},_s=(e,s,t)=>{if(e.type===i.IDENTIFIER){let E=g(t,s);if(E&&Te(E))return Object.assign(Object.assign({},e),{type:i.ARRAY_IDENTIFIER})}return e},ls=(e,s,t)=>{if(e.type===i.RESERVED_DATA_TYPE){let E=g(t,s);if(E&&Te(E))return Object.assign(Object.assign({},e),{type:i.ARRAY_KEYWORD})}return e},Ts=(e,s)=>g(e,s,-1),g=(e,s,t=1)=>{let E=1;for(;e[s+E*t]&&Rs(e[s+E*t]);)E++;return e[s+E*t]},le=e=>e.type===i.OPEN_PAREN&&e.text==="(",Te=e=>e.type===i.OPEN_PAREN&&e.text==="[",Rs=e=>e.type===i.BLOCK_COMMENT||e.type===i.LINE_COMMENT,Re=class{constructor(e){this.tokenize=e,this.index=0,this.tokens=[],this.input=""}reset(e,s){this.input=e,this.index=0,this.tokens=this.tokenize(e)}next(){return this.tokens[this.index++]}save(){}formatError(e){let{line:s,col:t}=ne(this.input,e.start);return`Parse error at token: ${e.text} at line ${s} column ${t}`}has(e){return e in i}},_;(function(e){e.statement="statement",e.clause="clause",e.set_operation="set_operation",e.function_call="function_call",e.parameterized_data_type="parameterized_data_type",e.array_subscript="array_subscript",e.property_access="property_access",e.parenthesis="parenthesis",e.between_predicate="between_predicate",e.case_expression="case_expression",e.case_when="case_when",e.case_else="case_else",e.limit_clause="limit_clause",e.all_columns_asterisk="all_columns_asterisk",e.literal="literal",e.identifier="identifier",e.keyword="keyword",e.data_type="data_type",e.parameter="parameter",e.operator="operator",e.comma="comma",e.line_comment="line_comment",e.block_comment="block_comment",e.disable_comment="disable_comment"})(_=_||(_={}));function K(e){return e[0]}var T=new Re(e=>[]),M=([[e]])=>e,u=e=>({type:_.keyword,tokenType:e.type,text:e.text,raw:e.raw}),Ae=e=>({type:_.data_type,text:e.text,raw:e.raw}),O=(e,{leading:s,trailing:t})=>(s!=null&&s.length&&(e=Object.assign(Object.assign({},e),{leadingComments:s})),t!=null&&t.length&&(e=Object.assign(Object.assign({},e),{trailingComments:t})),e),As=(e,{leading:s,trailing:t})=>{if(s!=null&&s.length){let[E,...l]=e;e=[O(E,{leading:s}),...l]}if(t!=null&&t.length){let E=e.slice(0,-1),l=e[e.length-1];e=[...E,O(l,{trailing:t})]}return e},ps={Lexer:T,ParserRules:[{name:"main$ebnf$1",symbols:[]},{name:"main$ebnf$1",symbols:["main$ebnf$1","statement"],postprocess:e=>e[0].concat([e[1]])},{name:"main",symbols:["main$ebnf$1"],postprocess:([e])=>{let s=e[e.length-1];return s&&!s.hasSemicolon?s.children.length>0?e:e.slice(0,-1):e}},{name:"statement$subexpression$1",symbols:[T.has("DELIMITER")?{type:"DELIMITER"}:DELIMITER]},{name:"statement$subexpression$1",symbols:[T.has("EOF")?{type:"EOF"}:EOF]},{name:"statement",symbols:["expressions_or_clauses","statement$subexpression$1"],postprocess:([e,[s]])=>({type:_.statement,children:e,hasSemicolon:s.type===i.DELIMITER})},{name:"expressions_or_clauses$ebnf$1",symbols:[]},{name:"expressions_or_clauses$ebnf$1",symbols:["expressions_or_clauses$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"expressions_or_clauses$ebnf$2",symbols:[]},{name:"expressions_or_clauses$ebnf$2",symbols:["expressions_or_clauses$ebnf$2","clause"],postprocess:e=>e[0].concat([e[1]])},{name:"expressions_or_clauses",symbols:["expressions_or_clauses$ebnf$1","expressions_or_clauses$ebnf$2"],postprocess:([e,s])=>[...e,...s]},{name:"clause$subexpression$1",symbols:["limit_clause"]},{name:"clause$subexpression$1",symbols:["select_clause"]},{name:"clause$subexpression$1",symbols:["other_clause"]},{name:"clause$subexpression$1",symbols:["set_operation"]},{name:"clause",symbols:["clause$subexpression$1"],postprocess:M},{name:"limit_clause$ebnf$1$subexpression$1$ebnf$1",symbols:["free_form_sql"]},{name:"limit_clause$ebnf$1$subexpression$1$ebnf$1",symbols:["limit_clause$ebnf$1$subexpression$1$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"limit_clause$ebnf$1$subexpression$1",symbols:[T.has("COMMA")?{type:"COMMA"}:COMMA,"limit_clause$ebnf$1$subexpression$1$ebnf$1"]},{name:"limit_clause$ebnf$1",symbols:["limit_clause$ebnf$1$subexpression$1"],postprocess:K},{name:"limit_clause$ebnf$1",symbols:[],postprocess:()=>null},{name:"limit_clause",symbols:[T.has("LIMIT")?{type:"LIMIT"}:LIMIT,"_","expression_chain_","limit_clause$ebnf$1"],postprocess:([e,s,t,E])=>{if(E){let[l,I]=E;return{type:_.limit_clause,limitKw:O(u(e),{trailing:s}),offset:t,count:I}}else return{type:_.limit_clause,limitKw:O(u(e),{trailing:s}),count:t}}},{name:"select_clause$subexpression$1$ebnf$1",symbols:[]},{name:"select_clause$subexpression$1$ebnf$1",symbols:["select_clause$subexpression$1$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"select_clause$subexpression$1",symbols:["all_columns_asterisk","select_clause$subexpression$1$ebnf$1"]},{name:"select_clause$subexpression$1$ebnf$2",symbols:[]},{name:"select_clause$subexpression$1$ebnf$2",symbols:["select_clause$subexpression$1$ebnf$2","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"select_clause$subexpression$1",symbols:["asteriskless_free_form_sql","select_clause$subexpression$1$ebnf$2"]},{name:"select_clause",symbols:[T.has("RESERVED_SELECT")?{type:"RESERVED_SELECT"}:RESERVED_SELECT,"select_clause$subexpression$1"],postprocess:([e,[s,t]])=>({type:_.clause,nameKw:u(e),children:[s,...t]})},{name:"select_clause",symbols:[T.has("RESERVED_SELECT")?{type:"RESERVED_SELECT"}:RESERVED_SELECT],postprocess:([e])=>({type:_.clause,nameKw:u(e),children:[]})},{name:"all_columns_asterisk",symbols:[T.has("ASTERISK")?{type:"ASTERISK"}:ASTERISK],postprocess:()=>({type:_.all_columns_asterisk})},{name:"other_clause$ebnf$1",symbols:[]},{name:"other_clause$ebnf$1",symbols:["other_clause$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"other_clause",symbols:[T.has("RESERVED_CLAUSE")?{type:"RESERVED_CLAUSE"}:RESERVED_CLAUSE,"other_clause$ebnf$1"],postprocess:([e,s])=>({type:_.clause,nameKw:u(e),children:s})},{name:"set_operation$ebnf$1",symbols:[]},{name:"set_operation$ebnf$1",symbols:["set_operation$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"set_operation",symbols:[T.has("RESERVED_SET_OPERATION")?{type:"RESERVED_SET_OPERATION"}:RESERVED_SET_OPERATION,"set_operation$ebnf$1"],postprocess:([e,s])=>({type:_.set_operation,nameKw:u(e),children:s})},{name:"expression_chain_$ebnf$1",symbols:["expression_with_comments_"]},{name:"expression_chain_$ebnf$1",symbols:["expression_chain_$ebnf$1","expression_with_comments_"],postprocess:e=>e[0].concat([e[1]])},{name:"expression_chain_",symbols:["expression_chain_$ebnf$1"],postprocess:K},{name:"expression_chain$ebnf$1",symbols:[]},{name:"expression_chain$ebnf$1",symbols:["expression_chain$ebnf$1","_expression_with_comments"],postprocess:e=>e[0].concat([e[1]])},{name:"expression_chain",symbols:["expression","expression_chain$ebnf$1"],postprocess:([e,s])=>[e,...s]},{name:"andless_expression_chain$ebnf$1",symbols:[]},{name:"andless_expression_chain$ebnf$1",symbols:["andless_expression_chain$ebnf$1","_andless_expression_with_comments"],postprocess:e=>e[0].concat([e[1]])},{name:"andless_expression_chain",symbols:["andless_expression","andless_expression_chain$ebnf$1"],postprocess:([e,s])=>[e,...s]},{name:"expression_with_comments_",symbols:["expression","_"],postprocess:([e,s])=>O(e,{trailing:s})},{name:"_expression_with_comments",symbols:["_","expression"],postprocess:([e,s])=>O(s,{leading:e})},{name:"_andless_expression_with_comments",symbols:["_","andless_expression"],postprocess:([e,s])=>O(s,{leading:e})},{name:"free_form_sql$subexpression$1",symbols:["asteriskless_free_form_sql"]},{name:"free_form_sql$subexpression$1",symbols:["asterisk"]},{name:"free_form_sql",symbols:["free_form_sql$subexpression$1"],postprocess:M},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["asteriskless_andless_expression"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["logic_operator"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["comma"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["comment"]},{name:"asteriskless_free_form_sql$subexpression$1",symbols:["other_keyword"]},{name:"asteriskless_free_form_sql",symbols:["asteriskless_free_form_sql$subexpression$1"],postprocess:M},{name:"expression$subexpression$1",symbols:["andless_expression"]},{name:"expression$subexpression$1",symbols:["logic_operator"]},{name:"expression",symbols:["expression$subexpression$1"],postprocess:M},{name:"andless_expression$subexpression$1",symbols:["asteriskless_andless_expression"]},{name:"andless_expression$subexpression$1",symbols:["asterisk"]},{name:"andless_expression",symbols:["andless_expression$subexpression$1"],postprocess:M},{name:"asteriskless_andless_expression$subexpression$1",symbols:["atomic_expression"]},{name:"asteriskless_andless_expression$subexpression$1",symbols:["between_predicate"]},{name:"asteriskless_andless_expression$subexpression$1",symbols:["case_expression"]},{name:"asteriskless_andless_expression",symbols:["asteriskless_andless_expression$subexpression$1"],postprocess:M},{name:"atomic_expression$subexpression$1",symbols:["array_subscript"]},{name:"atomic_expression$subexpression$1",symbols:["function_call"]},{name:"atomic_expression$subexpression$1",symbols:["property_access"]},{name:"atomic_expression$subexpression$1",symbols:["parenthesis"]},{name:"atomic_expression$subexpression$1",symbols:["curly_braces"]},{name:"atomic_expression$subexpression$1",symbols:["square_brackets"]},{name:"atomic_expression$subexpression$1",symbols:["operator"]},{name:"atomic_expression$subexpression$1",symbols:["identifier"]},{name:"atomic_expression$subexpression$1",symbols:["parameter"]},{name:"atomic_expression$subexpression$1",symbols:["literal"]},{name:"atomic_expression$subexpression$1",symbols:["data_type"]},{name:"atomic_expression$subexpression$1",symbols:["keyword"]},{name:"atomic_expression",symbols:["atomic_expression$subexpression$1"],postprocess:M},{name:"array_subscript",symbols:[T.has("ARRAY_IDENTIFIER")?{type:"ARRAY_IDENTIFIER"}:ARRAY_IDENTIFIER,"_","square_brackets"],postprocess:([e,s,t])=>({type:_.array_subscript,array:O({type:_.identifier,quoted:!1,text:e.text},{trailing:s}),parenthesis:t})},{name:"array_subscript",symbols:[T.has("ARRAY_KEYWORD")?{type:"ARRAY_KEYWORD"}:ARRAY_KEYWORD,"_","square_brackets"],postprocess:([e,s,t])=>({type:_.array_subscript,array:O(u(e),{trailing:s}),parenthesis:t})},{name:"function_call",symbols:[T.has("RESERVED_FUNCTION_NAME")?{type:"RESERVED_FUNCTION_NAME"}:RESERVED_FUNCTION_NAME,"_","parenthesis"],postprocess:([e,s,t])=>({type:_.function_call,nameKw:O(u(e),{trailing:s}),parenthesis:t})},{name:"parenthesis",symbols:[{literal:"("},"expressions_or_clauses",{literal:")"}],postprocess:([e,s,t])=>({type:_.parenthesis,children:s,openParen:"(",closeParen:")"})},{name:"curly_braces$ebnf$1",symbols:[]},{name:"curly_braces$ebnf$1",symbols:["curly_braces$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"curly_braces",symbols:[{literal:"{"},"curly_braces$ebnf$1",{literal:"}"}],postprocess:([e,s,t])=>({type:_.parenthesis,children:s,openParen:"{",closeParen:"}"})},{name:"square_brackets$ebnf$1",symbols:[]},{name:"square_brackets$ebnf$1",symbols:["square_brackets$ebnf$1","free_form_sql"],postprocess:e=>e[0].concat([e[1]])},{name:"square_brackets",symbols:[{literal:"["},"square_brackets$ebnf$1",{literal:"]"}],postprocess:([e,s,t])=>({type:_.parenthesis,children:s,openParen:"[",closeParen:"]"})},{name:"property_access$subexpression$1",symbols:["identifier"]},{name:"property_access$subexpression$1",symbols:["array_subscript"]},{name:"property_access$subexpression$1",symbols:["all_columns_asterisk"]},{name:"property_access$subexpression$1",symbols:["parameter"]},{name:"property_access",symbols:["atomic_expression","_",T.has("PROPERTY_ACCESS_OPERATOR")?{type:"PROPERTY_ACCESS_OPERATOR"}:PROPERTY_ACCESS_OPERATOR,"_","property_access$subexpression$1"],postprocess:([e,s,t,E,[l]])=>({type:_.property_access,object:O(e,{trailing:s}),operator:t.text,property:O(l,{leading:E})})},{name:"between_predicate",symbols:[T.has("BETWEEN")?{type:"BETWEEN"}:BETWEEN,"_","andless_expression_chain","_",T.has("AND")?{type:"AND"}:AND,"_","andless_expression"],postprocess:([e,s,t,E,l,I,c])=>({type:_.between_predicate,betweenKw:u(e),expr1:As(t,{leading:s,trailing:E}),andKw:u(l),expr2:[O(c,{leading:I})]})},{name:"case_expression$ebnf$1",symbols:["expression_chain_"],postprocess:K},{name:"case_expression$ebnf$1",symbols:[],postprocess:()=>null},{name:"case_expression$ebnf$2",symbols:[]},{name:"case_expression$ebnf$2",symbols:["case_expression$ebnf$2","case_clause"],postprocess:e=>e[0].concat([e[1]])},{name:"case_expression",symbols:[T.has("CASE")?{type:"CASE"}:CASE,"_","case_expression$ebnf$1","case_expression$ebnf$2",T.has("END")?{type:"END"}:END],postprocess:([e,s,t,E,l])=>({type:_.case_expression,caseKw:O(u(e),{trailing:s}),endKw:u(l),expr:t||[],clauses:E})},{name:"case_clause",symbols:[T.has("WHEN")?{type:"WHEN"}:WHEN,"_","expression_chain_",T.has("THEN")?{type:"THEN"}:THEN,"_","expression_chain_"],postprocess:([e,s,t,E,l,I])=>({type:_.case_when,whenKw:O(u(e),{trailing:s}),thenKw:O(u(E),{trailing:l}),condition:t,result:I})},{name:"case_clause",symbols:[T.has("ELSE")?{type:"ELSE"}:ELSE,"_","expression_chain_"],postprocess:([e,s,t])=>({type:_.case_else,elseKw:O(u(e),{trailing:s}),result:t})},{name:"comma$subexpression$1",symbols:[T.has("COMMA")?{type:"COMMA"}:COMMA]},{name:"comma",symbols:["comma$subexpression$1"],postprocess:([[e]])=>({type:_.comma})},{name:"asterisk$subexpression$1",symbols:[T.has("ASTERISK")?{type:"ASTERISK"}:ASTERISK]},{name:"asterisk",symbols:["asterisk$subexpression$1"],postprocess:([[e]])=>({type:_.operator,text:e.text})},{name:"operator$subexpression$1",symbols:[T.has("OPERATOR")?{type:"OPERATOR"}:OPERATOR]},{name:"operator",symbols:["operator$subexpression$1"],postprocess:([[e]])=>({type:_.operator,text:e.text})},{name:"identifier$subexpression$1",symbols:[T.has("IDENTIFIER")?{type:"IDENTIFIER"}:IDENTIFIER]},{name:"identifier$subexpression$1",symbols:[T.has("QUOTED_IDENTIFIER")?{type:"QUOTED_IDENTIFIER"}:QUOTED_IDENTIFIER]},{name:"identifier$subexpression$1",symbols:[T.has("VARIABLE")?{type:"VARIABLE"}:VARIABLE]},{name:"identifier",symbols:["identifier$subexpression$1"],postprocess:([[e]])=>({type:_.identifier,quoted:e.type!=="IDENTIFIER",text:e.text})},{name:"parameter$subexpression$1",symbols:[T.has("NAMED_PARAMETER")?{type:"NAMED_PARAMETER"}:NAMED_PARAMETER]},{name:"parameter$subexpression$1",symbols:[T.has("QUOTED_PARAMETER")?{type:"QUOTED_PARAMETER"}:QUOTED_PARAMETER]},{name:"parameter$subexpression$1",symbols:[T.has("NUMBERED_PARAMETER")?{type:"NUMBERED_PARAMETER"}:NUMBERED_PARAMETER]},{name:"parameter$subexpression$1",symbols:[T.has("POSITIONAL_PARAMETER")?{type:"POSITIONAL_PARAMETER"}:POSITIONAL_PARAMETER]},{name:"parameter$subexpression$1",symbols:[T.has("CUSTOM_PARAMETER")?{type:"CUSTOM_PARAMETER"}:CUSTOM_PARAMETER]},{name:"parameter",symbols:["parameter$subexpression$1"],postprocess:([[e]])=>({type:_.parameter,key:e.key,text:e.text})},{name:"literal$subexpression$1",symbols:[T.has("NUMBER")?{type:"NUMBER"}:NUMBER]},{name:"literal$subexpression$1",symbols:[T.has("STRING")?{type:"STRING"}:STRING]},{name:"literal",symbols:["literal$subexpression$1"],postprocess:([[e]])=>({type:_.literal,text:e.text})},{name:"keyword$subexpression$1",symbols:[T.has("RESERVED_KEYWORD")?{type:"RESERVED_KEYWORD"}:RESERVED_KEYWORD]},{name:"keyword$subexpression$1",symbols:[T.has("RESERVED_PHRASE")?{type:"RESERVED_PHRASE"}:RESERVED_PHRASE]},{name:"keyword$subexpression$1",symbols:[T.has("RESERVED_JOIN")?{type:"RESERVED_JOIN"}:RESERVED_JOIN]},{name:"keyword",symbols:["keyword$subexpression$1"],postprocess:([[e]])=>u(e)},{name:"data_type$subexpression$1",symbols:[T.has("RESERVED_DATA_TYPE")?{type:"RESERVED_DATA_TYPE"}:RESERVED_DATA_TYPE]},{name:"data_type",symbols:["data_type$subexpression$1"],postprocess:([[e]])=>Ae(e)},{name:"data_type",symbols:[T.has("RESERVED_PARAMETERIZED_DATA_TYPE")?{type:"RESERVED_PARAMETERIZED_DATA_TYPE"}:RESERVED_PARAMETERIZED_DATA_TYPE,"_","parenthesis"],postprocess:([e,s,t])=>({type:_.parameterized_data_type,dataType:O(Ae(e),{trailing:s}),parenthesis:t})},{name:"logic_operator$subexpression$1",symbols:[T.has("AND")?{type:"AND"}:AND]},{name:"logic_operator$subexpression$1",symbols:[T.has("OR")?{type:"OR"}:OR]},{name:"logic_operator$subexpression$1",symbols:[T.has("XOR")?{type:"XOR"}:XOR]},{name:"logic_operator",symbols:["logic_operator$subexpression$1"],postprocess:([[e]])=>u(e)},{name:"other_keyword$subexpression$1",symbols:[T.has("WHEN")?{type:"WHEN"}:WHEN]},{name:"other_keyword$subexpression$1",symbols:[T.has("THEN")?{type:"THEN"}:THEN]},{name:"other_keyword$subexpression$1",symbols:[T.has("ELSE")?{type:"ELSE"}:ELSE]},{name:"other_keyword$subexpression$1",symbols:[T.has("END")?{type:"END"}:END]},{name:"other_keyword",symbols:["other_keyword$subexpression$1"],postprocess:([[e]])=>u(e)},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","comment"],postprocess:e=>e[0].concat([e[1]])},{name:"_",symbols:["_$ebnf$1"],postprocess:([e])=>e},{name:"comment",symbols:[T.has("LINE_COMMENT")?{type:"LINE_COMMENT"}:LINE_COMMENT],postprocess:([e])=>({type:_.line_comment,text:e.text,precedingWhitespace:e.precedingWhitespace})},{name:"comment",symbols:[T.has("BLOCK_COMMENT")?{type:"BLOCK_COMMENT"}:BLOCK_COMMENT],postprocess:([e])=>({type:_.block_comment,text:e.text,precedingWhitespace:e.precedingWhitespace})},{name:"comment",symbols:[T.has("DISABLE_COMMENT")?{type:"DISABLE_COMMENT"}:DISABLE_COMMENT],postprocess:([e])=>({type:_.disable_comment,text:e.text,precedingWhitespace:e.precedingWhitespace})}],ParserStart:"main"},{Parser:Ss,Grammar:Is}=Es.default;function Ns(e){let s={},t=new Re(l=>[...as(e.tokenize(l,s)),j(l.length)]),E=new Ss(Is.fromCompiled(ps),{lexer:t});return{parse:(l,I)=>{s=I;let{results:c}=E.feed(l);if(c.length===1)return c[0];throw c.length===0?Error("Parse error: Invalid SQL"):Error(`Parse error: Ambiguous grammar
${JSON.stringify(c,void 0,2)}`)}}}var r;(function(e){e[e.SPACE=0]="SPACE",e[e.NO_SPACE=1]="NO_SPACE",e[e.NO_NEWLINE=2]="NO_NEWLINE",e[e.NEWLINE=3]="NEWLINE",e[e.MANDATORY_NEWLINE=4]="MANDATORY_NEWLINE",e[e.INDENT=5]="INDENT",e[e.SINGLE_INDENT=6]="SINGLE_INDENT"})(r=r||(r={}));var pe=class{constructor(e){this.indentation=e,this.items=[]}add(...e){for(let s of e)switch(s){case r.SPACE:this.items.push(r.SPACE);break;case r.NO_SPACE:this.trimHorizontalWhitespace();break;case r.NO_NEWLINE:this.trimWhitespace();break;case r.NEWLINE:this.trimHorizontalWhitespace(),this.addNewline(r.NEWLINE);break;case r.MANDATORY_NEWLINE:this.trimHorizontalWhitespace(),this.addNewline(r.MANDATORY_NEWLINE);break;case r.INDENT:this.addIndentation();break;case r.SINGLE_INDENT:this.items.push(r.SINGLE_INDENT);break;default:this.items.push(s)}}trimHorizontalWhitespace(){for(;cs(B(this.items));)this.items.pop()}trimWhitespace(){for(;ms(B(this.items));)this.items.pop()}addNewline(e){if(this.items.length>0)switch(B(this.items)){case r.NEWLINE:this.items.pop(),this.items.push(e);break;case r.MANDATORY_NEWLINE:break;default:this.items.push(e);break}}addIndentation(){for(let e=0;e<this.indentation.getLevel();e++)this.items.push(r.SINGLE_INDENT)}toString(){return this.items.map(e=>this.itemToString(e)).join("")}getLayoutItems(){return this.items}itemToString(e){switch(e){case r.SPACE:return" ";case r.NEWLINE:case r.MANDATORY_NEWLINE:return`
`;case r.SINGLE_INDENT:return this.indentation.getSingleIndent();default:return e}}},cs=e=>e===r.SPACE||e===r.SINGLE_INDENT,ms=e=>e===r.SPACE||e===r.SINGLE_INDENT||e===r.NEWLINE;function Se(e,s){if(s==="standard")return e;let t=[];return e.length>=10&&e.includes(" ")&&([e,...t]=e.split(" ")),e=s==="tabularLeft"?e.padEnd(9," "):e.padStart(9," "),e+["",...t].join(" ")}function Ie(e){return be(e)||e===i.RESERVED_CLAUSE||e===i.RESERVED_SELECT||e===i.RESERVED_SET_OPERATION||e===i.RESERVED_JOIN||e===i.LIMIT}var v="top-level",hs="block-level",Ne=class{constructor(e){this.indent=e,this.indentTypes=[]}getSingleIndent(){return this.indent}getLevel(){return this.indentTypes.length}increaseTopLevel(){this.indentTypes.push(v)}increaseBlockLevel(){this.indentTypes.push(hs)}decreaseTopLevel(){this.indentTypes.length>0&&B(this.indentTypes)===v&&this.indentTypes.pop()}decreaseBlockLevel(){for(;this.indentTypes.length>0&&this.indentTypes.pop()===v;);}},us=class extends pe{constructor(e){super(new Ne("")),this.expressionWidth=e,this.length=0,this.trailingSpace=!1}add(...e){if(e.forEach(s=>this.addToLength(s)),this.length>this.expressionWidth)throw new X;super.add(...e)}addToLength(e){if(typeof e=="string")this.length+=e.length,this.trailingSpace=!1;else{if(e===r.MANDATORY_NEWLINE||e===r.NEWLINE)throw new X;e===r.INDENT||e===r.SINGLE_INDENT||e===r.SPACE?this.trailingSpace||(this.trailingSpace=(this.length++,!0)):(e===r.NO_NEWLINE||e===r.NO_SPACE)&&this.trailingSpace&&(this.trailingSpace=!1,this.length--)}}},X=class extends Error{},Os=class J{constructor({cfg:s,dialectCfg:t,params:E,layout:l,inline:I=!1}){this.inline=!1,this.nodes=[],this.index=-1,this.cfg=s,this.dialectCfg=t,this.inline=I,this.params=E,this.layout=l}format(s){for(this.nodes=s,this.index=0;this.index<this.nodes.length;this.index++)this.formatNode(this.nodes[this.index]);return this.layout}formatNode(s){this.formatComments(s.leadingComments),this.formatNodeWithoutComments(s),this.formatComments(s.trailingComments)}formatNodeWithoutComments(s){switch(s.type){case _.function_call:return this.formatFunctionCall(s);case _.parameterized_data_type:return this.formatParameterizedDataType(s);case _.array_subscript:return this.formatArraySubscript(s);case _.property_access:return this.formatPropertyAccess(s);case _.parenthesis:return this.formatParenthesis(s);case _.between_predicate:return this.formatBetweenPredicate(s);case _.case_expression:return this.formatCaseExpression(s);case _.case_when:return this.formatCaseWhen(s);case _.case_else:return this.formatCaseElse(s);case _.clause:return this.formatClause(s);case _.set_operation:return this.formatSetOperation(s);case _.limit_clause:return this.formatLimitClause(s);case _.all_columns_asterisk:return this.formatAllColumnsAsterisk(s);case _.literal:return this.formatLiteral(s);case _.identifier:return this.formatIdentifier(s);case _.parameter:return this.formatParameter(s);case _.operator:return this.formatOperator(s);case _.comma:return this.formatComma(s);case _.line_comment:return this.formatLineComment(s);case _.block_comment:return this.formatBlockComment(s);case _.disable_comment:return this.formatBlockComment(s);case _.data_type:return this.formatDataType(s);case _.keyword:return this.formatKeywordNode(s)}}formatFunctionCall(s){this.withComments(s.nameKw,()=>{this.layout.add(this.showFunctionKw(s.nameKw))}),this.formatNode(s.parenthesis)}formatParameterizedDataType(s){this.withComments(s.dataType,()=>{this.layout.add(this.showDataType(s.dataType))}),this.formatNode(s.parenthesis)}formatArraySubscript(s){let t;switch(s.array.type){case _.data_type:t=this.showDataType(s.array);break;case _.keyword:t=this.showKw(s.array);break;default:t=this.showIdentifier(s.array);break}this.withComments(s.array,()=>{this.layout.add(t)}),this.formatNode(s.parenthesis)}formatPropertyAccess(s){this.formatNode(s.object),this.layout.add(r.NO_SPACE,s.operator),this.formatNode(s.property)}formatParenthesis(s){let t=this.formatInlineExpression(s.children);t?(this.layout.add(s.openParen),this.layout.add(...t.getLayoutItems()),this.layout.add(r.NO_SPACE,s.closeParen,r.SPACE)):(this.layout.add(s.openParen,r.NEWLINE),$(this.cfg)?(this.layout.add(r.INDENT),this.layout=this.formatSubExpression(s.children)):(this.layout.indentation.increaseBlockLevel(),this.layout.add(r.INDENT),this.layout=this.formatSubExpression(s.children),this.layout.indentation.decreaseBlockLevel()),this.layout.add(r.NEWLINE,r.INDENT,s.closeParen,r.SPACE))}formatBetweenPredicate(s){this.layout.add(this.showKw(s.betweenKw),r.SPACE),this.layout=this.formatSubExpression(s.expr1),this.layout.add(r.NO_SPACE,r.SPACE,this.showNonTabularKw(s.andKw),r.SPACE),this.layout=this.formatSubExpression(s.expr2),this.layout.add(r.SPACE)}formatCaseExpression(s){this.formatNode(s.caseKw),this.layout.indentation.increaseBlockLevel(),this.layout=this.formatSubExpression(s.expr),this.layout=this.formatSubExpression(s.clauses),this.layout.indentation.decreaseBlockLevel(),this.layout.add(r.NEWLINE,r.INDENT),this.formatNode(s.endKw)}formatCaseWhen(s){this.layout.add(r.NEWLINE,r.INDENT),this.formatNode(s.whenKw),this.layout=this.formatSubExpression(s.condition),this.formatNode(s.thenKw),this.layout=this.formatSubExpression(s.result)}formatCaseElse(s){this.layout.add(r.NEWLINE,r.INDENT),this.formatNode(s.elseKw),this.layout=this.formatSubExpression(s.result)}formatClause(s){this.isOnelineClause(s)?this.formatClauseInOnelineStyle(s):$(this.cfg)?this.formatClauseInTabularStyle(s):this.formatClauseInIndentedStyle(s)}isOnelineClause(s){return $(this.cfg)?this.dialectCfg.tabularOnelineClauses[s.nameKw.text]:this.dialectCfg.onelineClauses[s.nameKw.text]}formatClauseInIndentedStyle(s){this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s.nameKw),r.NEWLINE),this.layout.indentation.increaseTopLevel(),this.layout.add(r.INDENT),this.layout=this.formatSubExpression(s.children),this.layout.indentation.decreaseTopLevel()}formatClauseInOnelineStyle(s){this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s.nameKw),r.SPACE),this.layout=this.formatSubExpression(s.children)}formatClauseInTabularStyle(s){this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s.nameKw),r.SPACE),this.layout.indentation.increaseTopLevel(),this.layout=this.formatSubExpression(s.children),this.layout.indentation.decreaseTopLevel()}formatSetOperation(s){this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s.nameKw),r.NEWLINE),this.layout.add(r.INDENT),this.layout=this.formatSubExpression(s.children)}formatLimitClause(s){this.withComments(s.limitKw,()=>{this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s.limitKw))}),this.layout.indentation.increaseTopLevel(),$(this.cfg)?this.layout.add(r.SPACE):this.layout.add(r.NEWLINE,r.INDENT),s.offset?(this.layout=this.formatSubExpression(s.offset),this.layout.add(r.NO_SPACE,",",r.SPACE),this.layout=this.formatSubExpression(s.count)):this.layout=this.formatSubExpression(s.count),this.layout.indentation.decreaseTopLevel()}formatAllColumnsAsterisk(s){this.layout.add("*",r.SPACE)}formatLiteral(s){this.layout.add(s.text,r.SPACE)}formatIdentifier(s){this.layout.add(this.showIdentifier(s),r.SPACE)}formatParameter(s){this.layout.add(this.params.get(s),r.SPACE)}formatOperator({text:s}){this.cfg.denseOperators||this.dialectCfg.alwaysDenseOperators.includes(s)?this.layout.add(r.NO_SPACE,s):s===":"?this.layout.add(r.NO_SPACE,s,r.SPACE):this.layout.add(s,r.SPACE)}formatComma(s){this.inline?this.layout.add(r.NO_SPACE,",",r.SPACE):this.layout.add(r.NO_SPACE,",",r.NEWLINE,r.INDENT)}withComments(s,t){this.formatComments(s.leadingComments),t(),this.formatComments(s.trailingComments)}formatComments(s){s&&s.forEach(t=>{t.type===_.line_comment?this.formatLineComment(t):this.formatBlockComment(t)})}formatLineComment(s){W(s.precedingWhitespace||"")?this.layout.add(r.NEWLINE,r.INDENT,s.text,r.MANDATORY_NEWLINE,r.INDENT):this.layout.getLayoutItems().length>0?this.layout.add(r.NO_NEWLINE,r.SPACE,s.text,r.MANDATORY_NEWLINE,r.INDENT):this.layout.add(s.text,r.MANDATORY_NEWLINE,r.INDENT)}formatBlockComment(s){s.type===_.block_comment&&this.isMultilineBlockComment(s)?(this.splitBlockComment(s.text).forEach(t=>{this.layout.add(r.NEWLINE,r.INDENT,t)}),this.layout.add(r.NEWLINE,r.INDENT)):this.layout.add(s.text,r.SPACE)}isMultilineBlockComment(s){return W(s.text)||W(s.precedingWhitespace||"")}isDocComment(s){let t=s.split(/\n/);return/^\/\*\*?$/.test(t[0])&&t.slice(1,t.length-1).every(E=>/^\s*\*/.test(E))&&/^\s*\*\/$/.test(B(t))}splitBlockComment(s){return this.isDocComment(s)?s.split(/\n/).map(t=>/^\s*\*/.test(t)?" "+t.replace(/^\s*/,""):t):s.split(/\n/).map(t=>t.replace(/^\s*/,""))}formatSubExpression(s){return new J({cfg:this.cfg,dialectCfg:this.dialectCfg,params:this.params,layout:this.layout,inline:this.inline}).format(s)}formatInlineExpression(s){let t=this.params.getPositionalParameterIndex();try{return new J({cfg:this.cfg,dialectCfg:this.dialectCfg,params:this.params,layout:new us(this.cfg.expressionWidth),inline:!0}).format(s)}catch(E){if(E instanceof X){this.params.setPositionalParameterIndex(t);return}else throw E}}formatKeywordNode(s){switch(s.tokenType){case i.RESERVED_JOIN:return this.formatJoin(s);case i.AND:case i.OR:case i.XOR:return this.formatLogicalOperator(s);default:return this.formatKeyword(s)}}formatJoin(s){$(this.cfg)?(this.layout.indentation.decreaseTopLevel(),this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s),r.SPACE),this.layout.indentation.increaseTopLevel()):this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s),r.SPACE)}formatKeyword(s){this.layout.add(this.showKw(s),r.SPACE)}formatLogicalOperator(s){this.cfg.logicalOperatorNewline==="before"?$(this.cfg)?(this.layout.indentation.decreaseTopLevel(),this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s),r.SPACE),this.layout.indentation.increaseTopLevel()):this.layout.add(r.NEWLINE,r.INDENT,this.showKw(s),r.SPACE):this.layout.add(this.showKw(s),r.NEWLINE,r.INDENT)}formatDataType(s){this.layout.add(this.showDataType(s),r.SPACE)}showKw(s){return Ie(s.tokenType)?Se(this.showNonTabularKw(s),this.cfg.indentStyle):this.showNonTabularKw(s)}showNonTabularKw(s){switch(this.cfg.keywordCase){case"preserve":return Y(s.raw);case"upper":return s.text;case"lower":return s.text.toLowerCase()}}showFunctionKw(s){return Ie(s.tokenType)?Se(this.showNonTabularFunctionKw(s),this.cfg.indentStyle):this.showNonTabularFunctionKw(s)}showNonTabularFunctionKw(s){switch(this.cfg.functionCase){case"preserve":return Y(s.raw);case"upper":return s.text;case"lower":return s.text.toLowerCase()}}showIdentifier(s){if(s.quoted)return s.text;switch(this.cfg.identifierCase){case"preserve":return s.text;case"upper":return s.text.toUpperCase();case"lower":return s.text.toLowerCase()}}showDataType(s){switch(this.cfg.dataTypeCase){case"preserve":return Y(s.raw);case"upper":return s.text;case"lower":return s.text.toLowerCase()}}},ys=class{constructor(e,s){this.dialect=e,this.cfg=s,this.params=new rs(this.cfg.params)}format(e){let s=this.parse(e);return this.formatAst(s).trimEnd()}parse(e){return Ns(this.dialect.tokenizer).parse(e,this.cfg.paramTypes||{})}formatAst(e){return e.map(s=>this.formatStatement(s)).join(`
`.repeat(this.cfg.linesBetweenQueries+1))}formatStatement(e){let s=new Os({cfg:this.cfg,dialectCfg:this.dialect.formatOptions,params:this.params,layout:new pe(new Ne(ts(this.cfg)))}).format(e.children);return e.hasSemicolon&&(this.cfg.newlineBeforeSemicolon?s.add(r.NEWLINE,";"):s.add(r.NO_NEWLINE,";")),s.toString()}},F=class extends Error{};function Ls(e){for(let s of["multilineLists","newlineBeforeOpenParen","newlineBeforeCloseParen","aliasAs","commaPosition","tabulateAlias"])if(s in e)throw new F(`${s} config is no more supported.`);if(e.expressionWidth<=0)throw new F(`expressionWidth config must be positive number. Received ${e.expressionWidth} instead.`);if(e.params&&!Cs(e.params)&&console.warn('WARNING: All "params" option values should be strings.'),e.paramTypes&&!ds(e.paramTypes))throw new F("Empty regex given in custom paramTypes. That would result in matching infinite amount of parameters.");return e}function Cs(e){return(e instanceof Array?e:Object.values(e)).every(s=>typeof s=="string")}function ds(e){return e.custom&&Array.isArray(e.custom)?e.custom.every(s=>s.regex!==""):!0}var fs=function(e,s){var t={};for(var E in e)Object.prototype.hasOwnProperty.call(e,E)&&s.indexOf(E)<0&&(t[E]=e[E]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,E=Object.getOwnPropertySymbols(e);l<E.length;l++)s.indexOf(E[l])<0&&Object.prototype.propertyIsEnumerable.call(e,E[l])&&(t[E[l]]=e[E[l]]);return t},Ds={tabWidth:2,useTabs:!1,keywordCase:"preserve",identifierCase:"preserve",dataTypeCase:"preserve",functionCase:"preserve",indentStyle:"standard",logicalOperatorNewline:"before",expressionWidth:50,linesBetweenQueries:1,denseOperators:!1,newlineBeforeSemicolon:!1};const Ps=(e,s)=>{var{dialect:t}=s,E=fs(s,["dialect"]);if(typeof e!="string")throw Error("Invalid query argument. Expected string, instead got "+typeof e);let l=Ls(Object.assign(Object.assign({},Ds),E));return new ys(ze(t),l).format(e)};export{F as ConfigError,Ye as duckdb,D as expandPhrases,Ps as formatDialect};
