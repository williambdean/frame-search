const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./esm-C7NRcvAd.js","./precisionRound-BIK1W-Pu.js","./defaultLocale-DEOAvdte.js","./linear-BdKgxuJR.js","./timer-9ePNNBwU.js","./chunk-DZLz74EQ.js","./init-PHOs_KoL.js","./src-BIb7rCUF.js","./time-SXziURV6.js","./defaultLocale-Ca1Ci3kv.js","./range-DCP2k33Q.js","./vega-loader.browser.module-B-icPEAc.js","./treemap-DjDHyFZi.js","./path-DE1VIUo_.js","./colors-CmQtb3K-.js","./ordinal-B8Ce3bue.js","./arc-K25O4dmk.js","./math-Cpuq8NJh.js","./array-pmtsE1gt.js","./step-DCnHyPDa.js","./line-D2-zCSal.js","./fast-deep-equal-BmkHHxS9.js","./esm-C3gGYGcG.js","./prop-types-BdSU55sL.js","./react-BcIddLXZ.js","./tslib.es6-sakIzgHM.js"])))=>i.map(i=>d[i]);
import{s as E}from"./chunk-DZLz74EQ.js";import{c as D,d as Q,l as Z}from"./jotai-DDOP7CKM.js";import{t as ee}from"./react-BcIddLXZ.js";import{W as H,j as te,__tla as re}from"./cells-B6jS0AIj.js";import"./react-dom-D6bRRS5R.js";import"./zod-U2NFpcFA.js";import{n as ie,t as se}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-D5Z9rM2X.js";import"./isSymbol-xTSywenE.js";import"./_arrayMap-DQI2GUNb.js";import"./toNumber-CTOPJrpu.js";import"./toInteger-Bor4StOs.js";import"./isArrayLikeObject-DKyJYtr8.js";import"./_getTag-CVRrQL_Q.js";import"./_baseIsEqual-BF8660ot.js";import"./merge-BgA7kxZb.js";import"./_baseProperty-CIKnF2iY.js";import"./now-B6JN1xKT.js";import"./debounce-70y9MzDK.js";import"./hotkeys-Lbk6RHir.js";import"./invariant-DPGusy7Z.js";import"./utils-DnJCRgaX.js";import"./constants-DIZnpo2K.js";import"./config-BjdJmdrN.js";import"./useEventListener-C5BS4xuN.js";import{t as le}from"./cn-C5VTNYKf.js";import"./button-nRVaalxL.js";import"./dist-BPcMnGQn.js";import"./dist-pZAIwcZo.js";import"./once-Co7xi2Ip.js";import"./capabilities-DdXtcIOa.js";import"./createReducer-80xvKyHq.js";import"./requests-D3Z6okhb.js";import{t as ae}from"./preload-helper-BpItL31i.js";import"./dist-C13bkrcz.js";import"./dist-DZNGKufD.js";import"./dist-DBeOBCHw.js";import"./dist-Ba10OKR3.js";import"./dist-D-CsU-_R.js";import"./dist-ClBFnEcy.js";import"./stex-LEaAsvUb.js";import"./Deferred-zIiWPYX3.js";import"./uuid-Dj56ryH_.js";import"./key-DWQdrH_J.js";import"./use-toast-BiL_AQz9.js";import"./main-CD7jouuS.js";import"./marked.esm-DCf1d_lA.js";import"./connection-DnLUBy9M.js";import"./dist-Q3T6mWQ0.js";import{r as oe}from"./useTheme-BMknLtnH.js";import{t as me}from"./createLucideIcon-DA8ZBm4D.js";import{t as ne}from"./activity-DP54Flp6.js";import{n as pe,r as O}from"./CellStatus-D2Ps_WFf.js";import"./type-Cpth3na1.js";import"./check-BUgsJwxM.js";import{_ as ce}from"./select-DJ0A_oCR.js";import{t as de}from"./chevron-right-WxQzIptp.js";import{t as ue}from"./circle-check-CqMhoTIq.js";import{t as he}from"./circle-play-BZK6Xpzv.js";import"./toDate-sQp07c5U.js";import{t as xe}from"./circle-x-DGA84U3r.js";import"./ellipsis-D2pzSaaA.js";import"./refresh-cw-9lSVG80g.js";import"./input-BPw9p_8N.js";import"./workflow-CVCR1Vz9.js";import"./useNonce-DECX9FAH.js";import"./badge-CFi0nvIx.js";import"./Combination-DR4iFoRS.js";import"./dist-Cei_8ikW.js";import{t as q}from"./tooltip-BQKXsEoT.js";import"./useLifecycle-CuZnZLRp.js";import"./menu-items-DOc2hwO2.js";import"./tslib.es6-sakIzgHM.js";import"./en-US-CUvYxyLA.js";import"./alert-dialog-DM1h8RhU.js";import"./dialog-CEqVOFHc.js";import"./context-BMtIGcq8.js";import"./useDateFormatter-B6Y_k710.js";import"./useNumberFormatter-DynX1ecE.js";import"./numbers-Hxwz5HuE.js";import"./useEvent-d8iQXgui.js";import"./useDebounce-BDmbJDbT.js";import"./ImperativeModal-CmOSTULR.js";import"./vega-loader.browser.module-B-icPEAc.js";import"./precisionRound-BIK1W-Pu.js";import"./linear-BdKgxuJR.js";import{n as fe}from"./src-BIb7rCUF.js";import"./ordinal-B8Ce3bue.js";import"./time-SXziURV6.js";import"./range-DCP2k33Q.js";import"./defaultLocale-DEOAvdte.js";import"./defaultLocale-Ca1Ci3kv.js";import{t as ge}from"./cell-link-D9FNaXGs.js";import{t as ve}from"./bundle.esm-DY-5mqxG.js";import{t as je}from"./empty-state-NyXKwoVS.js";import"./timer-9ePNNBwU.js";import"./multi-icon-CG7c8CMC.js";import{t as ye}from"./clear-button-Bzu9pPir.js";import{n as Ie,t as Se}from"./runs-Gx2PdGsg.js";import"./path-DE1VIUo_.js";import"./math-Cpuq8NJh.js";import"./arc-K25O4dmk.js";import"./array-pmtsE1gt.js";import"./step-DCnHyPDa.js";import"./line-D2-zCSal.js";import"./init-PHOs_KoL.js";import"./colors-CmQtb3K-.js";import"./treemap-DjDHyFZi.js";let F,w,be=Promise.all([(()=>{try{return re}catch{}})()]).then(async()=>{var V=me("circle-ellipsis",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]),T=E(ie(),1),_=E(ee(),1);const M="hoveredCellId",$="cellHover";var U="cellNum",P="cell",R="startTimestamp",C="endTimestamp",L="status";function A(t,e,r,o){let s="hoursminutessecondsmilliseconds";return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",background:o==="dark"?"black":void 0,mark:{type:"bar",cornerRadius:2},params:[{name:M,bind:{element:`#${e}`}},{name:$,select:{type:"point",on:"mouseover",fields:[P],clear:"mouseout"}}],height:{step:r==="sideBySide"?26:21},encoding:{y:{field:U,scale:{paddingInner:.2},sort:{field:"sortPriority"},title:"cell",axis:r==="sideBySide"?null:void 0},x:{field:R,type:"temporal",axis:{orient:"top",title:null}},x2:{field:C,type:"temporal"},tooltip:[{field:R,type:"temporal",timeUnit:s,title:"Start"},{field:C,type:"temporal",timeUnit:s,title:"End"}],size:{value:{expr:`${M} == toString(datum.${P}) ? 19.5 : 18`}},color:{field:L,scale:{domain:["success","error"],range:["#37BE5F","red"]},legend:null}},data:{values:t},transform:[{calculate:`datum.${L} === 'queued' ? 9999999999999 : datum.${R}`,as:"sortPriority"}],config:{view:{stroke:"transparent"}}}}var i=E(se(),1),z=Q(new Map);F=()=>{let t=(0,T.c)(28),{runIds:e,runMap:r}=D(Se),o=D(z),{clearRuns:s}=Ie(),{theme:a}=oe(),[l,v]=(0,_.useState)("above"),m;t[0]===l?m=t[1]:(m=()=>{v(l==="above"?"sideBySide":"above")},t[0]=l,t[1]=m);let h=m;if(e.length===0){let u;return t[2]===Symbol.for("react.memo_cache_sentinel")?(u=(0,i.jsx)(je,{title:"No traces",description:(0,i.jsx)("span",{children:"Cells that have ran will appear here."}),icon:(0,i.jsx)(ne,{})}),t[2]=u):u=t[2],u}let d;t[3]===Symbol.for("react.memo_cache_sentinel")?(d=(0,i.jsx)("label",{htmlFor:"chartPosition",className:"text-xs",children:"Inline chart"}),t[3]=d):d=t[3];let p=l==="sideBySide",x;t[4]!==p||t[5]!==h?(x=(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[d,(0,i.jsx)("input",{type:"checkbox",name:"chartPosition","data-testid":"chartPosition",onClick:h,defaultChecked:p,className:"h-3 cursor-pointer"})]}),t[4]=p,t[5]=h,t[6]=x):x=t[6];let c;t[7]===s?c=t[8]:(c=(0,i.jsx)(ye,{dataTestId:"clear-traces-button",onClick:s}),t[7]=s,t[8]=c);let j;t[9]!==x||t[10]!==c?(j=(0,i.jsxs)("div",{className:"flex flex-row justify-end gap-3",children:[x,c]}),t[9]=x,t[10]=c,t[11]=j):j=t[11];let f;if(t[12]!==l||t[13]!==o||t[14]!==e||t[15]!==r||t[16]!==a){let u;t[18]!==l||t[19]!==o||t[20]!==r||t[21]!==a?(u=(I,n)=>{let S=r.get(I);if(S)return(0,i.jsx)(Y,{run:S,isExpanded:o.get(S.runId),isMostRecentRun:n===0,chartPosition:l,theme:a},S.runId)},t[18]=l,t[19]=o,t[20]=r,t[21]=a,t[22]=u):u=t[22],f=e.map(u),t[12]=l,t[13]=o,t[14]=e,t[15]=r,t[16]=a,t[17]=f}else f=t[17];let g;t[23]===f?g=t[24]:(g=(0,i.jsx)("div",{className:"flex flex-col gap-3",children:f}),t[23]=f,t[24]=g);let y;return t[25]!==j||t[26]!==g?(y=(0,i.jsxs)("div",{className:"py-1 px-2 overflow-y-scroll",children:[j,g]}),t[25]=j,t[26]=g,t[27]=y):y=t[27],y};var W=_.lazy(()=>ae(()=>import("./esm-C7NRcvAd.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url).then(t=>({default:t.Vega}))),B=t=>{let e=(0,T.c)(10),{ref:r,width:o}=ve(),s=o===void 0?300:o,a=t.theme==="dark"?"dark":void 0,l=s-50,v;e[0]!==t.height||e[1]!==t.signalListeners||e[2]!==t.vegaSpec||e[3]!==a||e[4]!==l?(v=(0,i.jsx)(_.Suspense,{children:(0,i.jsx)(W,{spec:t.vegaSpec,theme:a,width:l,height:t.height,signalListeners:t.signalListeners,actions:!1})}),e[0]=t.height,e[1]=t.signalListeners,e[2]=t.vegaSpec,e[3]=a,e[4]=l,e[5]=v):v=e[5];let m;return e[6]!==t.className||e[7]!==r||e[8]!==v?(m=(0,i.jsx)("div",{className:t.className,ref:r,children:v}),e[6]=t.className,e[7]=r,e[8]=v,e[9]=m):m=e[9],m},Y=({run:t,isMostRecentRun:e,chartPosition:r,isExpanded:o,theme:s})=>{let a=Z(z);o??(o=e);let l=()=>{a(h=>{let d=new Map(h);return d.set(t.runId,!o),d})},v=(0,i.jsx)(o?ce:de,{height:16,className:"inline"}),m=(0,i.jsxs)("span",{className:"text-sm cursor-pointer",onClick:l,children:["Run - ",H(t.runStartTime),v]});return o?(0,i.jsx)(G,{run:t,chartPosition:r,theme:s,title:m},t.runId):(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)("pre",{className:"font-mono font-semibold",children:m})},t.runId)},G=t=>{let e=(0,T.c)(32),{run:r,chartPosition:o,theme:s,title:a}=t,[l,v]=(0,_.useState)(),m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={[$]:(I,n)=>{var b;let S=(b=n.cell)==null?void 0:b[0];v(S??null)}},e[0]=m):m=e[0];let h=m,d=te(),p,x;if(e[1]!==d||e[2]!==o||e[3]!==r.cellRuns||e[4]!==r.runId||e[5]!==s){let I=[...r.cellRuns.values()].map(n=>{let S=n.elapsedTime??0;return{cell:n.cellId,cellNum:d.inOrderIds.indexOf(n.cellId),startTimestamp:w(n.startTime),endTimestamp:w(n.startTime+S),elapsedTime:O(S*1e3),status:n.status}});p=`hiddenInputElement-${r.runId}`,x=fe(A(I,p,o,s)),e[1]=d,e[2]=o,e[3]=r.cellRuns,e[4]=r.runId,e[5]=s,e[6]=p,e[7]=x}else p=e[6],x=e[7];let c=x.spec,j;e[8]!==p||e[9]!==l||e[10]!==r?(j=(0,i.jsx)(J,{run:r,hoveredCellId:l,hiddenInputElementId:p}),e[8]=p,e[9]=l,e[10]=r,e[11]=j):j=e[11];let f=j;if(o==="above"){let I;e[12]!==s||e[13]!==c?(I=(0,i.jsx)(B,{vegaSpec:c,height:120,signalListeners:h,theme:s}),e[12]=s,e[13]=c,e[14]=I):I=e[14];let n;e[15]!==I||e[16]!==a||e[17]!==f?(n=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[a,I,f]}),e[15]=I,e[16]=a,e[17]=f,e[18]=n):n=e[18];let S;return e[19]!==r.runId||e[20]!==n?(S=(0,i.jsx)("div",{className:"flex flex-col",children:n},r.runId),e[19]=r.runId,e[20]=n,e[21]=S):S=e[21],S}let g;e[22]!==a||e[23]!==f?(g=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[a,f]}),e[22]=a,e[23]=f,e[24]=g):g=e[24];let y;e[25]!==s||e[26]!==c?(y=(0,i.jsx)(B,{className:"-mt-0.5 flex-1",vegaSpec:c,height:100,signalListeners:h,theme:s}),e[25]=s,e[26]=c,e[27]=y):y=e[27];let u;return e[28]!==r.runId||e[29]!==g||e[30]!==y?(u=(0,i.jsxs)("div",{className:"flex flex-row",children:[g,y]},r.runId),e[28]=r.runId,e[29]=g,e[30]=y,e[31]=u):u=e[31],u},J=t=>{let e=(0,T.c)(12),{run:r,hoveredCellId:o,hiddenInputElementId:s}=t,a=(0,_.useRef)(null),l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=c=>{a.current&&(a.current.value=String(c),a.current.dispatchEvent(new Event("input",{bubbles:!0})))},e[0]=l):l=e[0];let v=l,m=o||"",h;e[1]!==s||e[2]!==m?(h=(0,i.jsx)("input",{type:"text",id:s,defaultValue:m,hidden:!0,ref:a}),e[1]=s,e[2]=m,e[3]=h):h=e[3];let d;e[4]===r.cellRuns?d=e[5]:(d=[...r.cellRuns.values()],e[4]=r.cellRuns,e[5]=d);let p;e[6]!==o||e[7]!==d?(p=d.map(c=>(0,i.jsx)(X,{cellRun:c,hovered:c.cellId===o,dispatchHoverEvent:v},c.cellId)),e[6]=o,e[7]=d,e[8]=p):p=e[8];let x;return e[9]!==h||e[10]!==p?(x=(0,i.jsxs)("div",{className:"text-xs mt-0.5 ml-3 flex flex-col gap-0.5",children:[h,p]}),e[9]=h,e[10]=p,e[11]=x):x=e[11],x},K={success:(0,i.jsx)(ue,{color:"green",size:14}),running:(0,i.jsx)(he,{color:"var(--blue-10)",size:14}),error:(0,i.jsx)(xe,{color:"red",size:14}),queued:(0,i.jsx)(V,{color:"grey",size:14})},X=t=>{let e=(0,T.c)(39),{cellRun:r,hovered:o,dispatchHoverEvent:s}=t,a;e[0]===r.elapsedTime?a=e[1]:(a=r.elapsedTime?O(r.elapsedTime*1e3):"-",e[0]=r.elapsedTime,e[1]=a);let l=a,v;e[2]!==r.elapsedTime||e[3]!==l?(v=r.elapsedTime?(0,i.jsxs)("span",{children:["This cell took ",(0,i.jsx)(pe,{elapsedTime:l})," to run"]}):(0,i.jsx)("span",{children:"This cell has not been run"}),e[2]=r.elapsedTime,e[3]=l,e[4]=v):v=e[4];let m=v,h;e[5]!==r.cellId||e[6]!==s?(h=()=>{s(r.cellId)},e[5]=r.cellId,e[6]=s,e[7]=h):h=e[7];let d=h,p;e[8]===s?p=e[9]:(p=()=>{s(null)},e[8]=s,e[9]=p);let x=p,c=o&&"bg-(--gray-3) opacity-100",j;e[10]===c?j=e[11]:(j=le("flex flex-row gap-2 py-1 px-1 opacity-70 hover:bg-(--gray-3) hover:opacity-100",c),e[10]=c,e[11]=j);let f;e[12]===r.startTime?f=e[13]:(f=H(r.startTime),e[12]=r.startTime,e[13]=f);let g;e[14]===f?g=e[15]:(g=(0,i.jsxs)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:["[",f,"]"]}),e[14]=f,e[15]=g);let y;e[16]===r.cellId?y=e[17]:(y=(0,i.jsxs)("span",{className:"text-(--gray-10) w-16",children:["(",(0,i.jsx)(ge,{cellId:r.cellId}),")"]}),e[16]=r.cellId,e[17]=y);let u;e[18]===r.code?u=e[19]:(u=(0,i.jsx)("span",{className:"w-40 truncate -ml-1",children:r.code}),e[18]=r.code,e[19]=u);let I;e[20]===l?I=e[21]:(I=(0,i.jsx)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:l}),e[20]=l,e[21]=I);let n;e[22]!==m||e[23]!==I?(n=(0,i.jsx)(q,{content:m,children:I}),e[22]=m,e[23]=I,e[24]=n):n=e[24];let S=K[r.status],b;e[25]!==r.status||e[26]!==S?(b=(0,i.jsx)(q,{content:r.status,children:S}),e[25]=r.status,e[26]=S,e[27]=b):b=e[27];let N;e[28]!==n||e[29]!==b?(N=(0,i.jsxs)("div",{className:"flex flex-row gap-1 w-16 justify-end -ml-2",children:[n,b]}),e[28]=n,e[29]=b,e[30]=N):N=e[30];let k;return e[31]!==d||e[32]!==x||e[33]!==u||e[34]!==N||e[35]!==j||e[36]!==g||e[37]!==y?(k=(0,i.jsxs)("div",{className:j,onMouseEnter:d,onMouseLeave:x,children:[g,y,u,N]}),e[31]=d,e[32]=x,e[33]=u,e[34]=N,e[35]=j,e[36]=g,e[37]=y,e[38]=k):k=e[38],k};w=function(t){try{let e=new Date(t*1e3);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}.${String(e.getMilliseconds()).padStart(3,"0")}`}catch{return""}}});export{F as Tracing,be as __tla,w as formatChartTime};
