var W,G,j;import"./preload-helper-BpItL31i.js";import{n as xt}from"./ordinal-B8Ce3bue.js";import"./purify.es-D83HMRRD.js";import"./timer-9ePNNBwU.js";import{u as tt}from"./src-D-O4qgKm.js";import"./init-PHOs_KoL.js";import{t as kt}from"./colors-CmQtb3K-.js";import{n as x}from"./src-Ci62OB0C.js";import{B as vt,C as bt,G as Lt,U as Et,_ as wt,a as At,b as et,s as St,u as Mt,v as It,z as Pt}from"./chunk-ABZYJK2D-D-T6tPym.js";var Nt=kt("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function ht(t,i){let r;if(i===void 0)for(let a of t)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);else{let a=-1;for(let u of t)(u=i(u,++a,t))!=null&&(r<u||r===void 0&&u>=u)&&(r=u)}return r}function ut(t,i){let r;if(i===void 0)for(let a of t)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);else{let a=-1;for(let u of t)(u=i(u,++a,t))!=null&&(r>u||r===void 0&&u>=u)&&(r=u)}return r}function nt(t,i){let r=0;if(i===void 0)for(let a of t)(a=+a)&&(r+=a);else{let a=-1;for(let u of t)(u=+i(u,++a,t))&&(r+=u)}return r}function Ct(t){return t.target.depth}function $t(t){return t.depth}function Ot(t,i){return i-1-t.height}function ct(t,i){return t.sourceLinks.length?t.depth:i-1}function Tt(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?ut(t.sourceLinks,Ct)-1:0}function Q(t){return function(){return t}}function ft(t,i){return Y(t.source,i.source)||t.index-i.index}function yt(t,i){return Y(t.target,i.target)||t.index-i.index}function Y(t,i){return t.y0-i.y0}function it(t){return t.value}function Dt(t){return t.index}function zt(t){return t.nodes}function jt(t){return t.links}function gt(t,i){let r=t.get(i);if(!r)throw Error("missing: "+i);return r}function dt({nodes:t}){for(let i of t){let r=i.y0,a=r;for(let u of i.sourceLinks)u.y0=r+u.width/2,r+=u.width;for(let u of i.targetLinks)u.y1=a+u.width/2,a+=u.width}}function Ft(){let t=0,i=0,r=1,a=1,u=24,d=8,e,c=Dt,l=ct,y,p,g=zt,S=jt,L=6;function k(){let n={nodes:g.apply(null,arguments),links:S.apply(null,arguments)};return O(n),I(n),C(n),T(n),N(n),dt(n),n}k.update=function(n){return dt(n),n},k.nodeId=function(n){return arguments.length?(c=typeof n=="function"?n:Q(n),k):c},k.nodeAlign=function(n){return arguments.length?(l=typeof n=="function"?n:Q(n),k):l},k.nodeSort=function(n){return arguments.length?(y=n,k):y},k.nodeWidth=function(n){return arguments.length?(u=+n,k):u},k.nodePadding=function(n){return arguments.length?(d=e=+n,k):d},k.nodes=function(n){return arguments.length?(g=typeof n=="function"?n:Q(n),k):g},k.links=function(n){return arguments.length?(S=typeof n=="function"?n:Q(n),k):S},k.linkSort=function(n){return arguments.length?(p=n,k):p},k.size=function(n){return arguments.length?(t=i=0,r=+n[0],a=+n[1],k):[r-t,a-i]},k.extent=function(n){return arguments.length?(t=+n[0][0],r=+n[1][0],i=+n[0][1],a=+n[1][1],k):[[t,i],[r,a]]},k.iterations=function(n){return arguments.length?(L=+n,k):L};function O({nodes:n,links:f}){for(let[o,s]of n.entries())s.index=o,s.sourceLinks=[],s.targetLinks=[];let h=new Map(n.map((o,s)=>[c(o,s,n),o]));for(let[o,s]of f.entries()){s.index=o;let{source:_,target:b}=s;typeof _!="object"&&(_=s.source=gt(h,_)),typeof b!="object"&&(b=s.target=gt(h,b)),_.sourceLinks.push(s),b.targetLinks.push(s)}if(p!=null)for(let{sourceLinks:o,targetLinks:s}of n)o.sort(p),s.sort(p)}function I({nodes:n}){for(let f of n)f.value=f.fixedValue===void 0?Math.max(nt(f.sourceLinks,it),nt(f.targetLinks,it)):f.fixedValue}function C({nodes:n}){let f=n.length,h=new Set(n),o=new Set,s=0;for(;h.size;){for(let _ of h){_.depth=s;for(let{target:b}of _.sourceLinks)o.add(b)}if(++s>f)throw Error("circular link");h=o,o=new Set}}function T({nodes:n}){let f=n.length,h=new Set(n),o=new Set,s=0;for(;h.size;){for(let _ of h){_.height=s;for(let{source:b}of _.targetLinks)o.add(b)}if(++s>f)throw Error("circular link");h=o,o=new Set}}function P({nodes:n}){let f=ht(n,s=>s.depth)+1,h=(r-t-u)/(f-1),o=Array(f);for(let s of n){let _=Math.max(0,Math.min(f-1,Math.floor(l.call(null,s,f))));s.layer=_,s.x0=t+_*h,s.x1=s.x0+u,o[_]?o[_].push(s):o[_]=[s]}if(y)for(let s of o)s.sort(y);return o}function v(n){let f=ut(n,h=>(a-i-(h.length-1)*e)/nt(h,it));for(let h of n){let o=i;for(let s of h){s.y0=o,s.y1=o+s.value*f,o=s.y1+e;for(let _ of s.sourceLinks)_.width=_.value*f}o=(a-o+e)/(h.length+1);for(let s=0;s<h.length;++s){let _=h[s];_.y0+=o*(s+1),_.y1+=o*(s+1)}B(h)}}function N(n){let f=P(n);e=Math.min(d,(a-i)/(ht(f,h=>h.length)-1)),v(f);for(let h=0;h<L;++h){let o=.99**h,s=Math.max(1-o,(h+1)/L);$(f,o,s),D(f,o,s)}}function D(n,f,h){for(let o=1,s=n.length;o<s;++o){let _=n[o];for(let b of _){let E=0,U=0;for(let{source:X,value:q}of b.targetLinks){let lt=q*(b.layer-X.layer);E+=z(X,b)*lt,U+=lt}if(!(U>0))continue;let R=(E/U-b.y0)*f;b.y0+=R,b.y1+=R,A(b)}y===void 0&&_.sort(Y),m(_,h)}}function $(n,f,h){for(let o=n.length-2;o>=0;--o){let s=n[o];for(let _ of s){let b=0,E=0;for(let{target:R,value:X}of _.sourceLinks){let q=X*(R.layer-_.layer);b+=M(_,R)*q,E+=q}if(!(E>0))continue;let U=(b/E-_.y0)*f;_.y0+=U,_.y1+=U,A(_)}y===void 0&&s.sort(Y),m(s,h)}}function m(n,f){let h=n.length>>1,o=n[h];V(n,o.y0-e,h-1,f),w(n,o.y1+e,h+1,f),V(n,a,n.length-1,f),w(n,i,0,f)}function w(n,f,h,o){for(;h<n.length;++h){let s=n[h],_=(f-s.y0)*o;_>1e-6&&(s.y0+=_,s.y1+=_),f=s.y1+e}}function V(n,f,h,o){for(;h>=0;--h){let s=n[h],_=(s.y1-f)*o;_>1e-6&&(s.y0-=_,s.y1-=_),f=s.y0-e}}function A({sourceLinks:n,targetLinks:f}){if(p===void 0){for(let{source:{sourceLinks:h}}of f)h.sort(yt);for(let{target:{targetLinks:h}}of n)h.sort(ft)}}function B(n){if(p===void 0)for(let{sourceLinks:f,targetLinks:h}of n)f.sort(yt),h.sort(ft)}function z(n,f){let h=n.y0-(n.sourceLinks.length-1)*e/2;for(let{target:o,width:s}of n.sourceLinks){if(o===f)break;h+=s+e}for(let{source:o,width:s}of f.targetLinks){if(o===n)break;h-=s}return h}function M(n,f){let h=f.y0-(f.targetLinks.length-1)*e/2;for(let{source:o,width:s}of f.targetLinks){if(o===n)break;h+=s+e}for(let{target:o,width:s}of n.sourceLinks){if(o===f)break;h-=s}return h}return k}var rt=Math.PI,st=2*rt,F=1e-6,Ut=st-F;function ot(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function pt(){return new ot}ot.prototype=pt.prototype={constructor:ot,moveTo:function(t,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+i)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,i){this._+="L"+(this._x1=+t)+","+(this._y1=+i)},quadraticCurveTo:function(t,i,r,a){this._+="Q"+ +t+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},bezierCurveTo:function(t,i,r,a,u,d){this._+="C"+ +t+","+ +i+","+ +r+","+ +a+","+(this._x1=+u)+","+(this._y1=+d)},arcTo:function(t,i,r,a,u){t=+t,i=+i,r=+r,a=+a,u=+u;var d=this._x1,e=this._y1,c=r-t,l=a-i,y=d-t,p=e-i,g=y*y+p*p;if(u<0)throw Error("negative radius: "+u);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=i);else if(g>F)if(!(Math.abs(p*c-l*y)>F)||!u)this._+="L"+(this._x1=t)+","+(this._y1=i);else{var S=r-d,L=a-e,k=c*c+l*l,O=S*S+L*L,I=Math.sqrt(k),C=Math.sqrt(g),T=u*Math.tan((rt-Math.acos((k+g-O)/(2*I*C)))/2),P=T/C,v=T/I;Math.abs(P-1)>F&&(this._+="L"+(t+P*y)+","+(i+P*p)),this._+="A"+u+","+u+",0,0,"+ +(p*S>y*L)+","+(this._x1=t+v*c)+","+(this._y1=i+v*l)}},arc:function(t,i,r,a,u,d){t=+t,i=+i,r=+r,d=!!d;var e=r*Math.cos(a),c=r*Math.sin(a),l=t+e,y=i+c,p=1^d,g=d?a-u:u-a;if(r<0)throw Error("negative radius: "+r);this._x1===null?this._+="M"+l+","+y:(Math.abs(this._x1-l)>F||Math.abs(this._y1-y)>F)&&(this._+="L"+l+","+y),r&&(g<0&&(g=g%st+st),g>Ut?this._+="A"+r+","+r+",0,1,"+p+","+(t-e)+","+(i-c)+"A"+r+","+r+",0,1,"+p+","+(this._x1=l)+","+(this._y1=y):g>F&&(this._+="A"+r+","+r+",0,"+ +(g>=rt)+","+p+","+(this._x1=t+r*Math.cos(u))+","+(this._y1=i+r*Math.sin(u))))},rect:function(t,i,r,a){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+i)+"h"+ +r+"v"+ +a+"h"+-r+"Z"},toString:function(){return this._}};var Wt=pt;function _t(t){return function(){return t}}function Gt(t){return t[0]}function Vt(t){return t[1]}var Bt=Array.prototype.slice;function Rt(t){return t.source}function Xt(t){return t.target}function qt(t){var i=Rt,r=Xt,a=Gt,u=Vt,d=null;function e(){var c,l=Bt.call(arguments),y=i.apply(this,l),p=r.apply(this,l);if(d||(d=c=Wt()),t(d,+a.apply(this,(l[0]=y,l)),+u.apply(this,l),+a.apply(this,(l[0]=p,l)),+u.apply(this,l)),c)return d=null,c+""||null}return e.source=function(c){return arguments.length?(i=c,e):i},e.target=function(c){return arguments.length?(r=c,e):r},e.x=function(c){return arguments.length?(a=typeof c=="function"?c:_t(+c),e):a},e.y=function(c){return arguments.length?(u=typeof c=="function"?c:_t(+c),e):u},e.context=function(c){return arguments.length?(d=c??null,e):d},e}function Qt(t,i,r,a,u){t.moveTo(i,r),t.bezierCurveTo(i=(i+a)/2,r,i,u,a,u)}function Yt(){return qt(Qt)}function Kt(t){return[t.source.x1,t.y0]}function Zt(t){return[t.target.x0,t.y1]}function Ht(){return Yt().source(Kt).target(Zt)}var at=(function(){var t=x(function(e,c,l,y){for(l||(l={}),y=e.length;y--;l[e[y]]=c);return l},"o"),i=[1,9],r=[1,10],a=[1,5,10,12],u={trace:x(function(){},"trace"),yy:{},symbols_:{error:2,start:3,SANKEY:4,NEWLINE:5,csv:6,opt_eof:7,record:8,csv_tail:9,EOF:10,"field[source]":11,COMMA:12,"field[target]":13,"field[value]":14,field:15,escaped:16,non_escaped:17,DQUOTE:18,ESCAPED_TEXT:19,NON_ESCAPED_TEXT:20,$accept:0,$end:1},terminals_:{2:"error",4:"SANKEY",5:"NEWLINE",10:"EOF",11:"field[source]",12:"COMMA",13:"field[target]",14:"field[value]",18:"DQUOTE",19:"ESCAPED_TEXT",20:"NON_ESCAPED_TEXT"},productions_:[0,[3,4],[6,2],[9,2],[9,0],[7,1],[7,0],[8,5],[15,1],[15,1],[16,3],[17,1]],performAction:x(function(e,c,l,y,p,g,S){var L=g.length-1;switch(p){case 7:let k=y.findOrCreateNode(g[L-4].trim().replaceAll('""','"')),O=y.findOrCreateNode(g[L-2].trim().replaceAll('""','"')),I=parseFloat(g[L].trim());y.addLink(k,O,I);break;case 8:case 9:case 11:this.$=g[L];break;case 10:this.$=g[L-1];break}},"anonymous"),table:[{3:1,4:[1,2]},{1:[3]},{5:[1,3]},{6:4,8:5,15:6,16:7,17:8,18:i,20:r},{1:[2,6],7:11,10:[1,12]},t(r,[2,4],{9:13,5:[1,14]}),{12:[1,15]},t(a,[2,8]),t(a,[2,9]),{19:[1,16]},t(a,[2,11]),{1:[2,1]},{1:[2,5]},t(r,[2,2]),{6:17,8:5,15:6,16:7,17:8,18:i,20:r},{15:18,16:7,17:8,18:i,20:r},{18:[1,19]},t(r,[2,3]),{12:[1,20]},t(a,[2,10]),{15:21,16:7,17:8,18:i,20:r},t([1,5,10],[2,7])],defaultActions:{11:[2,1],12:[2,5]},parseError:x(function(e,c){if(c.recoverable)this.trace(e);else{var l=Error(e);throw l.hash=c,l}},"parseError"),parse:x(function(e){var c=this,l=[0],y=[],p=[null],g=[],S=this.table,L="",k=0,O=0,I=0,C=2,T=1,P=g.slice.call(arguments,1),v=Object.create(this.lexer),N={yy:{}};for(var D in this.yy)Object.prototype.hasOwnProperty.call(this.yy,D)&&(N.yy[D]=this.yy[D]);v.setInput(e,N.yy),N.yy.lexer=v,N.yy.parser=this,v.yylloc===void 0&&(v.yylloc={});var $=v.yylloc;g.push($);var m=v.options&&v.options.ranges;typeof N.yy.parseError=="function"?this.parseError=N.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function w(E){l.length-=2*E,p.length-=E,g.length-=E}x(w,"popStack");function V(){var E=y.pop()||v.lex()||T;return typeof E!="number"&&(E instanceof Array&&(y=E,E=y.pop()),E=c.symbols_[E]||E),E}x(V,"lex");for(var A,B,z,M,n,f={},h,o,s,_;;){if(z=l[l.length-1],this.defaultActions[z]?M=this.defaultActions[z]:(A??(A=V()),M=S[z]&&S[z][A]),M===void 0||!M.length||!M[0]){var b="";for(h in _=[],S[z])this.terminals_[h]&&h>C&&_.push("'"+this.terminals_[h]+"'");b=v.showPosition?"Parse error on line "+(k+1)+`:
`+v.showPosition()+`
Expecting `+_.join(", ")+", got '"+(this.terminals_[A]||A)+"'":"Parse error on line "+(k+1)+": Unexpected "+(A==T?"end of input":"'"+(this.terminals_[A]||A)+"'"),this.parseError(b,{text:v.match,token:this.terminals_[A]||A,line:v.yylineno,loc:$,expected:_})}if(M[0]instanceof Array&&M.length>1)throw Error("Parse Error: multiple actions possible at state: "+z+", token: "+A);switch(M[0]){case 1:l.push(A),p.push(v.yytext),g.push(v.yylloc),l.push(M[1]),A=null,B?(A=B,B=null):(O=v.yyleng,L=v.yytext,k=v.yylineno,$=v.yylloc,I>0&&I--);break;case 2:if(o=this.productions_[M[1]][1],f.$=p[p.length-o],f._$={first_line:g[g.length-(o||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(o||1)].first_column,last_column:g[g.length-1].last_column},m&&(f._$.range=[g[g.length-(o||1)].range[0],g[g.length-1].range[1]]),n=this.performAction.apply(f,[L,O,k,N.yy,M[1],p,g].concat(P)),n!==void 0)return n;o&&(l=l.slice(0,-1*o*2),p=p.slice(0,-1*o),g=g.slice(0,-1*o)),l.push(this.productions_[M[1]][0]),p.push(f.$),g.push(f._$),s=S[l[l.length-2]][l[l.length-1]],l.push(s);break;case 3:return!0}}return!0},"parse")};u.lexer=(function(){return{EOF:1,parseError:x(function(e,c){if(this.yy.parser)this.yy.parser.parseError(e,c);else throw Error(e)},"parseError"),setInput:x(function(e,c){return this.yy=c||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},"setInput"),input:x(function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},"input"),unput:x(function(e){var c=e.length,l=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-c),this.offset-=c;var y=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),l.length-1&&(this.yylineno-=l.length-1);var p=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:l?(l.length===y.length?this.yylloc.first_column:0)+y[y.length-l.length].length-l[0].length:this.yylloc.first_column-c},this.options.ranges&&(this.yylloc.range=[p[0],p[0]+this.yyleng-c]),this.yyleng=this.yytext.length,this},"unput"),more:x(function(){return this._more=!0,this},"more"),reject:x(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},"reject"),less:x(function(e){this.unput(this.match.slice(e))},"less"),pastInput:x(function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},"pastInput"),upcomingInput:x(function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},"upcomingInput"),showPosition:x(function(){var e=this.pastInput(),c=Array(e.length+1).join("-");return e+this.upcomingInput()+`
`+c+"^"},"showPosition"),test_match:x(function(e,c){var l,y,p;if(this.options.backtrack_lexer&&(p={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(p.yylloc.range=this.yylloc.range.slice(0))),y=e[0].match(/(?:\r\n?|\n).*/g),y&&(this.yylineno+=y.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:y?y[y.length-1].length-y[y.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],l=this.performAction.call(this,this.yy,this,c,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),l)return l;if(this._backtrack){for(var g in p)this[g]=p[g];return!1}return!1},"test_match"),next:x(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,c,l,y;this._more||(this.yytext="",this.match="");for(var p=this._currentRules(),g=0;g<p.length;g++)if(l=this._input.match(this.rules[p[g]]),l&&(!c||l[0].length>c[0].length)){if(c=l,y=g,this.options.backtrack_lexer){if(e=this.test_match(l,p[g]),e!==!1)return e;if(this._backtrack){c=!1;continue}else return!1}else if(!this.options.flex)break}return c?(e=this.test_match(c,p[y]),e===!1?!1:e):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},"next"),lex:x(function(){return this.next()||this.lex()},"lex"),begin:x(function(e){this.conditionStack.push(e)},"begin"),popState:x(function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},"popState"),_currentRules:x(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},"_currentRules"),topState:x(function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},"topState"),pushState:x(function(e){this.begin(e)},"pushState"),stateStackSize:x(function(){return this.conditionStack.length},"stateStackSize"),options:{"case-insensitive":!0},performAction:x(function(e,c,l,y){switch(l){case 0:return this.pushState("csv"),4;case 1:return this.pushState("csv"),4;case 2:return 10;case 3:return 5;case 4:return 12;case 5:return this.pushState("escaped_text"),18;case 6:return 20;case 7:return this.popState("escaped_text"),18;case 8:return 19}},"anonymous"),rules:[/^(?:sankey-beta\b)/i,/^(?:sankey\b)/i,/^(?:$)/i,/^(?:((\u000D\u000A)|(\u000A)))/i,/^(?:(\u002C))/i,/^(?:(\u0022))/i,/^(?:([\u0020-\u0021\u0023-\u002B\u002D-\u007E])*)/i,/^(?:(\u0022)(?!(\u0022)))/i,/^(?:(([\u0020-\u0021\u0023-\u002B\u002D-\u007E])|(\u002C)|(\u000D)|(\u000A)|(\u0022)(\u0022))*)/i],conditions:{csv:{rules:[2,3,4,5,6,7,8],inclusive:!1},escaped_text:{rules:[7,8],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,8],inclusive:!0}}}})();function d(){this.yy={}}return x(d,"Parser"),d.prototype=u,u.Parser=d,new d})();at.parser=at;var K=at,Z=[],H=[],J=new Map,Jt=x(()=>{Z=[],H=[],J=new Map,At()},"clear"),te=(W=class{constructor(i,r,a=0){this.source=i,this.target=r,this.value=a}},x(W,"SankeyLink"),W),ee=x((t,i,r)=>{Z.push(new te(t,i,r))},"addLink"),ne=(G=class{constructor(i){this.ID=i}},x(G,"SankeyNode"),G),ie={nodesMap:J,getConfig:x(()=>et().sankey,"getConfig"),getNodes:x(()=>H,"getNodes"),getLinks:x(()=>Z,"getLinks"),getGraph:x(()=>({nodes:H.map(t=>({id:t.ID})),links:Z.map(t=>({source:t.source.ID,target:t.target.ID,value:t.value}))}),"getGraph"),addLink:ee,findOrCreateNode:x(t=>{t=St.sanitizeText(t,et());let i=J.get(t);return i===void 0&&(i=new ne(t),J.set(t,i),H.push(i)),i},"findOrCreateNode"),getAccTitle:It,setAccTitle:vt,getAccDescription:wt,setAccDescription:Pt,getDiagramTitle:bt,setDiagramTitle:Et,clear:Jt},mt=(j=class{static next(i){return new j(i+ ++j.count)}constructor(i){this.id=i,this.href=`#${i}`}toString(){return"url("+this.href+")"}},x(j,"Uid"),j.count=0,j),re={left:$t,right:Ot,center:Tt,justify:ct},se={draw:x(function(t,i,r,a){let{securityLevel:u,sankey:d}=et(),e=Mt.sankey,c;u==="sandbox"&&(c=tt("#i"+i));let l=tt(u==="sandbox"?c.nodes()[0].contentDocument.body:"body"),y=u==="sandbox"?l.select(`[id="${i}"]`):tt(`[id="${i}"]`),p=(d==null?void 0:d.width)??e.width,g=(d==null?void 0:d.height)??e.width,S=(d==null?void 0:d.useMaxWidth)??e.useMaxWidth,L=(d==null?void 0:d.nodeAlignment)??e.nodeAlignment,k=(d==null?void 0:d.prefix)??e.prefix,O=(d==null?void 0:d.suffix)??e.suffix,I=(d==null?void 0:d.showValues)??e.showValues,C=a.db.getGraph(),T=re[L];Ft().nodeId(m=>m.id).nodeWidth(10).nodePadding(10+(I?15:0)).nodeAlign(T).extent([[0,0],[p,g]])(C);let P=xt(Nt);y.append("g").attr("class","nodes").selectAll(".node").data(C.nodes).join("g").attr("class","node").attr("id",m=>(m.uid=mt.next("node-")).id).attr("transform",function(m){return"translate("+m.x0+","+m.y0+")"}).attr("x",m=>m.x0).attr("y",m=>m.y0).append("rect").attr("height",m=>m.y1-m.y0).attr("width",m=>m.x1-m.x0).attr("fill",m=>P(m.id));let v=x(({id:m,value:w})=>I?`${m}
${k}${Math.round(w*100)/100}${O}`:m,"getText");y.append("g").attr("class","node-labels").attr("font-size",14).selectAll("text").data(C.nodes).join("text").attr("x",m=>m.x0<p/2?m.x1+6:m.x0-6).attr("y",m=>(m.y1+m.y0)/2).attr("dy",`${I?"0":"0.35"}em`).attr("text-anchor",m=>m.x0<p/2?"start":"end").text(v);let N=y.append("g").attr("class","links").attr("fill","none").attr("stroke-opacity",.5).selectAll(".link").data(C.links).join("g").attr("class","link").style("mix-blend-mode","multiply"),D=(d==null?void 0:d.linkColor)??"gradient";if(D==="gradient"){let m=N.append("linearGradient").attr("id",w=>(w.uid=mt.next("linearGradient-")).id).attr("gradientUnits","userSpaceOnUse").attr("x1",w=>w.source.x1).attr("x2",w=>w.target.x0);m.append("stop").attr("offset","0%").attr("stop-color",w=>P(w.source.id)),m.append("stop").attr("offset","100%").attr("stop-color",w=>P(w.target.id))}let $;switch(D){case"gradient":$=x(m=>m.uid,"coloring");break;case"source":$=x(m=>P(m.source.id),"coloring");break;case"target":$=x(m=>P(m.target.id),"coloring");break;default:$=D}N.append("path").attr("d",Ht()).attr("stroke",$).attr("stroke-width",m=>Math.max(1,m.width)),Lt(void 0,y,0,S)},"draw")},oe=x(t=>t.replaceAll(/^[^\S\n\r]+|[^\S\n\r]+$/g,"").replaceAll(/([\n\r])+/g,`
`).trim(),"prepareTextForParsing"),ae=x(t=>`.label {
      font-family: ${t.fontFamily};
    }`,"getStyles"),le=K.parse.bind(K);K.parse=t=>le(oe(t));var he={styles:ae,parser:K,db:ie,renderer:se};export{he as diagram};
