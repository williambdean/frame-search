import{u as Q}from"./src-D-O4qgKm.js";import{a as we,p as el,r as Be,u as U}from"./chunk-S3R3BYOJ-uZNU-Kd7.js";import{n as w,r as V}from"./src-Ci62OB0C.js";import{A as ut,I as Ge,L as pt,N as tl,O as yt,b as Z,d as al,h as Y,s as ll,y as Se}from"./chunk-ABZYJK2D-D-T6tPym.js";import{t as ft}from"./chunk-CVBHYZKI-SXlNTOC2.js";import{a as N,i as R,r as rl,t as Ae}from"./chunk-QYVHNE3D-B1-zbM-O.js";import{n as pe,r as Le}from"./chunk-JA3XYJ7Z-PWzZnWG4.js";function Ze(r,e,l){if(r&&r.length){let[n,a]=e,s=Math.PI/180*l,d=Math.cos(s),t=Math.sin(s);for(let o of r){let[i,h]=o;o[0]=(i-n)*d-(h-a)*t+n,o[1]=(i-n)*t+(h-a)*d+a}}}function sl(r,e){return r[0]===e[0]&&r[1]===e[1]}function il(r,e,l,n=1){let a=l,s=Math.max(e,.1),d=r[0]&&r[0][0]&&typeof r[0][0]=="number"?[r]:r,t=[0,0];if(a)for(let i of d)Ze(i,t,a);let o=(function(i,h,c){let g=[];for(let x of i){let b=[...x];sl(b[0],b[b.length-1])||b.push([b[0][0],b[0][1]]),b.length>2&&g.push(b)}let u=[];h=Math.max(h,.1);let p=[];for(let x of g)for(let b=0;b<x.length-1;b++){let k=x[b],S=x[b+1];if(k[1]!==S[1]){let M=Math.min(k[1],S[1]);p.push({ymin:M,ymax:Math.max(k[1],S[1]),x:M===k[1]?k[0]:S[0],islope:(S[0]-k[0])/(S[1]-k[1])})}}if(p.sort(((x,b)=>x.ymin<b.ymin?-1:x.ymin>b.ymin?1:x.x<b.x?-1:x.x>b.x?1:x.ymax===b.ymax?0:(x.ymax-b.ymax)/Math.abs(x.ymax-b.ymax))),!p.length)return u;let y=[],m=p[0].ymin,f=0;for(;y.length||p.length;){if(p.length){let x=-1;for(let b=0;b<p.length&&!(p[b].ymin>m);b++)x=b;p.splice(0,x+1).forEach((b=>{y.push({s:m,edge:b})}))}if(y=y.filter((x=>!(x.edge.ymax<=m))),y.sort(((x,b)=>x.edge.x===b.edge.x?0:(x.edge.x-b.edge.x)/Math.abs(x.edge.x-b.edge.x))),(c!==1||f%h==0)&&y.length>1)for(let x=0;x<y.length;x+=2){let b=x+1;if(b>=y.length)break;let k=y[x].edge,S=y[b].edge;u.push([[Math.round(k.x),m],[Math.round(S.x),m]])}m+=c,y.forEach((x=>{x.edge.x=x.edge.x+c*x.edge.islope})),f++}return u})(d,s,n);if(a){for(let i of d)Ze(i,t,-a);(function(i,h,c){let g=[];i.forEach((u=>g.push(...u))),Ze(g,h,c)})(o,t,-a)}return o}function ke(r,e){var s;let l=e.hachureAngle+90,n=e.hachureGap;n<0&&(n=4*e.strokeWidth),n=Math.round(Math.max(n,.1));let a=1;return e.roughness>=1&&(((s=e.randomizer)==null?void 0:s.next())||Math.random())>.7&&(a=n),il(r,n,l,a||1)}var Xe=class{constructor(r){this.helper=r}fillPolygons(r,e){return this._fillPolygons(r,e)}_fillPolygons(r,e){let l=ke(r,e);return{type:"fillSketch",ops:this.renderLines(l,e)}}renderLines(r,e){let l=[];for(let n of r)l.push(...this.helper.doubleLineOps(n[0][0],n[0][1],n[1][0],n[1][1],e));return l}};function Ne(r){let e=r[0],l=r[1];return Math.sqrt((e[0]-l[0])**2+(e[1]-l[1])**2)}var nl=class extends Xe{fillPolygons(r,e){let l=e.hachureGap;l<0&&(l=4*e.strokeWidth),l=Math.max(l,.1);let n=ke(r,Object.assign({},e,{hachureGap:l})),a=Math.PI/180*e.hachureAngle,s=[],d=.5*l*Math.cos(a),t=.5*l*Math.sin(a);for(let[o,i]of n)Ne([o,i])&&s.push([[o[0]-d,o[1]+t],[...i]],[[o[0]+d,o[1]-t],[...i]]);return{type:"fillSketch",ops:this.renderLines(s,e)}}},hl=class extends Xe{fillPolygons(r,e){let l=this._fillPolygons(r,e),n=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),a=this._fillPolygons(r,n);return l.ops=l.ops.concat(a.ops),l}},ol=class{constructor(r){this.helper=r}fillPolygons(r,e){let l=ke(r,e=Object.assign({},e,{hachureAngle:0}));return this.dotsOnLines(l,e)}dotsOnLines(r,e){let l=[],n=e.hachureGap;n<0&&(n=4*e.strokeWidth),n=Math.max(n,.1);let a=e.fillWeight;a<0&&(a=e.strokeWidth/2);let s=n/4;for(let d of r){let t=Ne(d),o=t/n,i=Math.ceil(o)-1,h=t-i*n,c=(d[0][0]+d[1][0])/2-n/4,g=Math.min(d[0][1],d[1][1]);for(let u=0;u<i;u++){let p=g+h+u*n,y=c-s+2*Math.random()*s,m=p-s+2*Math.random()*s,f=this.helper.ellipse(y,m,a,a,e);l.push(...f.ops)}}return{type:"fillSketch",ops:l}}},dl=class{constructor(r){this.helper=r}fillPolygons(r,e){let l=ke(r,e);return{type:"fillSketch",ops:this.dashedLine(l,e)}}dashedLine(r,e){let l=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,n=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,a=[];return r.forEach((s=>{let d=Ne(s),t=Math.floor(d/(l+n)),o=(d+n-t*(l+n))/2,i=s[0],h=s[1];i[0]>h[0]&&(i=s[1],h=s[0]);let c=Math.atan((h[1]-i[1])/(h[0]-i[0]));for(let g=0;g<t;g++){let u=g*(l+n),p=u+l,y=[i[0]+u*Math.cos(c)+o*Math.cos(c),i[1]+u*Math.sin(c)+o*Math.sin(c)],m=[i[0]+p*Math.cos(c)+o*Math.cos(c),i[1]+p*Math.sin(c)+o*Math.sin(c)];a.push(...this.helper.doubleLineOps(y[0],y[1],m[0],m[1],e))}})),a}},cl=class{constructor(r){this.helper=r}fillPolygons(r,e){let l=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,n=e.zigzagOffset<0?l:e.zigzagOffset,a=ke(r,e=Object.assign({},e,{hachureGap:l+n}));return{type:"fillSketch",ops:this.zigzagLines(a,n,e)}}zigzagLines(r,e,l){let n=[];return r.forEach((a=>{let s=Ne(a),d=Math.round(s/(2*e)),t=a[0],o=a[1];t[0]>o[0]&&(t=a[1],o=a[0]);let i=Math.atan((o[1]-t[1])/(o[0]-t[0]));for(let h=0;h<d;h++){let c=2*h*e,g=2*(h+1)*e,u=Math.sqrt(2*e**2),p=[t[0]+c*Math.cos(i),t[1]+c*Math.sin(i)],y=[t[0]+g*Math.cos(i),t[1]+g*Math.sin(i)],m=[p[0]+u*Math.cos(i+Math.PI/4),p[1]+u*Math.sin(i+Math.PI/4)];n.push(...this.helper.doubleLineOps(p[0],p[1],m[0],m[1],l),...this.helper.doubleLineOps(m[0],m[1],y[0],y[1],l))}})),n}},K={},gl=class{constructor(r){this.seed=r}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},ul=0,Qe=1,mt=2,Te={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Je(r,e){return r.type===e}function Ye(r){let e=[],l=(function(d){let t=[];for(;d!=="";)if(d.match(/^([ \t\r\n,]+)/))d=d.substr(RegExp.$1.length);else if(d.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:ul,text:RegExp.$1},d=d.substr(RegExp.$1.length);else{if(!d.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];t[t.length]={type:Qe,text:`${parseFloat(RegExp.$1)}`},d=d.substr(RegExp.$1.length)}return t[t.length]={type:mt,text:""},t})(r),n="BOD",a=0,s=l[a];for(;!Je(s,mt);){let d=0,t=[];if(n==="BOD"){if(s.text!=="M"&&s.text!=="m")return Ye("M0,0"+r);a++,d=Te[s.text],n=s.text}else Je(s,Qe)?d=Te[n]:(a++,d=Te[s.text],n=s.text);if(!(a+d<l.length))throw Error("Path data ended short");for(let o=a;o<a+d;o++){let i=l[o];if(!Je(i,Qe))throw Error("Param not a number: "+n+","+i.text);t[t.length]=+i.text}if(typeof Te[n]!="number")throw Error("Bad segment: "+n);{let o={key:n,data:t};e.push(o),a+=d,s=l[a],n==="M"&&(n="L"),n==="m"&&(n="l")}}return e}function xt(r){let e=0,l=0,n=0,a=0,s=[];for(let{key:d,data:t}of r)switch(d){case"M":s.push({key:"M",data:[...t]}),[e,l]=t,[n,a]=t;break;case"m":e+=t[0],l+=t[1],s.push({key:"M",data:[e,l]}),n=e,a=l;break;case"L":s.push({key:"L",data:[...t]}),[e,l]=t;break;case"l":e+=t[0],l+=t[1],s.push({key:"L",data:[e,l]});break;case"C":s.push({key:"C",data:[...t]}),e=t[4],l=t[5];break;case"c":{let o=t.map(((i,h)=>h%2?i+l:i+e));s.push({key:"C",data:o}),e=o[4],l=o[5];break}case"Q":s.push({key:"Q",data:[...t]}),e=t[2],l=t[3];break;case"q":{let o=t.map(((i,h)=>h%2?i+l:i+e));s.push({key:"Q",data:o}),e=o[2],l=o[3];break}case"A":s.push({key:"A",data:[...t]}),e=t[5],l=t[6];break;case"a":e+=t[5],l+=t[6],s.push({key:"A",data:[t[0],t[1],t[2],t[3],t[4],e,l]});break;case"H":s.push({key:"H",data:[...t]}),e=t[0];break;case"h":e+=t[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...t]}),l=t[0];break;case"v":l+=t[0],s.push({key:"V",data:[l]});break;case"S":s.push({key:"S",data:[...t]}),e=t[2],l=t[3];break;case"s":{let o=t.map(((i,h)=>h%2?i+l:i+e));s.push({key:"S",data:o}),e=o[2],l=o[3];break}case"T":s.push({key:"T",data:[...t]}),e=t[0],l=t[1];break;case"t":e+=t[0],l+=t[1],s.push({key:"T",data:[e,l]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=n,l=a}return s}function bt(r){let e=[],l="",n=0,a=0,s=0,d=0,t=0,o=0;for(let{key:i,data:h}of r){switch(i){case"M":e.push({key:"M",data:[...h]}),[n,a]=h,[s,d]=h;break;case"C":e.push({key:"C",data:[...h]}),n=h[4],a=h[5],t=h[2],o=h[3];break;case"L":e.push({key:"L",data:[...h]}),[n,a]=h;break;case"H":n=h[0],e.push({key:"L",data:[n,a]});break;case"V":a=h[0],e.push({key:"L",data:[n,a]});break;case"S":{let c=0,g=0;l==="C"||l==="S"?(c=n+(n-t),g=a+(a-o)):(c=n,g=a),e.push({key:"C",data:[c,g,...h]}),t=h[0],o=h[1],n=h[2],a=h[3];break}case"T":{let[c,g]=h,u=0,p=0;l==="Q"||l==="T"?(u=n+(n-t),p=a+(a-o)):(u=n,p=a);let y=n+2*(u-n)/3,m=a+2*(p-a)/3,f=c+2*(u-c)/3,x=g+2*(p-g)/3;e.push({key:"C",data:[y,m,f,x,c,g]}),t=u,o=p,n=c,a=g;break}case"Q":{let[c,g,u,p]=h,y=n+2*(c-n)/3,m=a+2*(g-a)/3,f=u+2*(c-u)/3,x=p+2*(g-p)/3;e.push({key:"C",data:[y,m,f,x,u,p]}),t=c,o=g,n=u,a=p;break}case"A":{let c=Math.abs(h[0]),g=Math.abs(h[1]),u=h[2],p=h[3],y=h[4],m=h[5],f=h[6];c===0||g===0?(e.push({key:"C",data:[n,a,m,f,m,f]}),n=m,a=f):(n!==m||a!==f)&&(wt(n,a,m,f,c,g,u,p,y).forEach((function(x){e.push({key:"C",data:x})})),n=m,a=f);break}case"Z":e.push({key:"Z",data:[]}),n=s,a=d}l=i}return e}function $e(r,e,l){return[r*Math.cos(l)-e*Math.sin(l),r*Math.sin(l)+e*Math.cos(l)]}function wt(r,e,l,n,a,s,d,t,o,i){let h=(c=d,Math.PI*c/180);var c;let g=[],u=0,p=0,y=0,m=0;if(i)[u,p,y,m]=i;else{[r,e]=$e(r,e,-h),[l,n]=$e(l,n,-h);let v=(r-l)/2,$=(e-n)/2,D=v*v/(a*a)+$*$/(s*s);D>1&&(D=Math.sqrt(D),a*=D,s*=D);let O=a*a,W=s*s,X=O*W-O*$*$-W*v*v,te=O*$*$+W*v*v,he=(t===o?-1:1)*Math.sqrt(Math.abs(X/te));y=he*a*$/s+(r+l)/2,m=he*-s*v/a+(e+n)/2,u=Math.asin(parseFloat(((e-m)/s).toFixed(9))),p=Math.asin(parseFloat(((n-m)/s).toFixed(9))),r<y&&(u=Math.PI-u),l<y&&(p=Math.PI-p),u<0&&(u=2*Math.PI+u),p<0&&(p=2*Math.PI+p),o&&u>p&&(u-=2*Math.PI),!o&&p>u&&(p-=2*Math.PI)}let f=p-u;if(Math.abs(f)>120*Math.PI/180){let v=p,$=l,D=n;p=o&&p>u?u+120*Math.PI/180*1:u+120*Math.PI/180*-1,g=wt(l=y+a*Math.cos(p),n=m+s*Math.sin(p),$,D,a,s,d,0,o,[p,v,y,m])}f=p-u;let x=Math.cos(u),b=Math.sin(u),k=Math.cos(p),S=Math.sin(p),M=Math.tan(f/4),C=4/3*a*M,P=4/3*s*M,_=[r,e],E=[r+C*b,e-P*x],I=[l+C*S,n-P*k],L=[l,n];if(E[0]=2*_[0]-E[0],E[1]=2*_[1]-E[1],i)return[E,I,L].concat(g);{g=[E,I,L].concat(g);let v=[];for(let $=0;$<g.length;$+=3){let D=$e(g[$][0],g[$][1],h),O=$e(g[$+1][0],g[$+1][1],h),W=$e(g[$+2][0],g[$+2][1],h);v.push([D[0],D[1],O[0],O[1],W[0],W[1]])}return v}}var pl={randOffset:function(r,e){return H(r,e)},randOffsetWithRange:function(r,e,l){return _e(r,e,l)},ellipse:function(r,e,l,n,a){return Ue(r,e,a,$t(l,n,a)).opset},doubleLineOps:function(r,e,l,n,a){return de(r,e,l,n,a,!0)}};function St(r,e,l,n,a){return{type:"path",ops:de(r,e,l,n,a)}}function Re(r,e,l){let n=(r||[]).length;if(n>2){let a=[];for(let s=0;s<n-1;s++)a.push(...de(r[s][0],r[s][1],r[s+1][0],r[s+1][1],l));return e&&a.push(...de(r[n-1][0],r[n-1][1],r[0][0],r[0][1],l)),{type:"path",ops:a}}return n===2?St(r[0][0],r[0][1],r[1][0],r[1][1],l):{type:"path",ops:[]}}function yl(r,e,l,n,a){return(function(s,d){return Re(s,!0,d)})([[r,e],[r+l,e],[r+l,e+n],[r,e+n]],a)}function kt(r,e){if(r.length){let l=typeof r[0][0]=="number"?[r]:r,n=Oe(l[0],1*(1+.2*e.roughness),e),a=e.disableMultiStroke?[]:Oe(l[0],1.5*(1+.22*e.roughness),Dt(e));for(let s=1;s<l.length;s++){let d=l[s];if(d.length){let t=Oe(d,1*(1+.2*e.roughness),e),o=e.disableMultiStroke?[]:Oe(d,1.5*(1+.22*e.roughness),Dt(e));for(let i of t)i.op!=="move"&&n.push(i);for(let i of o)i.op!=="move"&&a.push(i)}}return{type:"path",ops:n.concat(a)}}return{type:"path",ops:[]}}function $t(r,e,l){let n=Math.sqrt(2*Math.PI*Math.sqrt(((r/2)**2+(e/2)**2)/2)),a=Math.ceil(Math.max(l.curveStepCount,l.curveStepCount/Math.sqrt(200)*n)),s=2*Math.PI/a,d=Math.abs(r/2),t=Math.abs(e/2),o=1-l.curveFitting;return d+=H(d*o,l),t+=H(t*o,l),{increment:s,rx:d,ry:t}}function Ue(r,e,l,n){let[a,s]=Pt(n.increment,r,e,n.rx,n.ry,1,n.increment*_e(.1,_e(.4,1,l),l),l),d=Ie(a,null,l);if(!l.disableMultiStroke&&l.roughness!==0){let[t]=Pt(n.increment,r,e,n.rx,n.ry,1.5,0,l),o=Ie(t,null,l);d=d.concat(o)}return{estimatedPoints:s,opset:{type:"path",ops:d}}}function Mt(r,e,l,n,a,s,d,t,o){let i=r,h=e,c=Math.abs(l/2),g=Math.abs(n/2);c+=H(.01*c,o),g+=H(.01*g,o);let u=a,p=s;for(;u<0;)u+=2*Math.PI,p+=2*Math.PI;p-u>2*Math.PI&&(u=0,p=2*Math.PI);let y=2*Math.PI/o.curveStepCount,m=Math.min(y/2,(p-u)/2),f=Bt(m,i,h,c,g,u,p,1,o);if(!o.disableMultiStroke){let x=Bt(m,i,h,c,g,u,p,1.5,o);f.push(...x)}return d&&(t?f.push(...de(i,h,i+c*Math.cos(u),h+g*Math.sin(u),o),...de(i,h,i+c*Math.cos(p),h+g*Math.sin(p),o)):f.push({op:"lineTo",data:[i,h]},{op:"lineTo",data:[i+c*Math.cos(u),h+g*Math.sin(u)]})),{type:"path",ops:f}}function vt(r,e){let l=bt(xt(Ye(r))),n=[],a=[0,0],s=[0,0];for(let{key:d,data:t}of l)switch(d){case"M":s=[t[0],t[1]],a=[t[0],t[1]];break;case"L":n.push(...de(s[0],s[1],t[0],t[1],e)),s=[t[0],t[1]];break;case"C":{let[o,i,h,c,g,u]=t;n.push(...fl(o,i,h,c,g,u,s,e)),s=[g,u];break}case"Z":n.push(...de(s[0],s[1],a[0],a[1],e)),s=[a[0],a[1]]}return{type:"path",ops:n}}function Ke(r,e){let l=[];for(let n of r)if(n.length){let a=e.maxRandomnessOffset||0,s=n.length;if(s>2){l.push({op:"move",data:[n[0][0]+H(a,e),n[0][1]+H(a,e)]});for(let d=1;d<s;d++)l.push({op:"lineTo",data:[n[d][0]+H(a,e),n[d][1]+H(a,e)]})}}return{type:"fillPath",ops:l}}function fe(r,e){return(function(l,n){let a=l.fillStyle||"hachure";if(!K[a])switch(a){case"zigzag":K[a]||(K[a]=new nl(n));break;case"cross-hatch":K[a]||(K[a]=new hl(n));break;case"dots":K[a]||(K[a]=new ol(n));break;case"dashed":K[a]||(K[a]=new dl(n));break;case"zigzag-line":K[a]||(K[a]=new cl(n));break;default:a="hachure",K[a]||(K[a]=new Xe(n))}return K[a]})(e,pl).fillPolygons(r,e)}function Dt(r){let e=Object.assign({},r);return e.randomizer=void 0,r.seed&&(e.seed=r.seed+1),e}function Ct(r){return r.randomizer||(r.randomizer=new gl(r.seed||0)),r.randomizer.next()}function _e(r,e,l,n=1){return l.roughness*n*(Ct(l)*(e-r)+r)}function H(r,e,l=1){return _e(-r,r,e,l)}function de(r,e,l,n,a,s=!1){let d=s?a.disableMultiStrokeFill:a.disableMultiStroke,t=et(r,e,l,n,a,!0,!1);if(d)return t;let o=et(r,e,l,n,a,!0,!0);return t.concat(o)}function et(r,e,l,n,a,s,d){let t=(r-l)**2+(e-n)**2,o=Math.sqrt(t),i=1;i=o<200?1:o>500?.4:-.0016668*o+1.233334;let h=a.maxRandomnessOffset||0;h*h*100>t&&(h=o/10);let c=h/2,g=.2+.2*Ct(a),u=a.bowing*a.maxRandomnessOffset*(n-e)/200,p=a.bowing*a.maxRandomnessOffset*(r-l)/200;u=H(u,a,i),p=H(p,a,i);let y=[],m=()=>H(c,a,i),f=()=>H(h,a,i),x=a.preserveVertices;return s&&(d?y.push({op:"move",data:[r+(x?0:m()),e+(x?0:m())]}):y.push({op:"move",data:[r+(x?0:H(h,a,i)),e+(x?0:H(h,a,i))]})),d?y.push({op:"bcurveTo",data:[u+r+(l-r)*g+m(),p+e+(n-e)*g+m(),u+r+2*(l-r)*g+m(),p+e+2*(n-e)*g+m(),l+(x?0:m()),n+(x?0:m())]}):y.push({op:"bcurveTo",data:[u+r+(l-r)*g+f(),p+e+(n-e)*g+f(),u+r+2*(l-r)*g+f(),p+e+2*(n-e)*g+f(),l+(x?0:f()),n+(x?0:f())]}),y}function Oe(r,e,l){if(!r.length)return[];let n=[];n.push([r[0][0]+H(e,l),r[0][1]+H(e,l)]),n.push([r[0][0]+H(e,l),r[0][1]+H(e,l)]);for(let a=1;a<r.length;a++)n.push([r[a][0]+H(e,l),r[a][1]+H(e,l)]),a===r.length-1&&n.push([r[a][0]+H(e,l),r[a][1]+H(e,l)]);return Ie(n,null,l)}function Ie(r,e,l){let n=r.length,a=[];if(n>3){let s=[],d=1-l.curveTightness;a.push({op:"move",data:[r[1][0],r[1][1]]});for(let t=1;t+2<n;t++){let o=r[t];s[0]=[o[0],o[1]],s[1]=[o[0]+(d*r[t+1][0]-d*r[t-1][0])/6,o[1]+(d*r[t+1][1]-d*r[t-1][1])/6],s[2]=[r[t+1][0]+(d*r[t][0]-d*r[t+2][0])/6,r[t+1][1]+(d*r[t][1]-d*r[t+2][1])/6],s[3]=[r[t+1][0],r[t+1][1]],a.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}if(e&&e.length===2){let t=l.maxRandomnessOffset;a.push({op:"lineTo",data:[e[0]+H(t,l),e[1]+H(t,l)]})}}else n===3?(a.push({op:"move",data:[r[1][0],r[1][1]]}),a.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[2][0],r[2][1]]})):n===2&&a.push(...et(r[0][0],r[0][1],r[1][0],r[1][1],l,!0,!0));return a}function Pt(r,e,l,n,a,s,d,t){let o=[],i=[];if(t.roughness===0){r/=4,i.push([e+n*Math.cos(-r),l+a*Math.sin(-r)]);for(let h=0;h<=2*Math.PI;h+=r){let c=[e+n*Math.cos(h),l+a*Math.sin(h)];o.push(c),i.push(c)}i.push([e+n*Math.cos(0),l+a*Math.sin(0)]),i.push([e+n*Math.cos(r),l+a*Math.sin(r)])}else{let h=H(.5,t)-Math.PI/2;i.push([H(s,t)+e+.9*n*Math.cos(h-r),H(s,t)+l+.9*a*Math.sin(h-r)]);let c=2*Math.PI+h-.01;for(let g=h;g<c;g+=r){let u=[H(s,t)+e+n*Math.cos(g),H(s,t)+l+a*Math.sin(g)];o.push(u),i.push(u)}i.push([H(s,t)+e+n*Math.cos(h+2*Math.PI+.5*d),H(s,t)+l+a*Math.sin(h+2*Math.PI+.5*d)]),i.push([H(s,t)+e+.98*n*Math.cos(h+d),H(s,t)+l+.98*a*Math.sin(h+d)]),i.push([H(s,t)+e+.9*n*Math.cos(h+.5*d),H(s,t)+l+.9*a*Math.sin(h+.5*d)])}return[i,o]}function Bt(r,e,l,n,a,s,d,t,o){let i=s+H(.1,o),h=[];h.push([H(t,o)+e+.9*n*Math.cos(i-r),H(t,o)+l+.9*a*Math.sin(i-r)]);for(let c=i;c<=d;c+=r)h.push([H(t,o)+e+n*Math.cos(c),H(t,o)+l+a*Math.sin(c)]);return h.push([e+n*Math.cos(d),l+a*Math.sin(d)]),h.push([e+n*Math.cos(d),l+a*Math.sin(d)]),Ie(h,null,o)}function fl(r,e,l,n,a,s,d,t){let o=[],i=[t.maxRandomnessOffset||1,(t.maxRandomnessOffset||1)+.3],h=[0,0],c=t.disableMultiStroke?1:2,g=t.preserveVertices;for(let u=0;u<c;u++)u===0?o.push({op:"move",data:[d[0],d[1]]}):o.push({op:"move",data:[d[0]+(g?0:H(i[0],t)),d[1]+(g?0:H(i[0],t))]}),h=g?[a,s]:[a+H(i[u],t),s+H(i[u],t)],o.push({op:"bcurveTo",data:[r+H(i[u],t),e+H(i[u],t),l+H(i[u],t),n+H(i[u],t),h[0],h[1]]});return o}function Me(r){return[...r]}function At(r,e=0){let l=r.length;if(l<3)throw Error("A curve must have at least three points.");let n=[];if(l===3)n.push(Me(r[0]),Me(r[1]),Me(r[2]),Me(r[2]));else{let a=[];a.push(r[0],r[0]);for(let t=1;t<r.length;t++)a.push(r[t]),t===r.length-1&&a.push(r[t]);let s=[],d=1-e;n.push(Me(a[0]));for(let t=1;t+2<a.length;t++){let o=a[t];s[0]=[o[0],o[1]],s[1]=[o[0]+(d*a[t+1][0]-d*a[t-1][0])/6,o[1]+(d*a[t+1][1]-d*a[t-1][1])/6],s[2]=[a[t+1][0]+(d*a[t][0]-d*a[t+2][0])/6,a[t+1][1]+(d*a[t][1]-d*a[t+2][1])/6],s[3]=[a[t+1][0],a[t+1][1]],n.push(s[1],s[2],s[3])}}return n}function Ee(r,e){return(r[0]-e[0])**2+(r[1]-e[1])**2}function ml(r,e,l){let n=Ee(e,l);if(n===0)return Ee(r,e);let a=((r[0]-e[0])*(l[0]-e[0])+(r[1]-e[1])*(l[1]-e[1]))/n;return a=Math.max(0,Math.min(1,a)),Ee(r,ye(e,l,a))}function ye(r,e,l){return[r[0]+(e[0]-r[0])*l,r[1]+(e[1]-r[1])*l]}function tt(r,e,l,n){let a=n||[];if((function(t,o){let i=t[o+0],h=t[o+1],c=t[o+2],g=t[o+3],u=3*h[0]-2*i[0]-g[0];u*=u;let p=3*h[1]-2*i[1]-g[1];p*=p;let y=3*c[0]-2*g[0]-i[0];y*=y;let m=3*c[1]-2*g[1]-i[1];return m*=m,u<y&&(u=y),p<m&&(p=m),u+p})(r,e)<l){let t=r[e+0];a.length?(s=a[a.length-1],d=t,Math.sqrt(Ee(s,d))>1&&a.push(t)):a.push(t),a.push(r[e+3])}else{let t=.5,o=r[e+0],i=r[e+1],h=r[e+2],c=r[e+3],g=ye(o,i,t),u=ye(i,h,t),p=ye(h,c,t),y=ye(g,u,t),m=ye(u,p,t),f=ye(y,m,t);tt([o,g,y,f],0,l,a),tt([f,m,p,c],0,l,a)}var s,d;return a}function xl(r,e){return We(r,0,r.length,e)}function We(r,e,l,n,a){let s=a||[],d=r[e],t=r[l-1],o=0,i=1;for(let h=e+1;h<l-1;++h){let c=ml(r[h],d,t);c>o&&(o=c,i=h)}return Math.sqrt(o)>n?(We(r,e,i+1,n,s),We(r,i,l,n,s)):(s.length||s.push(d),s.push(t)),s}function at(r,e=.15,l){let n=[],a=(r.length-1)/3;for(let s=0;s<a;s++)tt(r,3*s,e,n);return l&&l>0?We(n,0,n.length,l):n}var ee="none",je=class{constructor(r){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=r||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(r){return r?Object.assign({},this.defaultOptions,r):this.defaultOptions}_d(r,e,l){return{shape:r,sets:e||[],options:l||this.defaultOptions}}line(r,e,l,n,a){let s=this._o(a);return this._d("line",[St(r,e,l,n,s)],s)}rectangle(r,e,l,n,a){let s=this._o(a),d=[],t=yl(r,e,l,n,s);if(s.fill){let o=[[r,e],[r+l,e],[r+l,e+n],[r,e+n]];s.fillStyle==="solid"?d.push(Ke([o],s)):d.push(fe([o],s))}return s.stroke!==ee&&d.push(t),this._d("rectangle",d,s)}ellipse(r,e,l,n,a){let s=this._o(a),d=[],t=$t(l,n,s),o=Ue(r,e,s,t);if(s.fill)if(s.fillStyle==="solid"){let i=Ue(r,e,s,t).opset;i.type="fillPath",d.push(i)}else d.push(fe([o.estimatedPoints],s));return s.stroke!==ee&&d.push(o.opset),this._d("ellipse",d,s)}circle(r,e,l,n){let a=this.ellipse(r,e,l,l,n);return a.shape="circle",a}linearPath(r,e){let l=this._o(e);return this._d("linearPath",[Re(r,!1,l)],l)}arc(r,e,l,n,a,s,d=!1,t){let o=this._o(t),i=[],h=Mt(r,e,l,n,a,s,d,!0,o);if(d&&o.fill)if(o.fillStyle==="solid"){let c=Object.assign({},o);c.disableMultiStroke=!0;let g=Mt(r,e,l,n,a,s,!0,!1,c);g.type="fillPath",i.push(g)}else i.push((function(c,g,u,p,y,m,f){let x=c,b=g,k=Math.abs(u/2),S=Math.abs(p/2);k+=H(.01*k,f),S+=H(.01*S,f);let M=y,C=m;for(;M<0;)M+=2*Math.PI,C+=2*Math.PI;C-M>2*Math.PI&&(M=0,C=2*Math.PI);let P=(C-M)/f.curveStepCount,_=[];for(let E=M;E<=C;E+=P)_.push([x+k*Math.cos(E),b+S*Math.sin(E)]);return _.push([x+k*Math.cos(C),b+S*Math.sin(C)]),_.push([x,b]),fe([_],f)})(r,e,l,n,a,s,o));return o.stroke!==ee&&i.push(h),this._d("arc",i,o)}curve(r,e){let l=this._o(e),n=[],a=kt(r,l);if(l.fill&&l.fill!==ee)if(l.fillStyle==="solid"){let s=kt(r,Object.assign(Object.assign({},l),{disableMultiStroke:!0,roughness:l.roughness?l.roughness+l.fillShapeRoughnessGain:0}));n.push({type:"fillPath",ops:this._mergedShape(s.ops)})}else{let s=[],d=r;if(d.length){let t=typeof d[0][0]=="number"?[d]:d;for(let o of t)o.length<3?s.push(...o):o.length===3?s.push(...at(At([o[0],o[0],o[1],o[2]]),10,(1+l.roughness)/2)):s.push(...at(At(o),10,(1+l.roughness)/2))}s.length&&n.push(fe([s],l))}return l.stroke!==ee&&n.push(a),this._d("curve",n,l)}polygon(r,e){let l=this._o(e),n=[],a=Re(r,!0,l);return l.fill&&(l.fillStyle==="solid"?n.push(Ke([r],l)):n.push(fe([r],l))),l.stroke!==ee&&n.push(a),this._d("polygon",n,l)}path(r,e){let l=this._o(e),n=[];if(!r)return this._d("path",n,l);r=(r||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let a=l.fill&&l.fill!=="transparent"&&l.fill!==ee,s=l.stroke!==ee,d=!!(l.simplification&&l.simplification<1),t=(function(i,h,c){let g=bt(xt(Ye(i))),u=[],p=[],y=[0,0],m=[],f=()=>{m.length>=4&&p.push(...at(m,h)),m=[]},x=()=>{f(),p.length&&(u.push(p),p=[])};for(let{key:k,data:S}of g)switch(k){case"M":x(),y=[S[0],S[1]],p.push(y);break;case"L":f(),p.push([S[0],S[1]]);break;case"C":if(!m.length){let M=p.length?p[p.length-1]:y;m.push([M[0],M[1]])}m.push([S[0],S[1]]),m.push([S[2],S[3]]),m.push([S[4],S[5]]);break;case"Z":f(),p.push([y[0],y[1]])}if(x(),!c)return u;let b=[];for(let k of u){let S=xl(k,c);S.length&&b.push(S)}return b})(r,1,d?4-4*(l.simplification||1):(1+l.roughness)/2),o=vt(r,l);if(a)if(l.fillStyle==="solid")if(t.length===1){let i=vt(r,Object.assign(Object.assign({},l),{disableMultiStroke:!0,roughness:l.roughness?l.roughness+l.fillShapeRoughnessGain:0}));n.push({type:"fillPath",ops:this._mergedShape(i.ops)})}else n.push(Ke(t,l));else n.push(fe(t,l));return s&&(d?t.forEach((i=>{n.push(Re(i,!1,l))})):n.push(o)),this._d("path",n,l)}opsToPath(r,e){let l="";for(let n of r.ops){let a=typeof e=="number"&&e>=0?n.data.map((s=>+s.toFixed(e))):n.data;switch(n.op){case"move":l+=`M${a[0]} ${a[1]} `;break;case"bcurveTo":l+=`C${a[0]} ${a[1]}, ${a[2]} ${a[3]}, ${a[4]} ${a[5]} `;break;case"lineTo":l+=`L${a[0]} ${a[1]} `}}return l.trim()}toPaths(r){let e=r.sets||[],l=r.options||this.defaultOptions,n=[];for(let a of e){let s=null;switch(a.type){case"path":s={d:this.opsToPath(a),stroke:l.stroke,strokeWidth:l.strokeWidth,fill:ee};break;case"fillPath":s={d:this.opsToPath(a),stroke:ee,strokeWidth:0,fill:l.fill||ee};break;case"fillSketch":s=this.fillSketch(a,l)}s&&n.push(s)}return n}fillSketch(r,e){let l=e.fillWeight;return l<0&&(l=e.strokeWidth/2),{d:this.opsToPath(r),stroke:e.fill||ee,strokeWidth:l,fill:ee}}_mergedShape(r){return r.filter(((e,l)=>l===0||e.op!=="move"))}},bl=class{constructor(r,e){this.canvas=r,this.ctx=this.canvas.getContext("2d"),this.gen=new je(e)}draw(r){let e=r.sets||[],l=r.options||this.getDefaultOptions(),n=this.ctx,a=r.options.fixedDecimalPlaceDigits;for(let s of e)switch(s.type){case"path":n.save(),n.strokeStyle=l.stroke==="none"?"transparent":l.stroke,n.lineWidth=l.strokeWidth,l.strokeLineDash&&n.setLineDash(l.strokeLineDash),l.strokeLineDashOffset&&(n.lineDashOffset=l.strokeLineDashOffset),this._drawToContext(n,s,a),n.restore();break;case"fillPath":{n.save(),n.fillStyle=l.fill||"";let d=r.shape==="curve"||r.shape==="polygon"||r.shape==="path"?"evenodd":"nonzero";this._drawToContext(n,s,a,d),n.restore();break}case"fillSketch":this.fillSketch(n,s,l)}}fillSketch(r,e,l){let n=l.fillWeight;n<0&&(n=l.strokeWidth/2),r.save(),l.fillLineDash&&r.setLineDash(l.fillLineDash),l.fillLineDashOffset&&(r.lineDashOffset=l.fillLineDashOffset),r.strokeStyle=l.fill||"",r.lineWidth=n,this._drawToContext(r,e,l.fixedDecimalPlaceDigits),r.restore()}_drawToContext(r,e,l,n="nonzero"){r.beginPath();for(let a of e.ops){let s=typeof l=="number"&&l>=0?a.data.map((d=>+d.toFixed(l))):a.data;switch(a.op){case"move":r.moveTo(s[0],s[1]);break;case"bcurveTo":r.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"lineTo":r.lineTo(s[0],s[1])}}e.type==="fillPath"?r.fill(n):r.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(r,e,l,n,a){let s=this.gen.line(r,e,l,n,a);return this.draw(s),s}rectangle(r,e,l,n,a){let s=this.gen.rectangle(r,e,l,n,a);return this.draw(s),s}ellipse(r,e,l,n,a){let s=this.gen.ellipse(r,e,l,n,a);return this.draw(s),s}circle(r,e,l,n){let a=this.gen.circle(r,e,l,n);return this.draw(a),a}linearPath(r,e){let l=this.gen.linearPath(r,e);return this.draw(l),l}polygon(r,e){let l=this.gen.polygon(r,e);return this.draw(l),l}arc(r,e,l,n,a,s,d=!1,t){let o=this.gen.arc(r,e,l,n,a,s,d,t);return this.draw(o),o}curve(r,e){let l=this.gen.curve(r,e);return this.draw(l),l}path(r,e){let l=this.gen.path(r,e);return this.draw(l),l}},He="http://www.w3.org/2000/svg",wl=class{constructor(r,e){this.svg=r,this.gen=new je(e)}draw(r){let e=r.sets||[],l=r.options||this.getDefaultOptions(),n=this.svg.ownerDocument||window.document,a=n.createElementNS(He,"g"),s=r.options.fixedDecimalPlaceDigits;for(let d of e){let t=null;switch(d.type){case"path":t=n.createElementNS(He,"path"),t.setAttribute("d",this.opsToPath(d,s)),t.setAttribute("stroke",l.stroke),t.setAttribute("stroke-width",l.strokeWidth+""),t.setAttribute("fill","none"),l.strokeLineDash&&t.setAttribute("stroke-dasharray",l.strokeLineDash.join(" ").trim()),l.strokeLineDashOffset&&t.setAttribute("stroke-dashoffset",`${l.strokeLineDashOffset}`);break;case"fillPath":t=n.createElementNS(He,"path"),t.setAttribute("d",this.opsToPath(d,s)),t.setAttribute("stroke","none"),t.setAttribute("stroke-width","0"),t.setAttribute("fill",l.fill||""),r.shape!=="curve"&&r.shape!=="polygon"||t.setAttribute("fill-rule","evenodd");break;case"fillSketch":t=this.fillSketch(n,d,l)}t&&a.appendChild(t)}return a}fillSketch(r,e,l){let n=l.fillWeight;n<0&&(n=l.strokeWidth/2);let a=r.createElementNS(He,"path");return a.setAttribute("d",this.opsToPath(e,l.fixedDecimalPlaceDigits)),a.setAttribute("stroke",l.fill||""),a.setAttribute("stroke-width",n+""),a.setAttribute("fill","none"),l.fillLineDash&&a.setAttribute("stroke-dasharray",l.fillLineDash.join(" ").trim()),l.fillLineDashOffset&&a.setAttribute("stroke-dashoffset",`${l.fillLineDashOffset}`),a}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(r,e){return this.gen.opsToPath(r,e)}line(r,e,l,n,a){let s=this.gen.line(r,e,l,n,a);return this.draw(s)}rectangle(r,e,l,n,a){let s=this.gen.rectangle(r,e,l,n,a);return this.draw(s)}ellipse(r,e,l,n,a){let s=this.gen.ellipse(r,e,l,n,a);return this.draw(s)}circle(r,e,l,n){let a=this.gen.circle(r,e,l,n);return this.draw(a)}linearPath(r,e){let l=this.gen.linearPath(r,e);return this.draw(l)}polygon(r,e){let l=this.gen.polygon(r,e);return this.draw(l)}arc(r,e,l,n,a,s,d=!1,t){let o=this.gen.arc(r,e,l,n,a,s,d,t);return this.draw(o)}curve(r,e){let l=this.gen.curve(r,e);return this.draw(l)}path(r,e){let l=this.gen.path(r,e);return this.draw(l)}},A={canvas:(r,e)=>new bl(r,e),svg:(r,e)=>new wl(r,e),generator:r=>new je(r),newSeed:()=>je.newSeed()},z=w(async(r,e,l)=>{var c,g;let n,a=e.useHtmlLabels||Y((c=Z())==null?void 0:c.htmlLabels);n=l||"node default";let s=r.insert("g").attr("class",n).attr("id",e.domId||e.id),d=s.insert("g").attr("class","label").attr("style",U(e.labelStyle)),t;t=e.label===void 0?"":typeof e.label=="string"?e.label:e.label[0];let o=await pe(d,Ge(we(t),Z()),{useHtmlLabels:a,width:e.width||((g=Z().flowchart)==null?void 0:g.wrappingWidth),cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img}),i=o.getBBox(),h=((e==null?void 0:e.padding)??0)/2;if(a){let u=o.children[0],p=Q(o),y=u.getElementsByTagName("img");if(y){let m=t.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...y].map(f=>new Promise(x=>{function b(){if(f.style.display="flex",f.style.flexDirection="column",m){let[k=al.fontSize]=el(Z().fontSize?Z().fontSize:window.getComputedStyle(document.body).fontSize),S=k*5+"px";f.style.minWidth=S,f.style.maxWidth=S}else f.style.width="100%";x(f)}w(b,"setupImage"),setTimeout(()=>{f.complete&&b()}),f.addEventListener("error",b),f.addEventListener("load",b)})))}i=u.getBoundingClientRect(),p.attr("width",i.width),p.attr("height",i.height)}return a?d.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"):d.attr("transform","translate(0, "+-i.height/2+")"),e.centerLabel&&d.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"),d.insert("rect",":first-child"),{shapeSvg:s,bbox:i,halfPadding:h,label:d}},"labelHelper"),lt=w(async(r,e,l)=>{var o,i,h,c,g,u;let n=l.useHtmlLabels||Y((i=(o=Z())==null?void 0:o.flowchart)==null?void 0:i.htmlLabels),a=r.insert("g").attr("class","label").attr("style",l.labelStyle||""),s=await pe(a,Ge(we(e),Z()),{useHtmlLabels:n,width:l.width||((c=(h=Z())==null?void 0:h.flowchart)==null?void 0:c.wrappingWidth),style:l.labelStyle,addSvgBackground:!!l.icon||!!l.img}),d=s.getBBox(),t=l.padding/2;if(Y((u=(g=Z())==null?void 0:g.flowchart)==null?void 0:u.htmlLabels)){let p=s.children[0],y=Q(s);d=p.getBoundingClientRect(),y.attr("width",d.width),y.attr("height",d.height)}return n?a.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"):a.attr("transform","translate(0, "+-d.height/2+")"),l.centerLabel&&a.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:r,bbox:d,halfPadding:t,label:a}},"insertLabel"),T=w((r,e)=>{let l=e.node().getBBox();r.width=l.width,r.height=l.height},"updateNodeBounds"),j=w((r,e)=>(r.look==="handDrawn"?"rough-node":"node")+" "+r.cssClasses+" "+(e||""),"getNodeClasses");function q(r){let e=r.map((l,n)=>`${n===0?"M":"L"}${l.x},${l.y}`);return e.push("Z"),e.join(" ")}w(q,"createPathFromPoints");function ce(r,e,l,n,a,s){let d=[],t=l-r,o=n-e,i=t/s,h=2*Math.PI/i,c=e+o/2;for(let g=0;g<=50;g++){let u=r+g/50*t,p=c+a*Math.sin(h*(u-r));d.push({x:u,y:p})}return d}w(ce,"generateFullSineWavePoints");function ve(r,e,l,n,a,s){let d=[],t=a*Math.PI/180,o=(s*Math.PI/180-t)/(n-1);for(let i=0;i<n;i++){let h=t+i*o,c=r+l*Math.cos(h),g=e+l*Math.sin(h);d.push({x:-c,y:-g})}return d}w(ve,"generateCirclePoints");var me=w((r,e)=>{var l=r.x,n=r.y,a=e.x-l,s=e.y-n,d=r.width/2,t=r.height/2,o,i;return Math.abs(s)*d>Math.abs(a)*t?(s<0&&(t=-t),o=s===0?0:t*a/s,i=t):(a<0&&(d=-d),o=d,i=a===0?0:d*s/a),{x:l+o,y:n+i}},"intersectRect");function Lt(r,e){e&&r.attr("style",e)}w(Lt,"applyStyle");async function Nt(r){let e=Q(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),l=e.append("xhtml:div"),n=Z(),a=r.label;r.label&&yt(r.label)&&(a=await tl(r.label.replace(ll.lineBreakRegex,`
`),n));let s='<span class="'+(r.isNode?"nodeLabel":"edgeLabel")+'" '+(r.labelStyle?'style="'+r.labelStyle+'"':"")+">"+a+"</span>";return l.html(Ge(s,n)),Lt(l,r.labelStyle),l.style("display","inline-block"),l.style("padding-right","1px"),l.style("white-space","nowrap"),l.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}w(Nt,"addHtmlLabel");var ze=w(async(r,e,l,n)=>{let a=r||"";if(typeof a=="object"&&(a=a[0]),Y(Z().flowchart.htmlLabels))return a=a.replace(/\\n|\n/g,"<br />"),V.info("vertexText"+a),await Nt({isNode:n,label:we(a).replace(/fa[blrs]?:fa-[\w-]+/g,s=>`<i class='${s.replace(":"," ")}'></i>`),labelStyle:e&&e.replace("fill:","color:")});{let s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("style",e.replace("color:","fill:"));let d=[];d=typeof a=="string"?a.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(a)?a:[];for(let t of d){let o=document.createElementNS("http://www.w3.org/2000/svg","tspan");o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),o.setAttribute("dy","1em"),o.setAttribute("x","0"),l?o.setAttribute("class","title-row"):o.setAttribute("class","row"),o.textContent=t.trim(),s.appendChild(o)}return s}},"createLabel"),ge=w((r,e,l,n,a)=>["M",r+a,e,"H",r+l-a,"A",a,a,0,0,1,r+l,e+a,"V",e+n-a,"A",a,a,0,0,1,r+l-a,e+n,"H",r+a,"A",a,a,0,0,1,r,e+n-a,"V",e+a,"A",a,a,0,0,1,r+a,e,"Z"].join(" "),"createRoundedRectPathD"),Tt=w(async(r,e)=>{V.info("Creating subgraph rect for ",e.id,e);let l=Z(),{themeVariables:n,handDrawnSeed:a}=l,{clusterBkg:s,clusterBorder:d}=n,{labelStyles:t,nodeStyles:o,borderStyles:i,backgroundStyles:h}=R(e),c=r.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),g=Y(l.flowchart.htmlLabels),u=c.insert("g").attr("class","cluster-label "),p=await pe(u,e.label,{style:e.labelStyle,useHtmlLabels:g,isNode:!0}),y=p.getBBox();if(Y(l.flowchart.htmlLabels)){let C=p.children[0],P=Q(p);y=C.getBoundingClientRect(),P.attr("width",y.width),P.attr("height",y.height)}let m=e.width<=y.width+e.padding?y.width+e.padding:e.width;e.width<=y.width+e.padding?e.diff=(m-e.width)/2-e.padding:e.diff=-e.padding;let f=e.height,x=e.x-m/2,b=e.y-f/2;V.trace("Data ",e,JSON.stringify(e));let k;if(e.look==="handDrawn"){let C=A.svg(c),P=N(e,{roughness:.7,fill:s,stroke:d,fillWeight:3,seed:a}),_=C.path(ge(x,b,m,f,0),P);k=c.insert(()=>(V.debug("Rough node insert CXC",_),_),":first-child"),k.select("path:nth-child(2)").attr("style",i.join(";")),k.select("path").attr("style",h.join(";").replace("fill","stroke"))}else k=c.insert("rect",":first-child"),k.attr("style",o).attr("rx",e.rx).attr("ry",e.ry).attr("x",x).attr("y",b).attr("width",m).attr("height",f);let{subGraphTitleTopMargin:S}=ft(l);if(u.attr("transform",`translate(${e.x-y.width/2}, ${e.y-e.height/2+S})`),t){let C=u.select("span");C&&C.attr("style",t)}let M=k.node().getBBox();return e.offsetX=0,e.width=M.width,e.height=M.height,e.offsetY=y.height-e.padding/2,e.intersect=function(C){return me(e,C)},{cluster:c,labelBBox:y}},"rect"),Sl={rect:Tt,squareRect:Tt,roundedWithTitle:w(async(r,e)=>{let l=Z(),{themeVariables:n,handDrawnSeed:a}=l,{altBackground:s,compositeBackground:d,compositeTitleBackground:t,nodeBorder:o}=n,i=r.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),h=i.insert("g",":first-child"),c=i.insert("g").attr("class","cluster-label"),g=i.append("rect"),u=c.node().appendChild(await ze(e.label,e.labelStyle,void 0,!0)),p=u.getBBox();if(Y(l.flowchart.htmlLabels)){let P=u.children[0],_=Q(u);p=P.getBoundingClientRect(),_.attr("width",p.width),_.attr("height",p.height)}let y=0*e.padding,m=y/2,f=(e.width<=p.width+e.padding?p.width+e.padding:e.width)+y;e.width<=p.width+e.padding?e.diff=(f-e.width)/2-e.padding:e.diff=-e.padding;let x=e.height+y,b=e.height+y-p.height-6,k=e.x-f/2,S=e.y-x/2;e.width=f;let M=e.y-e.height/2-m+p.height+2,C;if(e.look==="handDrawn"){let P=e.cssClasses.includes("statediagram-cluster-alt"),_=A.svg(i),E=e.rx||e.ry?_.path(ge(k,S,f,x,10),{roughness:.7,fill:t,fillStyle:"solid",stroke:o,seed:a}):_.rectangle(k,S,f,x,{seed:a});C=i.insert(()=>E,":first-child");let I=_.rectangle(k,M,f,b,{fill:P?s:d,fillStyle:P?"hachure":"solid",stroke:o,seed:a});C=i.insert(()=>E,":first-child"),g=i.insert(()=>I)}else C=h.insert("rect",":first-child"),C.attr("class","outer").attr("x",k).attr("y",S).attr("width",f).attr("height",x).attr("data-look",e.look),g.attr("class","inner").attr("x",k).attr("y",M).attr("width",f).attr("height",b);return c.attr("transform",`translate(${e.x-p.width/2}, ${S+1-(Y(l.flowchart.htmlLabels)?0:3)})`),e.height=C.node().getBBox().height,e.offsetX=0,e.offsetY=p.height-e.padding/2,e.labelBBox=p,e.intersect=function(P){return me(e,P)},{cluster:i,labelBBox:p}},"roundedWithTitle"),noteGroup:w((r,e)=>{let l=r.insert("g").attr("class","note-cluster").attr("id",e.id),n=l.insert("rect",":first-child"),a=0*e.padding,s=a/2;n.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-s).attr("y",e.y-e.height/2-s).attr("width",e.width+a).attr("height",e.height+a).attr("fill","none");let d=n.node().getBBox();return e.width=d.width,e.height=d.height,e.intersect=function(t){return me(e,t)},{cluster:l,labelBBox:{width:0,height:0}}},"noteGroup"),divider:w((r,e)=>{let{themeVariables:l,handDrawnSeed:n}=Z(),{nodeBorder:a}=l,s=r.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),d=s.insert("g",":first-child"),t=0*e.padding,o=e.width+t;e.diff=-e.padding;let i=e.height+t,h=e.x-o/2,c=e.y-i/2;e.width=o;let g;if(e.look==="handDrawn"){let u=A.svg(s).rectangle(h,c,o,i,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:a,seed:n});g=s.insert(()=>u,":first-child")}else g=d.insert("rect",":first-child"),g.attr("class","divider").attr("x",h).attr("y",c).attr("width",o).attr("height",i).attr("data-look",e.look);return e.height=g.node().getBBox().height,e.offsetX=0,e.offsetY=0,e.intersect=function(u){return me(e,u)},{cluster:s,labelBBox:{}}},"divider"),kanbanSection:w(async(r,e)=>{V.info("Creating subgraph rect for ",e.id,e);let l=Z(),{themeVariables:n,handDrawnSeed:a}=l,{clusterBkg:s,clusterBorder:d}=n,{labelStyles:t,nodeStyles:o,borderStyles:i,backgroundStyles:h}=R(e),c=r.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),g=Y(l.flowchart.htmlLabels),u=c.insert("g").attr("class","cluster-label "),p=await pe(u,e.label,{style:e.labelStyle,useHtmlLabels:g,isNode:!0,width:e.width}),y=p.getBBox();if(Y(l.flowchart.htmlLabels)){let C=p.children[0],P=Q(p);y=C.getBoundingClientRect(),P.attr("width",y.width),P.attr("height",y.height)}let m=e.width<=y.width+e.padding?y.width+e.padding:e.width;e.width<=y.width+e.padding?e.diff=(m-e.width)/2-e.padding:e.diff=-e.padding;let f=e.height,x=e.x-m/2,b=e.y-f/2;V.trace("Data ",e,JSON.stringify(e));let k;if(e.look==="handDrawn"){let C=A.svg(c),P=N(e,{roughness:.7,fill:s,stroke:d,fillWeight:4,seed:a}),_=C.path(ge(x,b,m,f,e.rx),P);k=c.insert(()=>(V.debug("Rough node insert CXC",_),_),":first-child"),k.select("path:nth-child(2)").attr("style",i.join(";")),k.select("path").attr("style",h.join(";").replace("fill","stroke"))}else k=c.insert("rect",":first-child"),k.attr("style",o).attr("rx",e.rx).attr("ry",e.ry).attr("x",x).attr("y",b).attr("width",m).attr("height",f);let{subGraphTitleTopMargin:S}=ft(l);if(u.attr("transform",`translate(${e.x-y.width/2}, ${e.y-e.height/2+S})`),t){let C=u.select("span");C&&C.attr("style",t)}let M=k.node().getBBox();return e.offsetX=0,e.width=M.width,e.height=M.height,e.offsetY=y.height-e.padding/2,e.intersect=function(C){return me(e,C)},{cluster:c,labelBBox:y}},"kanbanSection")},Rt=new Map,kl=w(async(r,e)=>{let l=await Sl[e.shape||"rect"](r,e);return Rt.set(e.id,l),l},"insertCluster"),$l=w(()=>{Rt=new Map},"clear");function _t(r,e){return r.intersect(e)}w(_t,"intersectNode");var Ml=_t;function Ot(r,e,l,n){var a=r.x,s=r.y,d=a-n.x,t=s-n.y,o=Math.sqrt(e*e*t*t+l*l*d*d),i=Math.abs(e*l*d/o);n.x<a&&(i=-i);var h=Math.abs(e*l*t/o);return n.y<s&&(h=-h),{x:a+i,y:s+h}}w(Ot,"intersectEllipse");var It=Ot;function Et(r,e,l){return It(r,e,e,l)}w(Et,"intersectCircle");var vl=Et;function Wt(r,e,l,n){{let a=e.y-r.y,s=r.x-e.x,d=e.x*r.y-r.x*e.y,t=a*l.x+s*l.y+d,o=a*n.x+s*n.y+d,i=1e-6;if(t!==0&&o!==0&&rt(t,o))return;let h=n.y-l.y,c=l.x-n.x,g=n.x*l.y-l.x*n.y,u=h*r.x+c*r.y+g,p=h*e.x+c*e.y+g;if(Math.abs(u)<i&&Math.abs(p)<i&&rt(u,p))return;let y=a*c-h*s;if(y===0)return;let m=Math.abs(y/2),f=s*g-c*d,x=f<0?(f-m)/y:(f+m)/y;return f=h*d-a*g,{x,y:f<0?(f-m)/y:(f+m)/y}}}w(Wt,"intersectLine");function rt(r,e){return r*e>0}w(rt,"sameSign");var Dl=Wt;function jt(r,e,l){let n=r.x,a=r.y,s=[],d=1/0,t=1/0;typeof e.forEach=="function"?e.forEach(function(h){d=Math.min(d,h.x),t=Math.min(t,h.y)}):(d=Math.min(d,e.x),t=Math.min(t,e.y));let o=n-r.width/2-d,i=a-r.height/2-t;for(let h=0;h<e.length;h++){let c=e[h],g=e[h<e.length-1?h+1:0],u=Dl(r,l,{x:o+c.x,y:i+c.y},{x:o+g.x,y:i+g.y});u&&s.push(u)}return s.length?(s.length>1&&s.sort(function(h,c){let g=h.x-l.x,u=h.y-l.y,p=Math.sqrt(g*g+u*u),y=c.x-l.x,m=c.y-l.y,f=Math.sqrt(y*y+m*m);return p<f?-1:p===f?0:1}),s[0]):r}w(jt,"intersectPolygon");var B={node:Ml,circle:vl,ellipse:It,polygon:jt,rect:me};function Ht(r,e){let{labelStyles:l}=R(e);e.labelStyle=l;let n=j(e),a=n;n||(a="anchor");let s=r.insert("g").attr("class",a).attr("id",e.domId||e.id),{cssStyles:d}=e,t=A.svg(s),o=N(e,{fill:"black",stroke:"none",fillStyle:"solid"});e.look!=="handDrawn"&&(o.roughness=0);let i=t.circle(0,0,2,o),h=s.insert(()=>i,":first-child");return h.attr("class","anchor").attr("style",U(d)),T(e,h),e.intersect=function(c){return V.info("Circle intersect",e,1,c),B.circle(e,1,c)},s}w(Ht,"anchor");function st(r,e,l,n,a,s,d){let t=(r+l)/2,o=(e+n)/2,i=Math.atan2(n-e,l-r),h=(l-r)/2,c=(n-e)/2,g=h/a,u=c/s,p=Math.sqrt(g**2+u**2);if(p>1)throw Error("The given radii are too small to create an arc between the points.");let y=Math.sqrt(1-p**2),m=t+y*s*Math.sin(i)*(d?-1:1),f=o-y*a*Math.cos(i)*(d?-1:1),x=Math.atan2((e-f)/s,(r-m)/a),b=Math.atan2((n-f)/s,(l-m)/a)-x;d&&b<0&&(b+=2*Math.PI),!d&&b>0&&(b-=2*Math.PI);let k=[];for(let S=0;S<20;S++){let M=x+S/19*b,C=m+a*Math.cos(M),P=f+s*Math.sin(M);k.push({x:C,y:P})}return k}w(st,"generateArcPoints");async function zt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=s.width+e.padding+20,t=s.height+e.padding,o=t/2,i=o/(2.5+t/50),{cssStyles:h}=e,c=[{x:d/2,y:-t/2},{x:-d/2,y:-t/2},...st(-d/2,-t/2,-d/2,t/2,i,o,!1),{x:d/2,y:t/2},...st(d/2,t/2,d/2,-t/2,i,o,!0)],g=A.svg(a),u=N(e,{});e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let p=q(c),y=g.path(p,u),m=a.insert(()=>y,":first-child");return m.attr("class","basic label-container"),h&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",h),n&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",n),m.attr("transform",`translate(${i/2}, 0)`),T(e,m),e.intersect=function(f){return B.polygon(e,c,f)},a}w(zt,"bowTieRect");function ue(r,e,l,n){return r.insert("polygon",":first-child").attr("points",n.map(function(a){return a.x+","+a.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+l/2+")")}w(ue,"insertPolygonShape");async function qt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=s.height+e.padding,t=s.width+e.padding+12,o=t,i=-d,h=[{x:12,y:i},{x:o,y:i},{x:o,y:0},{x:0,y:0},{x:0,y:i+12},{x:12,y:i}],c,{cssStyles:g}=e;if(e.look==="handDrawn"){let u=A.svg(a),p=N(e,{}),y=q(h),m=u.path(y,p);c=a.insert(()=>m,":first-child").attr("transform",`translate(${-t/2}, ${d/2})`),g&&c.attr("style",g)}else c=ue(a,t,d,h);return n&&c.attr("style",n),T(e,c),e.intersect=function(u){return B.polygon(e,h,u)},a}w(qt,"card");function Vt(r,e){let{nodeStyles:l}=R(e);e.label="";let n=r.insert("g").attr("class",j(e)).attr("id",e.domId??e.id),{cssStyles:a}=e,s=Math.max(28,e.width??0),d=[{x:0,y:s/2},{x:s/2,y:0},{x:0,y:-s/2},{x:-s/2,y:0}],t=A.svg(n),o=N(e,{});e.look!=="handDrawn"&&(o.roughness=0,o.fillStyle="solid");let i=q(d),h=t.path(i,o),c=n.insert(()=>h,":first-child");return a&&e.look!=="handDrawn"&&c.selectAll("path").attr("style",a),l&&e.look!=="handDrawn"&&c.selectAll("path").attr("style",l),e.width=28,e.height=28,e.intersect=function(g){return B.polygon(e,d,g)},n}w(Vt,"choice");async function it(r,e,l){let{labelStyles:n,nodeStyles:a}=R(e);e.labelStyle=n;let{shapeSvg:s,bbox:d,halfPadding:t}=await z(r,e,j(e)),o=(l==null?void 0:l.padding)??t,i=d.width/2+o,h,{cssStyles:c}=e;if(e.look==="handDrawn"){let g=A.svg(s),u=N(e,{}),p=g.circle(0,0,i*2,u);h=s.insert(()=>p,":first-child"),h.attr("class","basic label-container").attr("style",U(c))}else h=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",a).attr("r",i).attr("cx",0).attr("cy",0);return T(e,h),e.calcIntersect=function(g,u){let p=g.width/2;return B.circle(g,p,u)},e.intersect=function(g){return V.info("Circle intersect",e,i,g),B.circle(e,i,g)},s}w(it,"circle");function Ft(r){let e=Math.cos(Math.PI/4),l=Math.sin(Math.PI/4),n=r*2,a={x:n/2*e,y:n/2*l},s={x:-(n/2)*e,y:n/2*l},d={x:-(n/2)*e,y:-(n/2)*l},t={x:n/2*e,y:-(n/2)*l};return`M ${s.x},${s.y} L ${t.x},${t.y}
                   M ${a.x},${a.y} L ${d.x},${d.y}`}w(Ft,"createLine");function Gt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l,e.label="";let a=r.insert("g").attr("class",j(e)).attr("id",e.domId??e.id),s=Math.max(30,(e==null?void 0:e.width)??0),{cssStyles:d}=e,t=A.svg(a),o=N(e,{});e.look!=="handDrawn"&&(o.roughness=0,o.fillStyle="solid");let i=t.circle(0,0,s*2,o),h=Ft(s),c=t.path(h,o),g=a.insert(()=>i,":first-child");return g.insert(()=>c),d&&e.look!=="handDrawn"&&g.selectAll("path").attr("style",d),n&&e.look!=="handDrawn"&&g.selectAll("path").attr("style",n),T(e,g),e.intersect=function(u){return V.info("crossedCircle intersect",e,{radius:s,point:u}),B.circle(e,s,u)},a}w(Gt,"crossedCircle");function ie(r,e,l,n=100,a=0,s=180){let d=[],t=a*Math.PI/180,o=(s*Math.PI/180-t)/(n-1);for(let i=0;i<n;i++){let h=t+i*o,c=r+l*Math.cos(h),g=e+l*Math.sin(h);d.push({x:-c,y:-g})}return d}w(ie,"generateCirclePoints");async function Zt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=s.width+(e.padding??0),o=s.height+(e.padding??0),i=Math.max(5,o*.1),{cssStyles:h}=e,c=[...ie(t/2,-o/2,i,30,-90,0),{x:-t/2-i,y:i},...ie(t/2+i*2,-i,i,20,-180,-270),...ie(t/2+i*2,i,i,20,-90,-180),{x:-t/2-i,y:-o/2},...ie(t/2,o/2,i,20,0,90)],g=[{x:t/2,y:-o/2-i},{x:-t/2,y:-o/2-i},...ie(t/2,-o/2,i,20,-90,0),{x:-t/2-i,y:-i},...ie(t/2+t*.1,-i,i,20,-180,-270),...ie(t/2+t*.1,i,i,20,-90,-180),{x:-t/2-i,y:o/2},...ie(t/2,o/2,i,20,0,90),{x:-t/2,y:o/2+i},{x:t/2,y:o/2+i}],u=A.svg(a),p=N(e,{fill:"none"});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=q(c).replace("Z",""),m=u.path(y,p),f=q(g),x=u.path(f,{...p}),b=a.insert("g",":first-child");return b.insert(()=>x,":first-child").attr("stroke-opacity",0),b.insert(()=>m,":first-child"),b.attr("class","text"),h&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",h),n&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",n),b.attr("transform",`translate(${i}, 0)`),d.attr("transform",`translate(${-t/2+i-(s.x-(s.left??0))},${-o/2+(e.padding??0)/2-(s.y-(s.top??0))})`),T(e,b),e.intersect=function(k){return B.polygon(e,g,k)},a}w(Zt,"curlyBraceLeft");function ne(r,e,l,n=100,a=0,s=180){let d=[],t=a*Math.PI/180,o=(s*Math.PI/180-t)/(n-1);for(let i=0;i<n;i++){let h=t+i*o,c=r+l*Math.cos(h),g=e+l*Math.sin(h);d.push({x:c,y:g})}return d}w(ne,"generateCirclePoints");async function Xt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=s.width+(e.padding??0),o=s.height+(e.padding??0),i=Math.max(5,o*.1),{cssStyles:h}=e,c=[...ne(t/2,-o/2,i,20,-90,0),{x:t/2+i,y:-i},...ne(t/2+i*2,-i,i,20,-180,-270),...ne(t/2+i*2,i,i,20,-90,-180),{x:t/2+i,y:o/2},...ne(t/2,o/2,i,20,0,90)],g=[{x:-t/2,y:-o/2-i},{x:t/2,y:-o/2-i},...ne(t/2,-o/2,i,20,-90,0),{x:t/2+i,y:-i},...ne(t/2+i*2,-i,i,20,-180,-270),...ne(t/2+i*2,i,i,20,-90,-180),{x:t/2+i,y:o/2},...ne(t/2,o/2,i,20,0,90),{x:t/2,y:o/2+i},{x:-t/2,y:o/2+i}],u=A.svg(a),p=N(e,{fill:"none"});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=q(c).replace("Z",""),m=u.path(y,p),f=q(g),x=u.path(f,{...p}),b=a.insert("g",":first-child");return b.insert(()=>x,":first-child").attr("stroke-opacity",0),b.insert(()=>m,":first-child"),b.attr("class","text"),h&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",h),n&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",n),b.attr("transform",`translate(${-i}, 0)`),d.attr("transform",`translate(${-t/2+(e.padding??0)/2-(s.x-(s.left??0))},${-o/2+(e.padding??0)/2-(s.y-(s.top??0))})`),T(e,b),e.intersect=function(k){return B.polygon(e,g,k)},a}w(Xt,"curlyBraceRight");function J(r,e,l,n=100,a=0,s=180){let d=[],t=a*Math.PI/180,o=(s*Math.PI/180-t)/(n-1);for(let i=0;i<n;i++){let h=t+i*o,c=r+l*Math.cos(h),g=e+l*Math.sin(h);d.push({x:-c,y:-g})}return d}w(J,"generateCirclePoints");async function Qt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=s.width+(e.padding??0),o=s.height+(e.padding??0),i=Math.max(5,o*.1),{cssStyles:h}=e,c=[...J(t/2,-o/2,i,30,-90,0),{x:-t/2-i,y:i},...J(t/2+i*2,-i,i,20,-180,-270),...J(t/2+i*2,i,i,20,-90,-180),{x:-t/2-i,y:-o/2},...J(t/2,o/2,i,20,0,90)],g=[...J(-t/2+i+i/2,-o/2,i,20,-90,-180),{x:t/2-i/2,y:i},...J(-t/2-i/2,-i,i,20,0,90),...J(-t/2-i/2,i,i,20,-90,0),{x:t/2-i/2,y:-i},...J(-t/2+i+i/2,o/2,i,30,-180,-270)],u=[{x:t/2,y:-o/2-i},{x:-t/2,y:-o/2-i},...J(t/2,-o/2,i,20,-90,0),{x:-t/2-i,y:-i},...J(t/2+i*2,-i,i,20,-180,-270),...J(t/2+i*2,i,i,20,-90,-180),{x:-t/2-i,y:o/2},...J(t/2,o/2,i,20,0,90),{x:-t/2,y:o/2+i},{x:t/2-i-i/2,y:o/2+i},...J(-t/2+i+i/2,-o/2,i,20,-90,-180),{x:t/2-i/2,y:i},...J(-t/2-i/2,-i,i,20,0,90),...J(-t/2-i/2,i,i,20,-90,0),{x:t/2-i/2,y:-i},...J(-t/2+i+i/2,o/2,i,30,-180,-270)],p=A.svg(a),y=N(e,{fill:"none"});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=q(c).replace("Z",""),f=p.path(m,y),x=q(g).replace("Z",""),b=p.path(x,y),k=q(u),S=p.path(k,{...y}),M=a.insert("g",":first-child");return M.insert(()=>S,":first-child").attr("stroke-opacity",0),M.insert(()=>f,":first-child"),M.insert(()=>b,":first-child"),M.attr("class","text"),h&&e.look!=="handDrawn"&&M.selectAll("path").attr("style",h),n&&e.look!=="handDrawn"&&M.selectAll("path").attr("style",n),M.attr("transform",`translate(${i-i/4}, 0)`),d.attr("transform",`translate(${-t/2+(e.padding??0)/2-(s.x-(s.left??0))},${-o/2+(e.padding??0)/2-(s.y-(s.top??0))})`),T(e,M),e.intersect=function(C){return B.polygon(e,u,C)},a}w(Qt,"curlyBraces");async function Jt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(80,(s.width+(e.padding??0)*2)*1.25,(e==null?void 0:e.width)??0),t=Math.max(20,s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),o=t/2,{cssStyles:i}=e,h=A.svg(a),c=N(e,{});e.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let g=d,u=t,p=g-o,y=u/4,m=[{x:p,y:0},{x:y,y:0},{x:0,y:u/2},{x:y,y:u},{x:p,y:u},...ve(-p,-u/2,o,50,270,90)],f=q(m),x=h.path(f,c),b=a.insert(()=>x,":first-child");return b.attr("class","basic label-container"),i&&e.look!=="handDrawn"&&b.selectChildren("path").attr("style",i),n&&e.look!=="handDrawn"&&b.selectChildren("path").attr("style",n),b.attr("transform",`translate(${-d/2}, ${-t/2})`),T(e,b),e.intersect=function(k){return B.polygon(e,m,k)},a}w(Jt,"curvedTrapezoid");var Cl=w((r,e,l,n,a,s)=>[`M${r},${e+s}`,`a${a},${s} 0,0,0 ${l},0`,`a${a},${s} 0,0,0 ${-l},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${l},0`,`l0,${-n}`].join(" "),"createCylinderPathD"),Pl=w((r,e,l,n,a,s)=>[`M${r},${e+s}`,`M${r+l},${e+s}`,`a${a},${s} 0,0,0 ${-l},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${l},0`,`l0,${-n}`].join(" "),"createOuterCylinderPathD"),Bl=w((r,e,l,n,a,s)=>[`M${r-l/2},${-n/2}`,`a${a},${s} 0,0,0 ${l},0`].join(" "),"createInnerCylinderPathD");async function Yt(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+e.padding,e.width??0),o=t/2,i=o/(2.5+t/50),h=Math.max(s.height+i+e.padding,e.height??0),c,{cssStyles:g}=e;if(e.look==="handDrawn"){let u=A.svg(a),p=Pl(0,0,t,h,o,i),y=Bl(0,i,t,h,o,i),m=u.path(p,N(e,{})),f=u.path(y,N(e,{fill:"none"}));c=a.insert(()=>f,":first-child"),c=a.insert(()=>m,":first-child"),c.attr("class","basic label-container"),g&&c.attr("style",g)}else{let u=Cl(0,0,t,h,o,i);c=a.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",U(g)).attr("style",n)}return c.attr("label-offset-y",i),c.attr("transform",`translate(${-t/2}, ${-(h/2+i)})`),T(e,c),d.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+(e.padding??0)/1.5-(s.y-(s.top??0))})`),e.intersect=function(u){let p=B.rect(e,u),y=p.x-(e.x??0);if(o!=0&&(Math.abs(y)<(e.width??0)/2||Math.abs(y)==(e.width??0)/2&&Math.abs(p.y-(e.y??0))>(e.height??0)/2-i)){let m=i*i*(1-y*y/(o*o));m>0&&(m=Math.sqrt(m)),m=i-m,u.y-(e.y??0)>0&&(m=-m),p.y+=m}return p},a}w(Yt,"cylinder");async function Ut(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=s.width+e.padding,o=s.height+e.padding,i=o*.2,h=-t/2,c=-o/2-i/2,{cssStyles:g}=e,u=A.svg(a),p=N(e,{});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=[{x:h,y:c+i},{x:-h,y:c+i},{x:-h,y:-c},{x:h,y:-c},{x:h,y:c},{x:-h,y:c},{x:-h,y:c+i}],m=u.polygon(y.map(x=>[x.x,x.y]),p),f=a.insert(()=>m,":first-child");return f.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&f.selectAll("path").attr("style",g),n&&e.look!=="handDrawn"&&f.selectAll("path").attr("style",n),d.attr("transform",`translate(${h+(e.padding??0)/2-(s.x-(s.left??0))}, ${c+i+(e.padding??0)/2-(s.y-(s.top??0))})`),T(e,f),e.intersect=function(x){return B.rect(e,x)},a}w(Ut,"dividedRectangle");async function Kt(r,e){var c,g;let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,halfPadding:d}=await z(r,e,j(e)),t=s.width/2+d+5,o=s.width/2+d,i,{cssStyles:h}=e;if(e.look==="handDrawn"){let u=A.svg(a),p=N(e,{roughness:.2,strokeWidth:2.5}),y=N(e,{roughness:.2,strokeWidth:1.5}),m=u.circle(0,0,t*2,p),f=u.circle(0,0,o*2,y);i=a.insert("g",":first-child"),i.attr("class",U(e.cssClasses)).attr("style",U(h)),(c=i.node())==null||c.appendChild(m),(g=i.node())==null||g.appendChild(f)}else{i=a.insert("g",":first-child");let u=i.insert("circle",":first-child"),p=i.insert("circle");i.attr("class","basic label-container").attr("style",n),u.attr("class","outer-circle").attr("style",n).attr("r",t).attr("cx",0).attr("cy",0),p.attr("class","inner-circle").attr("style",n).attr("r",o).attr("cx",0).attr("cy",0)}return T(e,i),e.intersect=function(u){return V.info("DoubleCircle intersect",e,t,u),B.circle(e,t,u)},a}w(Kt,"doublecircle");function ea(r,e,{config:{themeVariables:l}}){let{labelStyles:n,nodeStyles:a}=R(e);e.label="",e.labelStyle=n;let s=r.insert("g").attr("class",j(e)).attr("id",e.domId??e.id),{cssStyles:d}=e,t=A.svg(s),{nodeBorder:o}=l,i=N(e,{fillStyle:"solid"});e.look!=="handDrawn"&&(i.roughness=0);let h=t.circle(0,0,14,i),c=s.insert(()=>h,":first-child");return c.selectAll("path").attr("style",`fill: ${o} !important;`),d&&d.length>0&&e.look!=="handDrawn"&&c.selectAll("path").attr("style",d),a&&e.look!=="handDrawn"&&c.selectAll("path").attr("style",a),T(e,c),e.intersect=function(g){return V.info("filledCircle intersect",e,{radius:7,point:g}),B.circle(e,7,g)},s}w(ea,"filledCircle");async function ta(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=s.width+(e.padding??0),o=t+s.height,i=t+s.height,h=[{x:0,y:-o},{x:i,y:-o},{x:i/2,y:0}],{cssStyles:c}=e,g=A.svg(a),u=N(e,{});e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let p=q(h),y=g.path(p,u),m=a.insert(()=>y,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`);return c&&e.look!=="handDrawn"&&m.selectChildren("path").attr("style",c),n&&e.look!=="handDrawn"&&m.selectChildren("path").attr("style",n),e.width=t,e.height=o,T(e,m),d.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${-o/2+(e.padding??0)/2+(s.y-(s.top??0))})`),e.intersect=function(f){return V.info("Triangle intersect",e,h,f),B.polygon(e,h,f)},a}w(ta,"flippedTriangle");function aa(r,e,{dir:l,config:{state:n,themeVariables:a}}){let{nodeStyles:s}=R(e);e.label="";let d=r.insert("g").attr("class",j(e)).attr("id",e.domId??e.id),{cssStyles:t}=e,o=Math.max(70,(e==null?void 0:e.width)??0),i=Math.max(10,(e==null?void 0:e.height)??0);l==="LR"&&(o=Math.max(10,(e==null?void 0:e.width)??0),i=Math.max(70,(e==null?void 0:e.height)??0));let h=-1*o/2,c=-1*i/2,g=A.svg(d),u=N(e,{stroke:a.lineColor,fill:a.lineColor});e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let p=g.rectangle(h,c,o,i,u),y=d.insert(()=>p,":first-child");t&&e.look!=="handDrawn"&&y.selectAll("path").attr("style",t),s&&e.look!=="handDrawn"&&y.selectAll("path").attr("style",s),T(e,y);let m=(n==null?void 0:n.padding)??0;return e.width&&e.height&&(e.width+=m/2||0,e.height+=m/2||0),e.intersect=function(f){return B.rect(e,f)},d}w(aa,"forkJoin");async function la(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(80,s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),t=Math.max(50,s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),o=t/2,{cssStyles:i}=e,h=A.svg(a),c=N(e,{});e.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let g=[{x:-d/2,y:-t/2},{x:d/2-o,y:-t/2},...ve(-d/2+o,0,o,50,90,270),{x:d/2-o,y:t/2},{x:-d/2,y:t/2}],u=q(g),p=h.path(u,c),y=a.insert(()=>p,":first-child");return y.attr("class","basic label-container"),i&&e.look!=="handDrawn"&&y.selectChildren("path").attr("style",i),n&&e.look!=="handDrawn"&&y.selectChildren("path").attr("style",n),T(e,y),e.intersect=function(m){return V.info("Pill intersect",e,{radius:o,point:m}),B.polygon(e,g,m)},a}w(la,"halfRoundedRectangle");async function ra(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=s.height+(e.padding??0),t=s.width+(e.padding??0)*2.5,{cssStyles:o}=e,i=A.svg(a),h=N(e,{});e.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");let c=t/2,g=c/6;c+=g;let u=d/2,p=u/2,y=c-p,m=[{x:-y,y:-u},{x:0,y:-u},{x:y,y:-u},{x:c,y:0},{x:y,y:u},{x:0,y:u},{x:-y,y:u},{x:-c,y:0}],f=q(m),x=i.path(f,h),b=a.insert(()=>x,":first-child");return b.attr("class","basic label-container"),o&&e.look!=="handDrawn"&&b.selectChildren("path").attr("style",o),n&&e.look!=="handDrawn"&&b.selectChildren("path").attr("style",n),e.width=t,e.height=d,T(e,b),e.intersect=function(k){return B.polygon(e,m,k)},a}w(ra,"hexagon");async function sa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.label="",e.labelStyle=l;let{shapeSvg:a}=await z(r,e,j(e)),s=Math.max(30,(e==null?void 0:e.width)??0),d=Math.max(30,(e==null?void 0:e.height)??0),{cssStyles:t}=e,o=A.svg(a),i=N(e,{});e.look!=="handDrawn"&&(i.roughness=0,i.fillStyle="solid");let h=[{x:0,y:0},{x:s,y:0},{x:0,y:d},{x:s,y:d}],c=q(h),g=o.path(c,i),u=a.insert(()=>g,":first-child");return u.attr("class","basic label-container"),t&&e.look!=="handDrawn"&&u.selectChildren("path").attr("style",t),n&&e.look!=="handDrawn"&&u.selectChildren("path").attr("style",n),u.attr("transform",`translate(${-s/2}, ${-d/2})`),T(e,u),e.intersect=function(p){return V.info("Pill intersect",e,{points:h}),B.polygon(e,h,p)},a}w(sa,"hourglass");async function ia(r,e,{config:{themeVariables:l,flowchart:n}}){let{labelStyles:a}=R(e);e.labelStyle=a;let s=e.assetHeight??48,d=e.assetWidth??48,t=Math.max(s,d),o=n==null?void 0:n.wrappingWidth;e.width=Math.max(t,o??0);let{shapeSvg:i,bbox:h,label:c}=await z(r,e,"icon-shape default"),g=e.pos==="t",u=t,p=t,{nodeBorder:y}=l,{stylesMap:m}=Ae(e),f=-p/2,x=-u/2,b=e.label?8:0,k=A.svg(i),S=N(e,{stroke:"none",fill:"none"});e.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");let M=k.rectangle(f,x,p,u,S),C=Math.max(p,h.width),P=u+h.height+b,_=k.rectangle(-C/2,-P/2,C,P,{...S,fill:"transparent",stroke:"none"}),E=i.insert(()=>M,":first-child"),I=i.insert(()=>_);if(e.icon){let L=i.append("g");L.html(`<g>${await Le(e.icon,{height:t,width:t,fallbackPrefix:""})}</g>`);let v=L.node().getBBox(),$=v.width,D=v.height,O=v.x,W=v.y;L.attr("transform",`translate(${-$/2-O},${g?h.height/2+b/2-D/2-W:-h.height/2-b/2-D/2-W})`),L.attr("style",`color: ${m.get("stroke")??y};`)}return c.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${g?-P/2:P/2-h.height})`),E.attr("transform",`translate(0,${g?h.height/2+b/2:-h.height/2-b/2})`),T(e,I),e.intersect=function(L){if(V.info("iconSquare intersect",e,L),!e.label)return B.rect(e,L);let v=e.x??0,$=e.y??0,D=e.height??0,O=[];return O=g?[{x:v-h.width/2,y:$-D/2},{x:v+h.width/2,y:$-D/2},{x:v+h.width/2,y:$-D/2+h.height+b},{x:v+p/2,y:$-D/2+h.height+b},{x:v+p/2,y:$+D/2},{x:v-p/2,y:$+D/2},{x:v-p/2,y:$-D/2+h.height+b},{x:v-h.width/2,y:$-D/2+h.height+b}]:[{x:v-p/2,y:$-D/2},{x:v+p/2,y:$-D/2},{x:v+p/2,y:$-D/2+u},{x:v+h.width/2,y:$-D/2+u},{x:v+h.width/2/2,y:$+D/2},{x:v-h.width/2,y:$+D/2},{x:v-h.width/2,y:$-D/2+u},{x:v-p/2,y:$-D/2+u}],B.polygon(e,O,L)},i}w(ia,"icon");async function na(r,e,{config:{themeVariables:l,flowchart:n}}){let{labelStyles:a}=R(e);e.labelStyle=a;let s=e.assetHeight??48,d=e.assetWidth??48,t=Math.max(s,d),o=n==null?void 0:n.wrappingWidth;e.width=Math.max(t,o??0);let{shapeSvg:i,bbox:h,label:c}=await z(r,e,"icon-shape default"),g=e.label?8:0,u=e.pos==="t",{nodeBorder:p,mainBkg:y}=l,{stylesMap:m}=Ae(e),f=A.svg(i),x=N(e,{});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid"),x.stroke=m.get("fill")??y;let b=i.append("g");e.icon&&b.html(`<g>${await Le(e.icon,{height:t,width:t,fallbackPrefix:""})}</g>`);let k=b.node().getBBox(),S=k.width,M=k.height,C=k.x,P=k.y,_=Math.max(S,M)*Math.SQRT2+40,E=f.circle(0,0,_,x),I=Math.max(_,h.width),L=_+h.height+g,v=f.rectangle(-I/2,-L/2,I,L,{...x,fill:"transparent",stroke:"none"}),$=i.insert(()=>E,":first-child"),D=i.insert(()=>v);return b.attr("transform",`translate(${-S/2-C},${u?h.height/2+g/2-M/2-P:-h.height/2-g/2-M/2-P})`),b.attr("style",`color: ${m.get("stroke")??p};`),c.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${u?-L/2:L/2-h.height})`),$.attr("transform",`translate(0,${u?h.height/2+g/2:-h.height/2-g/2})`),T(e,D),e.intersect=function(O){return V.info("iconSquare intersect",e,O),B.rect(e,O)},i}w(na,"iconCircle");async function ha(r,e,{config:{themeVariables:l,flowchart:n}}){let{labelStyles:a}=R(e);e.labelStyle=a;let s=e.assetHeight??48,d=e.assetWidth??48,t=Math.max(s,d),o=n==null?void 0:n.wrappingWidth;e.width=Math.max(t,o??0);let{shapeSvg:i,bbox:h,halfPadding:c,label:g}=await z(r,e,"icon-shape default"),u=e.pos==="t",p=t+c*2,y=t+c*2,{nodeBorder:m,mainBkg:f}=l,{stylesMap:x}=Ae(e),b=-y/2,k=-p/2,S=e.label?8:0,M=A.svg(i),C=N(e,{});e.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid"),C.stroke=x.get("fill")??f;let P=M.path(ge(b,k,y,p,5),C),_=Math.max(y,h.width),E=p+h.height+S,I=M.rectangle(-_/2,-E/2,_,E,{...C,fill:"transparent",stroke:"none"}),L=i.insert(()=>P,":first-child").attr("class","icon-shape2"),v=i.insert(()=>I);if(e.icon){let $=i.append("g");$.html(`<g>${await Le(e.icon,{height:t,width:t,fallbackPrefix:""})}</g>`);let D=$.node().getBBox(),O=D.width,W=D.height,X=D.x,te=D.y;$.attr("transform",`translate(${-O/2-X},${u?h.height/2+S/2-W/2-te:-h.height/2-S/2-W/2-te})`),$.attr("style",`color: ${x.get("stroke")??m};`)}return g.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${u?-E/2:E/2-h.height})`),L.attr("transform",`translate(0,${u?h.height/2+S/2:-h.height/2-S/2})`),T(e,v),e.intersect=function($){if(V.info("iconSquare intersect",e,$),!e.label)return B.rect(e,$);let D=e.x??0,O=e.y??0,W=e.height??0,X=[];return X=u?[{x:D-h.width/2,y:O-W/2},{x:D+h.width/2,y:O-W/2},{x:D+h.width/2,y:O-W/2+h.height+S},{x:D+y/2,y:O-W/2+h.height+S},{x:D+y/2,y:O+W/2},{x:D-y/2,y:O+W/2},{x:D-y/2,y:O-W/2+h.height+S},{x:D-h.width/2,y:O-W/2+h.height+S}]:[{x:D-y/2,y:O-W/2},{x:D+y/2,y:O-W/2},{x:D+y/2,y:O-W/2+p},{x:D+h.width/2,y:O-W/2+p},{x:D+h.width/2/2,y:O+W/2},{x:D-h.width/2,y:O+W/2},{x:D-h.width/2,y:O-W/2+p},{x:D-y/2,y:O-W/2+p}],B.polygon(e,X,$)},i}w(ha,"iconRounded");async function oa(r,e,{config:{themeVariables:l,flowchart:n}}){let{labelStyles:a}=R(e);e.labelStyle=a;let s=e.assetHeight??48,d=e.assetWidth??48,t=Math.max(s,d),o=n==null?void 0:n.wrappingWidth;e.width=Math.max(t,o??0);let{shapeSvg:i,bbox:h,halfPadding:c,label:g}=await z(r,e,"icon-shape default"),u=e.pos==="t",p=t+c*2,y=t+c*2,{nodeBorder:m,mainBkg:f}=l,{stylesMap:x}=Ae(e),b=-y/2,k=-p/2,S=e.label?8:0,M=A.svg(i),C=N(e,{});e.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid"),C.stroke=x.get("fill")??f;let P=M.path(ge(b,k,y,p,.1),C),_=Math.max(y,h.width),E=p+h.height+S,I=M.rectangle(-_/2,-E/2,_,E,{...C,fill:"transparent",stroke:"none"}),L=i.insert(()=>P,":first-child"),v=i.insert(()=>I);if(e.icon){let $=i.append("g");$.html(`<g>${await Le(e.icon,{height:t,width:t,fallbackPrefix:""})}</g>`);let D=$.node().getBBox(),O=D.width,W=D.height,X=D.x,te=D.y;$.attr("transform",`translate(${-O/2-X},${u?h.height/2+S/2-W/2-te:-h.height/2-S/2-W/2-te})`),$.attr("style",`color: ${x.get("stroke")??m};`)}return g.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${u?-E/2:E/2-h.height})`),L.attr("transform",`translate(0,${u?h.height/2+S/2:-h.height/2-S/2})`),T(e,v),e.intersect=function($){if(V.info("iconSquare intersect",e,$),!e.label)return B.rect(e,$);let D=e.x??0,O=e.y??0,W=e.height??0,X=[];return X=u?[{x:D-h.width/2,y:O-W/2},{x:D+h.width/2,y:O-W/2},{x:D+h.width/2,y:O-W/2+h.height+S},{x:D+y/2,y:O-W/2+h.height+S},{x:D+y/2,y:O+W/2},{x:D-y/2,y:O+W/2},{x:D-y/2,y:O-W/2+h.height+S},{x:D-h.width/2,y:O-W/2+h.height+S}]:[{x:D-y/2,y:O-W/2},{x:D+y/2,y:O-W/2},{x:D+y/2,y:O-W/2+p},{x:D+h.width/2,y:O-W/2+p},{x:D+h.width/2/2,y:O+W/2},{x:D-h.width/2,y:O+W/2},{x:D-h.width/2,y:O-W/2+p},{x:D-y/2,y:O-W/2+p}],B.polygon(e,X,$)},i}w(oa,"iconSquare");async function da(r,e,{config:{flowchart:l}}){let n=new Image;n.src=(e==null?void 0:e.img)??"",await n.decode();let a=Number(n.naturalWidth.toString().replace("px","")),s=Number(n.naturalHeight.toString().replace("px",""));e.imageAspectRatio=a/s;let{labelStyles:d}=R(e);e.labelStyle=d;let t=l==null?void 0:l.wrappingWidth;e.defaultWidth=l==null?void 0:l.wrappingWidth;let o=Math.max(e.label?t??0:0,(e==null?void 0:e.assetWidth)??a),i=e.constraint==="on"&&(e!=null&&e.assetHeight)?e.assetHeight*e.imageAspectRatio:o,h=e.constraint==="on"?i/e.imageAspectRatio:(e==null?void 0:e.assetHeight)??s;e.width=Math.max(i,t??0);let{shapeSvg:c,bbox:g,label:u}=await z(r,e,"image-shape default"),p=e.pos==="t",y=-i/2,m=-h/2,f=e.label?8:0,x=A.svg(c),b=N(e,{});e.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let k=x.rectangle(y,m,i,h,b),S=Math.max(i,g.width),M=h+g.height+f,C=x.rectangle(-S/2,-M/2,S,M,{...b,fill:"none",stroke:"none"}),P=c.insert(()=>k,":first-child"),_=c.insert(()=>C);if(e.img){let E=c.append("image");E.attr("href",e.img),E.attr("width",i),E.attr("height",h),E.attr("preserveAspectRatio","none"),E.attr("transform",`translate(${-i/2},${p?M/2-h:-M/2})`)}return u.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${p?-h/2-g.height/2-f/2:h/2-g.height/2+f/2})`),P.attr("transform",`translate(0,${p?g.height/2+f/2:-g.height/2-f/2})`),T(e,_),e.intersect=function(E){if(V.info("iconSquare intersect",e,E),!e.label)return B.rect(e,E);let I=e.x??0,L=e.y??0,v=e.height??0,$=[];return $=p?[{x:I-g.width/2,y:L-v/2},{x:I+g.width/2,y:L-v/2},{x:I+g.width/2,y:L-v/2+g.height+f},{x:I+i/2,y:L-v/2+g.height+f},{x:I+i/2,y:L+v/2},{x:I-i/2,y:L+v/2},{x:I-i/2,y:L-v/2+g.height+f},{x:I-g.width/2,y:L-v/2+g.height+f}]:[{x:I-i/2,y:L-v/2},{x:I+i/2,y:L-v/2},{x:I+i/2,y:L-v/2+h},{x:I+g.width/2,y:L-v/2+h},{x:I+g.width/2/2,y:L+v/2},{x:I-g.width/2,y:L+v/2},{x:I-g.width/2,y:L-v/2+h},{x:I-i/2,y:L-v/2+h}],B.polygon(e,$,E)},c}w(da,"imageSquare");async function ca(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),t=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),o=[{x:0,y:0},{x:d,y:0},{x:d+3*t/6,y:-t},{x:-3*t/6,y:-t}],i,{cssStyles:h}=e;if(e.look==="handDrawn"){let c=A.svg(a),g=N(e,{}),u=q(o),p=c.path(u,g);i=a.insert(()=>p,":first-child").attr("transform",`translate(${-d/2}, ${t/2})`),h&&i.attr("style",h)}else i=ue(a,d,t,o);return n&&i.attr("style",n),e.width=d,e.height=t,T(e,i),e.intersect=function(c){return B.polygon(e,o,c)},a}w(ca,"inv_trapezoid");async function qe(r,e,l){let{labelStyles:n,nodeStyles:a}=R(e);e.labelStyle=n;let{shapeSvg:s,bbox:d}=await z(r,e,j(e)),t=Math.max(d.width+l.labelPaddingX*2,(e==null?void 0:e.width)||0),o=Math.max(d.height+l.labelPaddingY*2,(e==null?void 0:e.height)||0),i=-t/2,h=-o/2,c,{rx:g,ry:u}=e,{cssStyles:p}=e;if(l!=null&&l.rx&&l.ry&&(g=l.rx,u=l.ry),e.look==="handDrawn"){let y=A.svg(s),m=N(e,{}),f=g||u?y.path(ge(i,h,t,o,g||0),m):y.rectangle(i,h,t,o,m);c=s.insert(()=>f,":first-child"),c.attr("class","basic label-container").attr("style",U(p))}else c=s.insert("rect",":first-child"),c.attr("class","basic label-container").attr("style",a).attr("rx",U(g)).attr("ry",U(u)).attr("x",i).attr("y",h).attr("width",t).attr("height",o);return T(e,c),e.calcIntersect=function(y,m){return B.rect(y,m)},e.intersect=function(y){return B.rect(e,y)},s}w(qe,"drawRect");async function ga(r,e){let{shapeSvg:l,bbox:n,label:a}=await z(r,e,"label"),s=l.insert("rect",":first-child");return s.attr("width",.1).attr("height",.1),l.attr("class","label edgeLabel"),a.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),T(e,s),e.intersect=function(d){return B.rect(e,d)},l}w(ga,"labelRect");async function ua(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(s.width+(e.padding??0),(e==null?void 0:e.width)??0),t=Math.max(s.height+(e.padding??0),(e==null?void 0:e.height)??0),o=[{x:0,y:0},{x:d+3*t/6,y:0},{x:d,y:-t},{x:-(3*t)/6,y:-t}],i,{cssStyles:h}=e;if(e.look==="handDrawn"){let c=A.svg(a),g=N(e,{}),u=q(o),p=c.path(u,g);i=a.insert(()=>p,":first-child").attr("transform",`translate(${-d/2}, ${t/2})`),h&&i.attr("style",h)}else i=ue(a,d,t,o);return n&&i.attr("style",n),e.width=d,e.height=t,T(e,i),e.intersect=function(c){return B.polygon(e,o,c)},a}w(ua,"lean_left");async function pa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(s.width+(e.padding??0),(e==null?void 0:e.width)??0),t=Math.max(s.height+(e.padding??0),(e==null?void 0:e.height)??0),o=[{x:-3*t/6,y:0},{x:d,y:0},{x:d+3*t/6,y:-t},{x:0,y:-t}],i,{cssStyles:h}=e;if(e.look==="handDrawn"){let c=A.svg(a),g=N(e,{}),u=q(o),p=c.path(u,g);i=a.insert(()=>p,":first-child").attr("transform",`translate(${-d/2}, ${t/2})`),h&&i.attr("style",h)}else i=ue(a,d,t,o);return n&&i.attr("style",n),e.width=d,e.height=t,T(e,i),e.intersect=function(c){return B.polygon(e,o,c)},a}w(pa,"lean_right");function ya(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.label="",e.labelStyle=l;let a=r.insert("g").attr("class",j(e)).attr("id",e.domId??e.id),{cssStyles:s}=e,d=Math.max(35,(e==null?void 0:e.width)??0),t=Math.max(35,(e==null?void 0:e.height)??0),o=[{x:d,y:0},{x:0,y:t+7/2},{x:d-14,y:t+7/2},{x:0,y:2*t},{x:d,y:t-7/2},{x:14,y:t-7/2}],i=A.svg(a),h=N(e,{});e.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");let c=q(o),g=i.path(c,h),u=a.insert(()=>g,":first-child");return s&&e.look!=="handDrawn"&&u.selectAll("path").attr("style",s),n&&e.look!=="handDrawn"&&u.selectAll("path").attr("style",n),u.attr("transform",`translate(-${d/2},${-t})`),T(e,u),e.intersect=function(p){return V.info("lightningBolt intersect",e,p),B.polygon(e,o,p)},a}w(ya,"lightningBolt");var Al=w((r,e,l,n,a,s,d)=>[`M${r},${e+s}`,`a${a},${s} 0,0,0 ${l},0`,`a${a},${s} 0,0,0 ${-l},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${l},0`,`l0,${-n}`,`M${r},${e+s+d}`,`a${a},${s} 0,0,0 ${l},0`].join(" "),"createCylinderPathD"),Ll=w((r,e,l,n,a,s,d)=>[`M${r},${e+s}`,`M${r+l},${e+s}`,`a${a},${s} 0,0,0 ${-l},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${l},0`,`l0,${-n}`,`M${r},${e+s+d}`,`a${a},${s} 0,0,0 ${l},0`].join(" "),"createOuterCylinderPathD"),Nl=w((r,e,l,n,a,s)=>[`M${r-l/2},${-n/2}`,`a${a},${s} 0,0,0 ${l},0`].join(" "),"createInnerCylinderPathD");async function fa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0),e.width??0),o=t/2,i=o/(2.5+t/50),h=Math.max(s.height+i+(e.padding??0),e.height??0),c=h*.1,g,{cssStyles:u}=e;if(e.look==="handDrawn"){let p=A.svg(a),y=Ll(0,0,t,h,o,i,c),m=Nl(0,i,t,h,o,i),f=N(e,{}),x=p.path(y,f),b=p.path(m,f);a.insert(()=>b,":first-child").attr("class","line"),g=a.insert(()=>x,":first-child"),g.attr("class","basic label-container"),u&&g.attr("style",u)}else{let p=Al(0,0,t,h,o,i,c);g=a.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",U(u)).attr("style",n)}return g.attr("label-offset-y",i),g.attr("transform",`translate(${-t/2}, ${-(h/2+i)})`),T(e,g),d.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+i-(s.y-(s.top??0))})`),e.intersect=function(p){let y=B.rect(e,p),m=y.x-(e.x??0);if(o!=0&&(Math.abs(m)<(e.width??0)/2||Math.abs(m)==(e.width??0)/2&&Math.abs(y.y-(e.y??0))>(e.height??0)/2-i)){let f=i*i*(1-m*m/(o*o));f>0&&(f=Math.sqrt(f)),f=i-f,p.y-(e.y??0)>0&&(f=-f),y.y+=f}return y},a}w(fa,"linedCylinder");async function ma(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=o/4,h=o+i,{cssStyles:c}=e,g=A.svg(a),u=N(e,{});e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let p=[{x:-t/2-t/2*.1,y:-h/2},{x:-t/2-t/2*.1,y:h/2},...ce(-t/2-t/2*.1,h/2,t/2+t/2*.1,h/2,i,.8),{x:t/2+t/2*.1,y:-h/2},{x:-t/2-t/2*.1,y:-h/2},{x:-t/2,y:-h/2},{x:-t/2,y:h/2*1.1},{x:-t/2,y:-h/2}],y=g.polygon(p.map(f=>[f.x,f.y]),u),m=a.insert(()=>y,":first-child");return m.attr("class","basic label-container"),c&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",c),n&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",n),m.attr("transform",`translate(0,${-i/2})`),d.attr("transform",`translate(${-t/2+(e.padding??0)+t/2*.1/2-(s.x-(s.left??0))},${-o/2+(e.padding??0)-i/2-(s.y-(s.top??0))})`),T(e,m),e.intersect=function(f){return B.polygon(e,p,f)},a}w(ma,"linedWaveEdgedRect");async function xa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=-t/2,h=-o/2,{cssStyles:c}=e,g=A.svg(a),u=N(e,{}),p=[{x:i-5,y:h+5},{x:i-5,y:h+o+5},{x:i+t-5,y:h+o+5},{x:i+t-5,y:h+o},{x:i+t,y:h+o},{x:i+t,y:h+o-5},{x:i+t+5,y:h+o-5},{x:i+t+5,y:h-5},{x:i+5,y:h-5},{x:i+5,y:h},{x:i,y:h},{x:i,y:h+5}],y=[{x:i,y:h+5},{x:i+t-5,y:h+5},{x:i+t-5,y:h+o},{x:i+t,y:h+o},{x:i+t,y:h},{x:i,y:h}];e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=q(p),f=g.path(m,u),x=q(y),b=g.path(x,{...u,fill:"none"}),k=a.insert(()=>b,":first-child");return k.insert(()=>f,":first-child"),k.attr("class","basic label-container"),c&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",c),n&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",n),d.attr("transform",`translate(${-(s.width/2)-5-(s.x-(s.left??0))}, ${-(s.height/2)+5-(s.y-(s.top??0))})`),T(e,k),e.intersect=function(S){return B.polygon(e,p,S)},a}w(xa,"multiRect");async function ba(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=o/4,h=o+i,c=-t/2,g=-h/2,{cssStyles:u}=e,p=ce(c-5,g+h+5,c+t-5,g+h+5,i,.8),y=p==null?void 0:p[p.length-1],m=[{x:c-5,y:g+5},{x:c-5,y:g+h+5},...p,{x:c+t-5,y:y.y-5},{x:c+t,y:y.y-5},{x:c+t,y:y.y-10},{x:c+t+5,y:y.y-10},{x:c+t+5,y:g-5},{x:c+5,y:g-5},{x:c+5,y:g},{x:c,y:g},{x:c,y:g+5}],f=[{x:c,y:g+5},{x:c+t-5,y:g+5},{x:c+t-5,y:y.y-5},{x:c+t,y:y.y-5},{x:c+t,y:g},{x:c,y:g}],x=A.svg(a),b=N(e,{});e.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let k=q(m),S=x.path(k,b),M=q(f),C=x.path(M,b),P=a.insert(()=>S,":first-child");return P.insert(()=>C),P.attr("class","basic label-container"),u&&e.look!=="handDrawn"&&P.selectAll("path").attr("style",u),n&&e.look!=="handDrawn"&&P.selectAll("path").attr("style",n),P.attr("transform",`translate(0,${-i/2})`),d.attr("transform",`translate(${-(s.width/2)-5-(s.x-(s.left??0))}, ${-(s.height/2)+5-i/2-(s.y-(s.top??0))})`),T(e,P),e.intersect=function(_){return B.polygon(e,m,_)},a}w(ba,"multiWaveEdgedRectangle");async function wa(r,e,{config:{themeVariables:l}}){var f;let{labelStyles:n,nodeStyles:a}=R(e);e.labelStyle=n,e.useHtmlLabels||((f=Se().flowchart)==null?void 0:f.htmlLabels)!==!1||(e.centerLabel=!0);let{shapeSvg:s,bbox:d,label:t}=await z(r,e,j(e)),o=Math.max(d.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),i=Math.max(d.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),h=-o/2,c=-i/2,{cssStyles:g}=e,u=A.svg(s),p=N(e,{fill:l.noteBkgColor,stroke:l.noteBorderColor});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=u.rectangle(h,c,o,i,p),m=s.insert(()=>y,":first-child");return m.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",g),a&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",a),t.attr("transform",`translate(${-d.width/2-(d.x-(d.left??0))}, ${-(d.height/2)-(d.y-(d.top??0))})`),T(e,m),e.intersect=function(x){return B.rect(e,x)},s}w(wa,"note");var Tl=w((r,e,l)=>[`M${r+l/2},${e}`,`L${r+l},${e-l/2}`,`L${r+l/2},${e-l}`,`L${r},${e-l/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Sa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=s.width+e.padding+(s.height+e.padding),t=.5,o=[{x:d/2,y:0},{x:d,y:-d/2},{x:d/2,y:-d},{x:0,y:-d/2}],i,{cssStyles:h}=e;if(e.look==="handDrawn"){let c=A.svg(a),g=N(e,{}),u=Tl(0,0,d),p=c.path(u,g);i=a.insert(()=>p,":first-child").attr("transform",`translate(${-d/2+t}, ${d/2})`),h&&i.attr("style",h)}else i=ue(a,d,d,o),i.attr("transform",`translate(${-d/2+t}, ${d/2})`);return n&&i.attr("style",n),T(e,i),e.calcIntersect=function(c,g){let u=c.width,p=[{x:u/2,y:0},{x:u,y:-u/2},{x:u/2,y:-u},{x:0,y:-u/2}],y=B.polygon(c,p,g);return{x:y.x-.5,y:y.y-.5}},e.intersect=function(c){return this.calcIntersect(e,c)},a}w(Sa,"question");async function ka(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0),(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0),(e==null?void 0:e.height)??0),i=-t/2,h=-o/2,c=h/2,g=[{x:i+c,y:h},{x:i,y:0},{x:i+c,y:-h},{x:-i,y:-h},{x:-i,y:h}],{cssStyles:u}=e,p=A.svg(a),y=N(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=q(g),f=p.path(m,y),x=a.insert(()=>f,":first-child");return x.attr("class","basic label-container"),u&&e.look!=="handDrawn"&&x.selectAll("path").attr("style",u),n&&e.look!=="handDrawn"&&x.selectAll("path").attr("style",n),x.attr("transform",`translate(${-c/2},0)`),d.attr("transform",`translate(${-c/2-s.width/2-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),T(e,x),e.intersect=function(b){return B.polygon(e,g,b)},a}w(ka,"rect_left_inv_arrow");async function $a(r,e){var P,_;let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let a;a=e.cssClasses?"node "+e.cssClasses:"node default";let s=r.insert("g").attr("class",a).attr("id",e.domId||e.id),d=s.insert("g"),t=s.insert("g").attr("class","label").attr("style",n),o=e.description,i=e.label,h=t.node().appendChild(await ze(i,e.labelStyle,!0,!0)),c={width:0,height:0};if(Y((_=(P=Z())==null?void 0:P.flowchart)==null?void 0:_.htmlLabels)){let E=h.children[0],I=Q(h);c=E.getBoundingClientRect(),I.attr("width",c.width),I.attr("height",c.height)}V.info("Text 2",o);let g=o||[],u=h.getBBox(),p=t.node().appendChild(await ze(g.join?g.join("<br/>"):g,e.labelStyle,!0,!0)),y=p.children[0],m=Q(p);c=y.getBoundingClientRect(),m.attr("width",c.width),m.attr("height",c.height);let f=(e.padding||0)/2;Q(p).attr("transform","translate( "+(c.width>u.width?0:(u.width-c.width)/2)+", "+(u.height+f+5)+")"),Q(h).attr("transform","translate( "+(c.width<u.width?0:-(u.width-c.width)/2)+", 0)"),c=t.node().getBBox(),t.attr("transform","translate("+-c.width/2+", "+(-c.height/2-f+3)+")");let x=c.width+(e.padding||0),b=c.height+(e.padding||0),k=-c.width/2-f,S=-c.height/2-f,M,C;if(e.look==="handDrawn"){let E=A.svg(s),I=N(e,{}),L=E.path(ge(k,S,x,b,e.rx||0),I),v=E.line(-c.width/2-f,-c.height/2-f+u.height+f,c.width/2+f,-c.height/2-f+u.height+f,I);C=s.insert(()=>(V.debug("Rough node insert CXC",L),v),":first-child"),M=s.insert(()=>(V.debug("Rough node insert CXC",L),L),":first-child")}else M=d.insert("rect",":first-child"),C=d.insert("line"),M.attr("class","outer title-state").attr("style",n).attr("x",-c.width/2-f).attr("y",-c.height/2-f).attr("width",c.width+(e.padding||0)).attr("height",c.height+(e.padding||0)),C.attr("class","divider").attr("x1",-c.width/2-f).attr("x2",c.width/2+f).attr("y1",-c.height/2-f+u.height+f).attr("y2",-c.height/2-f+u.height+f);return T(e,M),e.intersect=function(E){return B.rect(e,E)},s}w($a,"rectWithTitle");function De(r,e,l,n,a,s,d){let t=(r+l)/2,o=(e+n)/2,i=Math.atan2(n-e,l-r),h=(l-r)/2,c=(n-e)/2,g=h/a,u=c/s,p=Math.sqrt(g**2+u**2);if(p>1)throw Error("The given radii are too small to create an arc between the points.");let y=Math.sqrt(1-p**2),m=t+y*s*Math.sin(i)*(d?-1:1),f=o-y*a*Math.cos(i)*(d?-1:1),x=Math.atan2((e-f)/s,(r-m)/a),b=Math.atan2((n-f)/s,(l-m)/a)-x;d&&b<0&&(b+=2*Math.PI),!d&&b>0&&(b-=2*Math.PI);let k=[];for(let S=0;S<20;S++){let M=x+S/19*b,C=m+a*Math.cos(M),P=f+s*Math.sin(M);k.push({x:C,y:P})}return k}w(De,"generateArcPoints");async function Ma(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=(e==null?void 0:e.padding)??0,t=(e==null?void 0:e.padding)??0,o=(e!=null&&e.width?e==null?void 0:e.width:s.width)+d*2,i=(e!=null&&e.height?e==null?void 0:e.height:s.height)+t*2,h=e.radius||5,c=e.taper||5,{cssStyles:g}=e,u=A.svg(a),p=N(e,{});e.stroke&&(p.stroke=e.stroke),e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=[{x:-o/2+c,y:-i/2},{x:o/2-c,y:-i/2},...De(o/2-c,-i/2,o/2,-i/2+c,h,h,!0),{x:o/2,y:-i/2+c},{x:o/2,y:i/2-c},...De(o/2,i/2-c,o/2-c,i/2,h,h,!0),{x:o/2-c,y:i/2},{x:-o/2+c,y:i/2},...De(-o/2+c,i/2,-o/2,i/2-c,h,h,!0),{x:-o/2,y:i/2-c},{x:-o/2,y:-i/2+c},...De(-o/2,-i/2+c,-o/2+c,-i/2,h,h,!0)],m=q(y),f=u.path(m,p),x=a.insert(()=>f,":first-child");return x.attr("class","basic label-container outer-path"),g&&e.look!=="handDrawn"&&x.selectChildren("path").attr("style",g),n&&e.look!=="handDrawn"&&x.selectChildren("path").attr("style",n),T(e,x),e.intersect=function(b){return B.polygon(e,y,b)},a}w(Ma,"roundedRect");async function va(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=(e==null?void 0:e.padding)??0,o=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),i=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),h=-s.width/2-t,c=-s.height/2-t,{cssStyles:g}=e,u=A.svg(a),p=N(e,{});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=[{x:h,y:c},{x:h+o+8,y:c},{x:h+o+8,y:c+i},{x:h-8,y:c+i},{x:h-8,y:c},{x:h,y:c},{x:h,y:c+i}],m=u.polygon(y.map(x=>[x.x,x.y]),p),f=a.insert(()=>m,":first-child");return f.attr("class","basic label-container").attr("style",U(g)),n&&e.look!=="handDrawn"&&f.selectAll("path").attr("style",n),g&&e.look!=="handDrawn"&&f.selectAll("path").attr("style",n),d.attr("transform",`translate(${-o/2+4+(e.padding??0)-(s.x-(s.left??0))},${-i/2+(e.padding??0)-(s.y-(s.top??0))})`),T(e,f),e.intersect=function(x){return B.rect(e,x)},a}w(va,"shadedProcess");async function Da(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=-t/2,h=-o/2,{cssStyles:c}=e,g=A.svg(a),u=N(e,{});e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let p=[{x:i,y:h},{x:i,y:h+o},{x:i+t,y:h+o},{x:i+t,y:h-o/2}],y=q(p),m=g.path(y,u),f=a.insert(()=>m,":first-child");return f.attr("class","basic label-container"),c&&e.look!=="handDrawn"&&f.selectChildren("path").attr("style",c),n&&e.look!=="handDrawn"&&f.selectChildren("path").attr("style",n),f.attr("transform",`translate(0, ${o/4})`),d.attr("transform",`translate(${-t/2+(e.padding??0)-(s.x-(s.left??0))}, ${-o/4+(e.padding??0)-(s.y-(s.top??0))})`),T(e,f),e.intersect=function(x){return B.polygon(e,p,x)},a}w(Da,"slopedRect");async function Ca(r,e){return qe(r,e,{rx:0,ry:0,classes:"",labelPaddingX:e.labelPaddingX??((e==null?void 0:e.padding)||0)*2,labelPaddingY:((e==null?void 0:e.padding)||0)*1})}w(Ca,"squareRect");async function Pa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=s.height+e.padding,t=s.width+d/4+e.padding,o=d/2,{cssStyles:i}=e,h=A.svg(a),c=N(e,{});e.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let g=[{x:-t/2+o,y:-d/2},{x:t/2-o,y:-d/2},...ve(-t/2+o,0,o,50,90,270),{x:t/2-o,y:d/2},...ve(t/2-o,0,o,50,270,450)],u=q(g),p=h.path(u,c),y=a.insert(()=>p,":first-child");return y.attr("class","basic label-container outer-path"),i&&e.look!=="handDrawn"&&y.selectChildren("path").attr("style",i),n&&e.look!=="handDrawn"&&y.selectChildren("path").attr("style",n),T(e,y),e.intersect=function(m){return B.polygon(e,g,m)},a}w(Pa,"stadium");async function Ba(r,e){return qe(r,e,{rx:5,ry:5,classes:"flowchart-node"})}w(Ba,"state");function Aa(r,e,{config:{themeVariables:l}}){let{labelStyles:n,nodeStyles:a}=R(e);e.labelStyle=n;let{cssStyles:s}=e,{lineColor:d,stateBorder:t,nodeBorder:o}=l,i=r.insert("g").attr("class","node default").attr("id",e.domId||e.id),h=A.svg(i),c=N(e,{});e.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let g=h.circle(0,0,14,{...c,stroke:d,strokeWidth:2}),u=t??o,p=h.circle(0,0,5,{...c,fill:u,stroke:u,strokeWidth:2,fillStyle:"solid"}),y=i.insert(()=>g,":first-child");return y.insert(()=>p),s&&y.selectAll("path").attr("style",s),a&&y.selectAll("path").attr("style",a),T(e,y),e.intersect=function(m){return B.circle(e,7,m)},i}w(Aa,"stateEnd");function La(r,e,{config:{themeVariables:l}}){let{lineColor:n}=l,a=r.insert("g").attr("class","node default").attr("id",e.domId||e.id),s;if(e.look==="handDrawn"){let d=A.svg(a).circle(0,0,14,rl(n));s=a.insert(()=>d),s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else s=a.insert("circle",":first-child"),s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return T(e,s),e.intersect=function(d){return B.circle(e,7,d)},a}w(La,"stateStart");async function Na(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=((e==null?void 0:e.padding)||0)/2,t=s.width+e.padding,o=s.height+e.padding,i=-s.width/2-d,h=-s.height/2-d,c=[{x:0,y:0},{x:t,y:0},{x:t,y:-o},{x:0,y:-o},{x:0,y:0},{x:-8,y:0},{x:t+8,y:0},{x:t+8,y:-o},{x:-8,y:-o},{x:-8,y:0}];if(e.look==="handDrawn"){let g=A.svg(a),u=N(e,{}),p=g.rectangle(i-8,h,t+16,o,u),y=g.line(i,h,i,h+o,u),m=g.line(i+t,h,i+t,h+o,u);a.insert(()=>y,":first-child"),a.insert(()=>m,":first-child");let f=a.insert(()=>p,":first-child"),{cssStyles:x}=e;f.attr("class","basic label-container").attr("style",U(x)),T(e,f)}else{let g=ue(a,t,o,c);n&&g.attr("style",n),T(e,g)}return e.intersect=function(g){return B.polygon(e,c,g)},a}w(Na,"subroutine");async function Ta(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),t=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),o=-d/2,i=-t/2,h=.2*t,c=.2*t,{cssStyles:g}=e,u=A.svg(a),p=N(e,{}),y=[{x:o-h/2,y:i},{x:o+d+h/2,y:i},{x:o+d+h/2,y:i+t},{x:o-h/2,y:i+t}],m=[{x:o+d-h/2,y:i+t},{x:o+d+h/2,y:i+t},{x:o+d+h/2,y:i+t-c}];e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=q(y),x=u.path(f,p),b=q(m),k=u.path(b,{...p,fillStyle:"solid"}),S=a.insert(()=>k,":first-child");return S.insert(()=>x,":first-child"),S.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&S.selectAll("path").attr("style",g),n&&e.look!=="handDrawn"&&S.selectAll("path").attr("style",n),T(e,S),e.intersect=function(M){return B.polygon(e,y,M)},a}w(Ta,"taggedRect");async function Ra(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=o/4,h=.2*t,c=.2*o,g=o+i,{cssStyles:u}=e,p=A.svg(a),y=N(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-t/2-t/2*.1,y:g/2},...ce(-t/2-t/2*.1,g/2,t/2+t/2*.1,g/2,i,.8),{x:t/2+t/2*.1,y:-g/2},{x:-t/2-t/2*.1,y:-g/2}],f=-t/2+t/2*.1,x=-g/2-c*.4,b=[{x:f+t-h,y:(x+o)*1.4},{x:f+t,y:x+o-c},{x:f+t,y:(x+o)*.9},...ce(f+t,(x+o)*1.3,f+t-h,(x+o)*1.5,-o*.03,.5)],k=q(m),S=p.path(k,y),M=q(b),C=p.path(M,{...y,fillStyle:"solid"}),P=a.insert(()=>C,":first-child");return P.insert(()=>S,":first-child"),P.attr("class","basic label-container"),u&&e.look!=="handDrawn"&&P.selectAll("path").attr("style",u),n&&e.look!=="handDrawn"&&P.selectAll("path").attr("style",n),P.attr("transform",`translate(0,${-i/2})`),d.attr("transform",`translate(${-t/2+(e.padding??0)-(s.x-(s.left??0))},${-o/2+(e.padding??0)-i/2-(s.y-(s.top??0))})`),T(e,P),e.intersect=function(_){return B.polygon(e,m,_)},a}w(Ra,"taggedWaveEdgedRectangle");async function _a(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(s.width+e.padding,(e==null?void 0:e.width)||0),t=Math.max(s.height+e.padding,(e==null?void 0:e.height)||0),o=-d/2,i=-t/2,h=a.insert("rect",":first-child");return h.attr("class","text").attr("style",n).attr("rx",0).attr("ry",0).attr("x",o).attr("y",i).attr("width",d).attr("height",t),T(e,h),e.intersect=function(c){return B.rect(e,c)},a}w(_a,"text");var Rl=w((r,e,l,n,a,s)=>`M${r},${e}
    a${a},${s} 0,0,1 0,${-n}
    l${l},0
    a${a},${s} 0,0,1 0,${n}
    M${l},${-n}
    a${a},${s} 0,0,0 0,${n}
    l${-l},0`,"createCylinderPathD"),_l=w((r,e,l,n,a,s)=>[`M${r},${e}`,`M${r+l},${e}`,`a${a},${s} 0,0,0 0,${-n}`,`l${-l},0`,`a${a},${s} 0,0,0 0,${n}`,`l${l},0`].join(" "),"createOuterCylinderPathD"),Ol=w((r,e,l,n,a,s)=>[`M${r+l/2},${-n/2}`,`a${a},${s} 0,0,0 0,${n}`].join(" "),"createInnerCylinderPathD");async function Oa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d,halfPadding:t}=await z(r,e,j(e)),o=e.look==="neo"?t*2:t,i=s.height+o,h=i/2,c=h/(2.5+i/50),g=s.width+c+o,{cssStyles:u}=e,p;if(e.look==="handDrawn"){let y=A.svg(a),m=_l(0,0,g,i,c,h),f=Ol(0,0,g,i,c,h),x=y.path(m,N(e,{})),b=y.path(f,N(e,{fill:"none"}));p=a.insert(()=>b,":first-child"),p=a.insert(()=>x,":first-child"),p.attr("class","basic label-container"),u&&p.attr("style",u)}else{let y=Rl(0,0,g,i,c,h);p=a.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",U(u)).attr("style",n),p.attr("class","basic label-container"),u&&p.selectAll("path").attr("style",u),n&&p.selectAll("path").attr("style",n)}return p.attr("label-offset-x",c),p.attr("transform",`translate(${-g/2}, ${i/2} )`),d.attr("transform",`translate(${-(s.width/2)-c-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),T(e,p),e.intersect=function(y){let m=B.rect(e,y),f=m.y-(e.y??0);if(h!=0&&(Math.abs(f)<(e.height??0)/2||Math.abs(f)==(e.height??0)/2&&Math.abs(m.x-(e.x??0))>(e.width??0)/2-c)){let x=c*c*(1-f*f/(h*h));x!=0&&(x=Math.sqrt(Math.abs(x))),x=c-x,y.x-(e.x??0)>0&&(x=-x),m.x+=x}return m},a}w(Oa,"tiltedCylinder");async function Ia(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=s.width+e.padding,t=s.height+e.padding,o=[{x:-3*t/6,y:0},{x:d+3*t/6,y:0},{x:d,y:-t},{x:0,y:-t}],i,{cssStyles:h}=e;if(e.look==="handDrawn"){let c=A.svg(a),g=N(e,{}),u=q(o),p=c.path(u,g);i=a.insert(()=>p,":first-child").attr("transform",`translate(${-d/2}, ${t/2})`),h&&i.attr("style",h)}else i=ue(a,d,t,o);return n&&i.attr("style",n),e.width=d,e.height=t,T(e,i),e.intersect=function(c){return B.polygon(e,o,c)},a}w(Ia,"trapezoid");async function Ea(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(60,s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),t=Math.max(20,s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),{cssStyles:o}=e,i=A.svg(a),h=N(e,{});e.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");let c=[{x:-d/2*.8,y:-t/2},{x:d/2*.8,y:-t/2},{x:d/2,y:-t/2*.6},{x:d/2,y:t/2},{x:-d/2,y:t/2},{x:-d/2,y:-t/2*.6}],g=q(c),u=i.path(g,h),p=a.insert(()=>u,":first-child");return p.attr("class","basic label-container"),o&&e.look!=="handDrawn"&&p.selectChildren("path").attr("style",o),n&&e.look!=="handDrawn"&&p.selectChildren("path").attr("style",n),T(e,p),e.intersect=function(y){return B.polygon(e,c,y)},a}w(Ea,"trapezoidalPentagon");async function Wa(r,e){var x;let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Y((x=Z().flowchart)==null?void 0:x.htmlLabels),o=s.width+(e.padding??0),i=o+s.height,h=o+s.height,c=[{x:0,y:0},{x:h,y:0},{x:h/2,y:-i}],{cssStyles:g}=e,u=A.svg(a),p=N(e,{});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=q(c),m=u.path(y,p),f=a.insert(()=>m,":first-child").attr("transform",`translate(${-i/2}, ${i/2})`);return g&&e.look!=="handDrawn"&&f.selectChildren("path").attr("style",g),n&&e.look!=="handDrawn"&&f.selectChildren("path").attr("style",n),e.width=o,e.height=i,T(e,f),d.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${i/2-(s.height+(e.padding??0)/(t?2:1)-(s.y-(s.top??0)))})`),e.intersect=function(b){return V.info("Triangle intersect",e,c,b),B.polygon(e,c,b)},a}w(Wa,"triangle");async function ja(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=o/8,h=o+i,{cssStyles:c}=e,g=70-t,u=g>0?g/2:0,p=A.svg(a),y=N(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-t/2-u,y:h/2},...ce(-t/2-u,h/2,t/2+u,h/2,i,.8),{x:t/2+u,y:-h/2},{x:-t/2-u,y:-h/2}],f=q(m),x=p.path(f,y),b=a.insert(()=>x,":first-child");return b.attr("class","basic label-container"),c&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",c),n&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",n),b.attr("transform",`translate(0,${-i/2})`),d.attr("transform",`translate(${-t/2+(e.padding??0)-(s.x-(s.left??0))},${-o/2+(e.padding??0)-i-(s.y-(s.top??0))})`),T(e,b),e.intersect=function(k){return B.polygon(e,m,k)},a}w(ja,"waveEdgedRectangle");async function Ha(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s}=await z(r,e,j(e)),d=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),t=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),o=d/t,i=d,h=t;i>h*o?h=i/o:i=h*o,i=Math.max(i,100),h=Math.max(h,50);let c=Math.min(h*.2,h/4),g=h+c*2,{cssStyles:u}=e,p=A.svg(a),y=N(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-i/2,y:g/2},...ce(-i/2,g/2,i/2,g/2,c,1),{x:i/2,y:-g/2},...ce(i/2,-g/2,-i/2,-g/2,c,-1)],f=q(m),x=p.path(f,y),b=a.insert(()=>x,":first-child");return b.attr("class","basic label-container"),u&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",u),n&&e.look!=="handDrawn"&&b.selectAll("path").attr("style",n),T(e,b),e.intersect=function(k){return B.polygon(e,m,k)},a}w(Ha,"waveRectangle");async function za(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,label:d}=await z(r,e,j(e)),t=Math.max(s.width+(e.padding??0)*2,(e==null?void 0:e.width)??0),o=Math.max(s.height+(e.padding??0)*2,(e==null?void 0:e.height)??0),i=-t/2,h=-o/2,{cssStyles:c}=e,g=A.svg(a),u=N(e,{}),p=[{x:i-5,y:h-5},{x:i-5,y:h+o},{x:i+t,y:h+o},{x:i+t,y:h-5}],y=`M${i-5},${h-5} L${i+t},${h-5} L${i+t},${h+o} L${i-5},${h+o} L${i-5},${h-5}
                M${i-5},${h} L${i+t},${h}
                M${i},${h-5} L${i},${h+o}`;e.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=g.path(y,u),f=a.insert(()=>m,":first-child");return f.attr("transform",`translate(${5/2}, ${5/2})`),f.attr("class","basic label-container"),c&&e.look!=="handDrawn"&&f.selectAll("path").attr("style",c),n&&e.look!=="handDrawn"&&f.selectAll("path").attr("style",n),d.attr("transform",`translate(${-(s.width/2)+5/2-(s.x-(s.left??0))}, ${-(s.height/2)+5/2-(s.y-(s.top??0))})`),T(e,f),e.intersect=function(x){return B.polygon(e,p,x)},a}w(za,"windowPane");async function nt(r,e){var Pe,ht,ot,dt,ct;let l=e;if(l.alias&&(e.label=l.alias),e.look==="handDrawn"){let{themeVariables:F}=Se(),{background:G}=F;await nt(r,{...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${G}`]})}let n=Se();e.useHtmlLabels=n.htmlLabels;let a=((Pe=n.er)==null?void 0:Pe.diagramPadding)??10,s=((ht=n.er)==null?void 0:ht.entityPadding)??6,{cssStyles:d}=e,{labelStyles:t,nodeStyles:o}=R(e);if(l.attributes.length===0&&e.label){let F={rx:0,ry:0,labelPaddingX:a,labelPaddingY:a*1.5,classes:""};Be(e.label,n)+F.labelPaddingX*2<n.er.minEntityWidth&&(e.width=n.er.minEntityWidth);let G=await qe(r,e,F);if(!Y(n.htmlLabels)){let re=G.select("text"),ae=(ot=re.node())==null?void 0:ot.getBBox();re.attr("transform",`translate(${-ae.width/2}, 0)`)}return G}n.htmlLabels||(a*=1.25,s*=1.25);let i=j(e);i||(i="node default");let h=r.insert("g").attr("class",i).attr("id",e.domId||e.id),c=await xe(h,e.label??"",n,0,0,["name"],t);c.height+=s;let g=0,u=[],p=[],y=0,m=0,f=0,x=0,b=!0,k=!0;for(let F of l.attributes){let G=await xe(h,F.type,n,0,g,["attribute-type"],t);y=Math.max(y,G.width+a);let re=await xe(h,F.name,n,0,g,["attribute-name"],t);m=Math.max(m,re.width+a);let ae=await xe(h,F.keys.join(),n,0,g,["attribute-keys"],t);f=Math.max(f,ae.width+a);let be=await xe(h,F.comment,n,0,g,["attribute-comment"],t);x=Math.max(x,be.width+a);let oe=Math.max(G.height,re.height,ae.height,be.height)+s;p.push({yOffset:g,rowHeight:oe}),g+=oe}let S=4;f<=a&&(b=!1,f=0,S--),x<=a&&(k=!1,x=0,S--);let M=h.node().getBBox();if(c.width+a*2-(y+m+f+x)>0){let F=c.width+a*2-(y+m+f+x);y+=F/S,m+=F/S,f>0&&(f+=F/S),x>0&&(x+=F/S)}let C=y+m+f+x,P=A.svg(h),_=N(e,{});e.look!=="handDrawn"&&(_.roughness=0,_.fillStyle="solid");let E=0;p.length>0&&(E=p.reduce((F,G)=>F+((G==null?void 0:G.rowHeight)??0),0));let I=Math.max(M.width+a*2,(e==null?void 0:e.width)||0,C),L=Math.max((E??0)+c.height,(e==null?void 0:e.height)||0),v=-I/2,$=-L/2;h.selectAll("g:not(:first-child)").each((F,G,re)=>{let ae=Q(re[G]),be=ae.attr("transform"),oe=0,gt=0;if(be){let Fe=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(be);Fe&&(oe=parseFloat(Fe[1]),gt=parseFloat(Fe[2]),ae.attr("class").includes("attribute-name")?oe+=y:ae.attr("class").includes("attribute-keys")?oe+=y+m:ae.attr("class").includes("attribute-comment")&&(oe+=y+m+f))}ae.attr("transform",`translate(${v+a/2+oe}, ${gt+$+c.height+s/2})`)}),h.select(".name").attr("transform","translate("+-c.width/2+", "+($+s/2)+")");let D=P.rectangle(v,$,I,L,_),O=h.insert(()=>D,":first-child").attr("style",d.join("")),{themeVariables:W}=Se(),{rowEven:X,rowOdd:te,nodeBorder:he}=W;u.push(0);for(let[F,G]of p.entries()){let re=(F+1)%2==0&&G.yOffset!==0,ae=P.rectangle(v,c.height+$+(G==null?void 0:G.yOffset),I,G==null?void 0:G.rowHeight,{..._,fill:re?X:te,stroke:he});h.insert(()=>ae,"g.label").attr("style",d.join("")).attr("class",`row-rect-${re?"even":"odd"}`)}let le=P.line(v,c.height+$,I+v,c.height+$,_);h.insert(()=>le).attr("class","divider"),le=P.line(y+v,c.height+$,y+v,L+$,_),h.insert(()=>le).attr("class","divider"),b&&(le=P.line(y+m+v,c.height+$,y+m+v,L+$,_),h.insert(()=>le).attr("class","divider")),k&&(le=P.line(y+m+f+v,c.height+$,y+m+f+v,L+$,_),h.insert(()=>le).attr("class","divider"));for(let F of u)le=P.line(v,c.height+$+F,I+v,c.height+$+F,_),h.insert(()=>le).attr("class","divider");if(T(e,O),o&&e.look!=="handDrawn"){let F=(ct=(dt=o.split(";"))==null?void 0:dt.filter(G=>G.includes("stroke")))==null?void 0:ct.map(G=>`${G}`).join("; ");h.selectAll("path").attr("style",F??""),h.selectAll(".row-rect-even path").attr("style",o)}return e.intersect=function(F){return B.rect(e,F)},h}w(nt,"erBox");async function xe(r,e,l,n=0,a=0,s=[],d=""){let t=r.insert("g").attr("class",`label ${s.join(" ")}`).attr("transform",`translate(${n}, ${a})`).attr("style",d);e!==ut(e)&&(e=ut(e),e=e.replaceAll("<","&lt;").replaceAll(">","&gt;"));let o=t.node().appendChild(await pe(t,e,{width:Be(e,l)+100,style:d,useHtmlLabels:l.htmlLabels},l));if(e.includes("&lt;")||e.includes("&gt;")){let h=o.children[0];for(h.textContent=h.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");h.childNodes[0];)h=h.childNodes[0],h.textContent=h.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let i=o.getBBox();if(Y(l.htmlLabels)){let h=o.children[0];h.style.textAlign="start";let c=Q(o);i=h.getBoundingClientRect(),c.attr("width",i.width),c.attr("height",i.height)}return i}w(xe,"addText");async function qa(r,e,l,n,a=l.class.padding??12){let s=n?0:3,d=r.insert("g").attr("class",j(e)).attr("id",e.domId||e.id),t=null,o=null,i=null,h=null,c=0,g=0,u=0;if(t=d.insert("g").attr("class","annotation-group text"),e.annotations.length>0){let x=e.annotations[0];await Ce(t,{text:`\xAB${x}\xBB`},0),c=t.node().getBBox().height}o=d.insert("g").attr("class","label-group text"),await Ce(o,e,0,["font-weight: bolder"]);let p=o.node().getBBox();g=p.height,i=d.insert("g").attr("class","members-group text");let y=0;for(let x of e.members){let b=await Ce(i,x,y,[x.parseClassifier()]);y+=b+s}u=i.node().getBBox().height,u<=0&&(u=a/2),h=d.insert("g").attr("class","methods-group text");let m=0;for(let x of e.methods){let b=await Ce(h,x,m,[x.parseClassifier()]);m+=b+s}let f=d.node().getBBox();if(t!==null){let x=t.node().getBBox();t.attr("transform",`translate(${-x.width/2})`)}return o.attr("transform",`translate(${-p.width/2}, ${c})`),f=d.node().getBBox(),i.attr("transform",`translate(0, ${c+g+a*2})`),f=d.node().getBBox(),h.attr("transform",`translate(0, ${c+g+(u?u+a*4:a*2)})`),f=d.node().getBBox(),{shapeSvg:d,bbox:f}}w(qa,"textHelper");async function Ce(r,e,l,n=[]){let a=r.insert("g").attr("class","label").attr("style",n.join("; ")),s=Se(),d="useHtmlLabels"in e?e.useHtmlLabels:Y(s.htmlLabels)??!0,t="";t="text"in e?e.text:e.label,!d&&t.startsWith("\\")&&(t=t.substring(1)),yt(t)&&(d=!0);let o=await pe(a,pt(we(t)),{width:Be(t,s)+50,classes:"markdown-node-label",useHtmlLabels:d},s),i,h=1;if(d){let c=o.children[0],g=Q(o);h=c.innerHTML.split("<br>").length,c.innerHTML.includes("</math>")&&(h+=c.innerHTML.split("<mrow>").length-1);let u=c.getElementsByTagName("img");if(u){let p=t.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...u].map(y=>new Promise(m=>{function f(){var x;if(y.style.display="flex",y.style.flexDirection="column",p){let b=((x=s.fontSize)==null?void 0:x.toString())??window.getComputedStyle(document.body).fontSize,k=parseInt(b,10)*5+"px";y.style.minWidth=k,y.style.maxWidth=k}else y.style.width="100%";m(y)}w(f,"setupImage"),setTimeout(()=>{y.complete&&f()}),y.addEventListener("error",f),y.addEventListener("load",f)})))}i=c.getBoundingClientRect(),g.attr("width",i.width),g.attr("height",i.height)}else{n.includes("font-weight: bolder")&&Q(o).selectAll("tspan").attr("font-weight",""),h=o.children.length;let c=o.children[0];(o.textContent===""||o.textContent.includes("&gt"))&&(c.textContent=t[0]+t.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),t[1]===" "&&(c.textContent=c.textContent[0]+" "+c.textContent.substring(1))),c.textContent==="undefined"&&(c.textContent=""),i=o.getBBox()}return a.attr("transform","translate(0,"+(-i.height/(2*h)+l)+")"),i.height}w(Ce,"addText");async function Va(r,e){var _,E;let l=Z(),n=l.class.padding??12,a=n,s=e.useHtmlLabels??Y(l.htmlLabels)??!0,d=e;d.annotations=d.annotations??[],d.members=d.members??[],d.methods=d.methods??[];let{shapeSvg:t,bbox:o}=await qa(r,e,l,s,a),{labelStyles:i,nodeStyles:h}=R(e);e.labelStyle=i,e.cssStyles=d.styles||"";let c=((_=d.styles)==null?void 0:_.join(";"))||h||"";e.cssStyles||(e.cssStyles=c.replaceAll("!important","").split(";"));let g=d.members.length===0&&d.methods.length===0&&!((E=l.class)!=null&&E.hideEmptyMembersBox),u=A.svg(t),p=N(e,{});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let y=o.width,m=o.height;d.members.length===0&&d.methods.length===0?m+=a:d.members.length>0&&d.methods.length===0&&(m+=a*2);let f=-y/2,x=-m/2,b=u.rectangle(f-n,x-n-(g?n:d.members.length===0&&d.methods.length===0?-n/2:0),y+2*n,m+2*n+(g?n*2:d.members.length===0&&d.methods.length===0?-n:0),p),k=t.insert(()=>b,":first-child");k.attr("class","basic label-container");let S=k.node().getBBox();t.selectAll(".text").each((I,L,v)=>{var te;let $=Q(v[L]),D=$.attr("transform"),O=0;if(D){let he=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(D);he&&(O=parseFloat(he[2]))}let W=O+x+n-(g?n:d.members.length===0&&d.methods.length===0?-n/2:0);s||(W-=4);let X=f;($.attr("class").includes("label-group")||$.attr("class").includes("annotation-group"))&&(X=-((te=$.node())==null?void 0:te.getBBox().width)/2||0,t.selectAll("text").each(function(he,le,Pe){window.getComputedStyle(Pe[le]).textAnchor==="middle"&&(X=0)})),$.attr("transform",`translate(${X}, ${W})`)});let M=t.select(".annotation-group").node().getBBox().height-(g?n/2:0)||0,C=t.select(".label-group").node().getBBox().height-(g?n/2:0)||0,P=t.select(".members-group").node().getBBox().height-(g?n/2:0)||0;if(d.members.length>0||d.methods.length>0||g){let I=u.line(S.x,M+C+x+n,S.x+S.width,M+C+x+n,p);t.insert(()=>I).attr("class","divider").attr("style",c)}if(g||d.members.length>0||d.methods.length>0){let I=u.line(S.x,M+C+P+x+a*2+n,S.x+S.width,M+C+P+x+n+a*2,p);t.insert(()=>I).attr("class","divider").attr("style",c)}if(d.look!=="handDrawn"&&t.selectAll("path").attr("style",c),k.select(":nth-child(2)").attr("style",c),t.selectAll(".divider").select("path").attr("style",c),e.labelStyle?t.selectAll("span").attr("style",e.labelStyle):t.selectAll("span").attr("style",c),!s){let I=RegExp(/color\s*:\s*([^;]*)/),L=I.exec(c);if(L){let v=L[0].replace("color","fill");t.selectAll("tspan").attr("style",v)}else if(i){let v=I.exec(i);if(v){let $=v[0].replace("color","fill");t.selectAll("tspan").attr("style",$)}}}return T(e,k),e.intersect=function(I){return B.rect(e,I)},t}w(Va,"classBox");async function Fa(r,e){var k,S;let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let a=e,s=e,d="verifyMethod"in e,t=j(e),o=r.insert("g").attr("class",t).attr("id",e.domId??e.id),i;i=d?await se(o,`&lt;&lt;${a.type}&gt;&gt;`,0,e.labelStyle):await se(o,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle);let h=i,c=await se(o,a.name,h,e.labelStyle+"; font-weight: bold;");if(h+=c+20,d){let M=await se(o,`${a.requirementId?`ID: ${a.requirementId}`:""}`,h,e.labelStyle);h+=M;let C=await se(o,`${a.text?`Text: ${a.text}`:""}`,h,e.labelStyle);h+=C;let P=await se(o,`${a.risk?`Risk: ${a.risk}`:""}`,h,e.labelStyle);h+=P,await se(o,`${a.verifyMethod?`Verification: ${a.verifyMethod}`:""}`,h,e.labelStyle)}else{let M=await se(o,`${s.type?`Type: ${s.type}`:""}`,h,e.labelStyle);h+=M,await se(o,`${s.docRef?`Doc Ref: ${s.docRef}`:""}`,h,e.labelStyle)}let g=(((k=o.node())==null?void 0:k.getBBox().width)??200)+20,u=(((S=o.node())==null?void 0:S.getBBox().height)??200)+20,p=-g/2,y=-u/2,m=A.svg(o),f=N(e,{});e.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let x=m.rectangle(p,y,g,u,f),b=o.insert(()=>x,":first-child");if(b.attr("class","basic label-container").attr("style",n),o.selectAll(".label").each((M,C,P)=>{let _=Q(P[C]),E=_.attr("transform"),I=0,L=0;if(E){let D=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(E);D&&(I=parseFloat(D[1]),L=parseFloat(D[2]))}let v=L-u/2,$=p+20/2;(C===0||C===1)&&($=I),_.attr("transform",`translate(${$}, ${v+20})`)}),h>i+c+20){let M=m.line(p,y+i+c+20,p+g,y+i+c+20,f);o.insert(()=>M).attr("style",n)}return T(e,b),e.intersect=function(M){return B.rect(e,M)},o}w(Fa,"requirementBox");async function se(r,e,l,n=""){if(e==="")return 0;let a=r.insert("g").attr("class","label").attr("style",n),s=Z(),d=s.htmlLabels??!0,t=await pe(a,pt(we(e)),{width:Be(e,s)+50,classes:"markdown-node-label",useHtmlLabels:d,style:n},s),o;if(d){let i=t.children[0],h=Q(t);o=i.getBoundingClientRect(),h.attr("width",o.width),h.attr("height",o.height)}else{let i=t.children[0];for(let h of i.children)h.textContent=h.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),n&&h.setAttribute("style",n);o=t.getBBox(),o.height+=6}return a.attr("transform",`translate(${-o.width/2},${-o.height/2+l})`),o.height}w(se,"addText");var Il=w(r=>{switch(r){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Ga(r,e,{config:l}){var E,I;let{labelStyles:n,nodeStyles:a}=R(e);e.labelStyle=n||"";let s=e.width;e.width=(e.width??200)-10;let{shapeSvg:d,bbox:t,label:o}=await z(r,e,j(e)),i=e.padding||10,h="",c;"ticket"in e&&e.ticket&&((E=l==null?void 0:l.kanban)!=null&&E.ticketBaseUrl)&&(h=(I=l==null?void 0:l.kanban)==null?void 0:I.ticketBaseUrl.replace("#TICKET#",e.ticket),c=d.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",h).attr("target","_blank"));let g={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1},u,p;c?{label:u,bbox:p}=await lt(c,"ticket"in e&&e.ticket||"",g):{label:u,bbox:p}=await lt(d,"ticket"in e&&e.ticket||"",g);let{label:y,bbox:m}=await lt(d,"assigned"in e&&e.assigned||"",g);e.width=s;let f=(e==null?void 0:e.width)||0,x=Math.max(p.height,m.height)/2,b=Math.max(t.height+20,(e==null?void 0:e.height)||0)+x,k=-f/2,S=-b/2;o.attr("transform","translate("+(i-f/2)+", "+(-x-t.height/2)+")"),u.attr("transform","translate("+(i-f/2)+", "+(-x+t.height/2)+")"),y.attr("transform","translate("+(i+f/2-m.width-20)+", "+(-x+t.height/2)+")");let M,{rx:C,ry:P}=e,{cssStyles:_}=e;if(e.look==="handDrawn"){let L=A.svg(d),v=N(e,{}),$=C||P?L.path(ge(k,S,f,b,C||0),v):L.rectangle(k,S,f,b,v);M=d.insert(()=>$,":first-child"),M.attr("class","basic label-container").attr("style",_||null)}else{M=d.insert("rect",":first-child"),M.attr("class","basic label-container __APA__").attr("style",a).attr("rx",C??5).attr("ry",P??5).attr("x",k).attr("y",S).attr("width",f).attr("height",b);let L="priority"in e&&e.priority;if(L){let v=d.append("line"),$=k+2,D=S+Math.floor((C??0)/2),O=S+b-Math.floor((C??0)/2);v.attr("x1",$).attr("y1",D).attr("x2",$).attr("y2",O).attr("stroke-width","4").attr("stroke",Il(L))}}return T(e,M),e.height=b,e.intersect=function(L){return B.rect(e,L)},d}w(Ga,"kanbanItem");async function Za(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,halfPadding:d,label:t}=await z(r,e,j(e)),o=s.width+10*d,i=s.height+8*d,h=.15*o,{cssStyles:c}=e,g=s.width+20,u=s.height+20,p=Math.max(o,g),y=Math.max(i,u);t.attr("transform",`translate(${-s.width/2}, ${-s.height/2})`);let m,f=`M0 0 
    a${h},${h} 1 0,0 ${p*.25},${-1*y*.1}
    a${h},${h} 1 0,0 ${p*.25},0
    a${h},${h} 1 0,0 ${p*.25},0
    a${h},${h} 1 0,0 ${p*.25},${y*.1}

    a${h},${h} 1 0,0 ${p*.15},${y*.33}
    a${h*.8},${h*.8} 1 0,0 0,${y*.34}
    a${h},${h} 1 0,0 ${-1*p*.15},${y*.33}

    a${h},${h} 1 0,0 ${-1*p*.25},${y*.15}
    a${h},${h} 1 0,0 ${-1*p*.25},0
    a${h},${h} 1 0,0 ${-1*p*.25},0
    a${h},${h} 1 0,0 ${-1*p*.25},${-1*y*.15}

    a${h},${h} 1 0,0 ${-1*p*.1},${-1*y*.33}
    a${h*.8},${h*.8} 1 0,0 0,${-1*y*.34}
    a${h},${h} 1 0,0 ${p*.1},${-1*y*.33}
  H0 V0 Z`;if(e.look==="handDrawn"){let x=A.svg(a),b=N(e,{}),k=x.path(f,b);m=a.insert(()=>k,":first-child"),m.attr("class","basic label-container").attr("style",U(c))}else m=a.insert("path",":first-child").attr("class","basic label-container").attr("style",n).attr("d",f);return m.attr("transform",`translate(${-p/2}, ${-y/2})`),T(e,m),e.calcIntersect=function(x,b){return B.rect(x,b)},e.intersect=function(x){return V.info("Bang intersect",e,x),B.rect(e,x)},a}w(Za,"bang");async function Xa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,halfPadding:d,label:t}=await z(r,e,j(e)),o=s.width+2*d,i=s.height+2*d,h=.15*o,c=.25*o,g=.35*o,u=.2*o,{cssStyles:p}=e,y,m=`M0 0 
    a${h},${h} 0 0,1 ${o*.25},${-1*o*.1}
    a${g},${g} 1 0,1 ${o*.4},${-1*o*.1}
    a${c},${c} 1 0,1 ${o*.35},${o*.2}

    a${h},${h} 1 0,1 ${o*.15},${i*.35}
    a${u},${u} 1 0,1 ${-1*o*.15},${i*.65}

    a${c},${h} 1 0,1 ${-1*o*.25},${o*.15}
    a${g},${g} 1 0,1 ${-1*o*.5},0
    a${h},${h} 1 0,1 ${-1*o*.25},${-1*o*.15}

    a${h},${h} 1 0,1 ${-1*o*.1},${-1*i*.35}
    a${u},${u} 1 0,1 ${o*.1},${-1*i*.65}
  H0 V0 Z`;if(e.look==="handDrawn"){let f=A.svg(a),x=N(e,{}),b=f.path(m,x);y=a.insert(()=>b,":first-child"),y.attr("class","basic label-container").attr("style",U(p))}else y=a.insert("path",":first-child").attr("class","basic label-container").attr("style",n).attr("d",m);return t.attr("transform",`translate(${-s.width/2}, ${-s.height/2})`),y.attr("transform",`translate(${-o/2}, ${-i/2})`),T(e,y),e.calcIntersect=function(f,x){return B.rect(f,x)},e.intersect=function(f){return V.info("Cloud intersect",e,f),B.rect(e,f)},a}w(Xa,"cloud");async function Qa(r,e){let{labelStyles:l,nodeStyles:n}=R(e);e.labelStyle=l;let{shapeSvg:a,bbox:s,halfPadding:d,label:t}=await z(r,e,j(e)),o=s.width+8*d,i=s.height+2*d,h=`
    M${-o/2} ${i/2-5}
    v${-i+10}
    q0,-5 5,-5
    h${o-10}
    q5,0 5,5
    v${i-10}
    q0,5 -5,5
    h${-o+10}
    q-5,0 -5,-5
    Z
  `,c=a.append("path").attr("id","node-"+e.id).attr("class","node-bkg node-"+e.type).attr("style",n).attr("d",h);return a.append("line").attr("class","node-line-").attr("x1",-o/2).attr("y1",i/2).attr("x2",o/2).attr("y2",i/2),t.attr("transform",`translate(${-s.width/2}, ${-s.height/2})`),a.append(()=>t.node()),T(e,c),e.calcIntersect=function(g,u){return B.rect(g,u)},e.intersect=function(g){return B.rect(e,g)},a}w(Qa,"defaultMindmapNode");async function Ja(r,e){return it(r,e,{padding:e.padding??0})}w(Ja,"mindmapCircle");var El=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Ca},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Ma},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Pa},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Na},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Yt},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:it},{semanticName:"Bang",name:"Bang",shortName:"bang",description:"Bang",aliases:["bang"],handler:Za},{semanticName:"Cloud",name:"Cloud",shortName:"cloud",description:"cloud",aliases:["cloud"],handler:Xa},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Sa},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:ra},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:pa},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:ua},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Ia},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:ca},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:Kt},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:_a},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:qt},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:va},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:La},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:Aa},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:aa},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:sa},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Zt},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Xt},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:Qt},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:ya},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:ja},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:la},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Oa},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:fa},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:Jt},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:Ut},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Wa},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:za},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:ea},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Ea},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ta},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Da},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:ba},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:xa},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:zt},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Gt},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Ra},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Ta},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Ha},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:ka},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:ma}],Ya=w(()=>{let r={state:Ba,choice:Vt,note:wa,rectWithTitle:$a,labelRect:ga,iconSquare:oa,iconCircle:na,icon:ia,iconRounded:ha,imageSquare:da,anchor:Ht,kanbanItem:Ga,mindmapCircle:Ja,defaultMindmapNode:Qa,classBox:Va,erBox:nt,requirementBox:Fa},e=[...Object.entries(r),...El.flatMap(l=>[l.shortName,..."aliases"in l?l.aliases:[],..."internalAliases"in l?l.internalAliases:[]].map(n=>[n,l.handler]))];return Object.fromEntries(e)},"generateShapeMap")();function Ua(r){return r in Ya}w(Ua,"isValidShape");var Ve=new Map;async function Ka(r,e,l){let n,a;e.shape==="rect"&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");let s=e.shape?Ya[e.shape]:void 0;if(!s)throw Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let d;l.config.securityLevel==="sandbox"?d="_top":e.linkTarget&&(d=e.linkTarget||"_blank"),n=r.insert("svg:a").attr("xlink:href",e.link).attr("target",d??null),a=await s(n,e,l)}else a=await s(r,e,l),n=a;return e.tooltip&&a.attr("title",e.tooltip),Ve.set(e.id,n),e.haveCallback&&n.attr("class",n.attr("class")+" clickable"),n}w(Ka,"insertNode");var Wl=w((r,e)=>{Ve.set(e.id,r)},"setNodeElem"),jl=w(()=>{Ve.clear()},"clear"),Hl=w(r=>{let e=Ve.get(r.id);V.trace("Transforming node",r.diff,r,"translate("+(r.x-r.width/2-5)+", "+r.width/2+")");let l=r.diff||0;return r.clusterNode?e.attr("transform","translate("+(r.x+l-r.width/2)+", "+(r.y-r.height/2-8)+")"):e.attr("transform","translate("+r.x+", "+r.y+")"),l},"positionNode");export{Ka as a,Hl as c,A as d,kl as i,Wl as l,jl as n,Ua as o,ze as r,z as s,$l as t,T as u};
