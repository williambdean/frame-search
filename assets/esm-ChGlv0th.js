import{s as P}from"./chunk-DZLz74EQ.js";import{t as lt}from"./react-BcIddLXZ.js";import{t as ht}from"./jsx-runtime-DvsdsEjx.js";import{B as j,E as ut,F as dt,Gt as mt,K as e,Mt as ft,N as pt,Rt as A,St as gt,Tt as bt,_ as J,_t as vt,a as St,bt as G,dt as kt,gt as yt,lt as Ct,m as xt,rt as b,ut as V,vt as q,w as wt,wt as Et}from"./dist-BPcMnGQn.js";import{C as Tt,_ as Q,c as Wt,g as X,l as Mt,r as Lt,y as Y}from"./dist-pZAIwcZo.js";import{a as Nt,c as Bt,i as Ht,r as Ot}from"./dist-C13bkrcz.js";import{t as Kt}from"./extends-C-tvimwN.js";import{t as Dt}from"./objectWithoutPropertiesLoose-DDvr5cHq.js";var Z=function(t){t===void 0&&(t={});var{crosshairCursor:i=!1}=t,a=[];t.closeBracketsKeymap!==!1&&(a=a.concat(Nt)),t.defaultKeymap!==!1&&(a=a.concat(X)),t.searchKeymap!==!1&&(a=a.concat(Mt)),t.historyKeymap!==!1&&(a=a.concat(Y)),t.foldKeymap!==!1&&(a=a.concat(ut)),t.completionKeymap!==!1&&(a=a.concat(Bt)),t.lintKeymap!==!1&&(a=a.concat(Lt));var o=[];return t.lineNumbers!==!1&&o.push(gt()),t.highlightActiveLineGutter!==!1&&o.push(vt()),t.highlightSpecialChars!==!1&&o.push(q()),t.history!==!1&&o.push(Q()),t.foldGutter!==!1&&o.push(wt()),t.drawSelection!==!1&&o.push(V()),t.dropCursor!==!1&&o.push(kt()),t.allowMultipleSelections!==!1&&o.push(A.allowMultipleSelections.of(!0)),t.indentOnInput!==!1&&o.push(pt()),t.syntaxHighlighting!==!1&&o.push(j(J,{fallback:!0})),t.bracketMatching!==!1&&o.push(xt()),t.closeBrackets!==!1&&o.push(Ht()),t.autocompletion!==!1&&o.push(Ot()),t.rectangularSelection!==!1&&o.push(bt()),i!==!1&&o.push(Ct()),t.highlightActiveLine!==!1&&o.push(yt()),t.highlightSelectionMatches!==!1&&o.push(Wt()),t.tabSize&&typeof t.tabSize=="number"&&o.push(dt.of(" ".repeat(t.tabSize))),o.concat([G.of(a.flat())]).filter(Boolean)},zt=function(t){t===void 0&&(t={});var i=[];t.defaultKeymap!==!1&&(i=i.concat(X)),t.historyKeymap!==!1&&(i=i.concat(Y));var a=[];return t.highlightSpecialChars!==!1&&a.push(q()),t.history!==!1&&a.push(Q()),t.drawSelection!==!1&&a.push(V()),t.syntaxHighlighting!==!1&&a.push(j(J,{fallback:!0})),a.concat([G.of(i.flat())]).filter(Boolean)},At="#e5c07b",$="#e06c75",Ft="#56b6c2",_t="#ffffff",F="#abb2bf",U="#7d8799",It="#61afef",jt="#98c379",tt="#d19a66",Gt="#c678dd",Ut="#21252b",et="#2c313a",at="#282c34",R="#353a42",Rt="#3E4451",ot="#528bff",Pt=[b.theme({"&":{color:F,backgroundColor:at},".cm-content":{caretColor:ot},".cm-cursor, .cm-dropCursor":{borderLeftColor:ot},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Rt},".cm-panels":{backgroundColor:Ut,color:F},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:at,color:U,border:"none"},".cm-activeLineGutter":{backgroundColor:et},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:R},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:R,borderBottomColor:R},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:et,color:F}}},{dark:!0}),j(St.define([{tag:e.keyword,color:Gt},{tag:[e.name,e.deleted,e.character,e.propertyName,e.macroName],color:$},{tag:[e.function(e.variableName),e.labelName],color:It},{tag:[e.color,e.constant(e.name),e.standard(e.name)],color:tt},{tag:[e.definition(e.name),e.separator],color:F},{tag:[e.typeName,e.className,e.number,e.changed,e.annotation,e.modifier,e.self,e.namespace],color:At},{tag:[e.operator,e.operatorKeyword,e.url,e.escape,e.regexp,e.link,e.special(e.string)],color:Ft},{tag:[e.meta,e.comment],color:U},{tag:e.strong,fontWeight:"bold"},{tag:e.emphasis,fontStyle:"italic"},{tag:e.strikethrough,textDecoration:"line-through"},{tag:e.link,color:U,textDecoration:"underline"},{tag:e.heading,fontWeight:"bold",color:$},{tag:[e.atom,e.bool,e.special(e.variableName)],color:tt},{tag:[e.processingInstruction,e.string,e.inserted],color:jt},{tag:e.invalid,color:_t}]))],Jt=b.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),it=function(t){t===void 0&&(t={});var{indentWithTab:i=!0,editable:a=!0,readOnly:o=!1,theme:f="light",placeholder:p="",basicSetup:l=!0}=t,n=[];switch(i&&n.unshift(G.of([Tt])),l&&(typeof l=="boolean"?n.unshift(Z()):n.unshift(Z(l))),p&&n.unshift(Et(p)),f){case"light":n.push(Jt);break;case"dark":n.push(Pt);break;case"none":break;default:n.push(f);break}return a===!1&&n.push(b.editable.of(!1)),o&&n.push(A.readOnly.of(!0)),[...n]},Vt=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(i=>t.state.sliceDoc(i.from,i.to)),selectedText:t.state.selection.ranges.some(i=>!i.empty)}),qt=class{constructor(t,i){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=i,this.timeoutMS=i,this.callbacks.push(t)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var t=this.callbacks.slice();this.callbacks.length=0,t.forEach(i=>{try{i()}catch(a){console.error("TimeoutLatch callback error:",a)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}},rt=class{constructor(){this.interval=null,this.latches=new Set}add(t){this.latches.add(t),this.start()}remove(t){this.latches.delete(t),this.latches.size===0&&this.stop()}start(){this.interval===null&&(this.interval=setInterval(()=>{this.latches.forEach(t=>{t.tick(),t.isDone&&this.remove(t)})},1))}stop(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}},nt=null,Qt=()=>typeof window>"u"?new rt:(nt||(nt=new rt),nt),s=P(lt()),st=ft.define(),Xt=200,Yt=[];function Zt(t){var{value:i,selection:a,onChange:o,onStatistics:f,onCreateEditor:p,onUpdate:l,extensions:n=Yt,autoFocus:w,theme:E="light",height:T=null,minHeight:v=null,maxHeight:W=null,width:M=null,minWidth:L=null,maxWidth:N=null,placeholder:B="",editable:H=!0,readOnly:O=!1,indentWithTab:K=!0,basicSetup:D=!0,root:_,initialState:C}=t,[S,z]=(0,s.useState)(),[r,d]=(0,s.useState)(),[k,y]=(0,s.useState)(),c=(0,s.useState)(()=>({current:null}))[0],g=(0,s.useState)(()=>({current:null}))[0],I=b.theme({"&":{height:T,minHeight:v,maxHeight:W,width:M,minWidth:L,maxWidth:N},"& .cm-scroller":{height:"100% !important"}}),m=[b.updateListener.of(h=>{h.docChanged&&typeof o=="function"&&!h.transactions.some(u=>u.annotation(st))&&(c.current?c.current.reset():(c.current=new qt(()=>{if(g.current){var u=g.current;g.current=null,u()}c.current=null},Xt),Qt().add(c.current)),o(h.state.doc.toString(),h)),f&&f(Vt(h))}),I,...it({theme:E,editable:H,readOnly:O,placeholder:B,indentWithTab:K,basicSetup:D})];return l&&typeof l=="function"&&m.push(b.updateListener.of(l)),m=m.concat(n),(0,s.useLayoutEffect)(()=>{if(S&&!k){var h={doc:i,selection:a,extensions:m},u=C?A.fromJSON(C.json,h,C.fields):A.create(h);if(y(u),!r){var x=new b({state:u,parent:S,root:_});d(x),p&&p(x,u)}}return()=>{r&&(y(void 0),d(void 0))}},[S,k]),(0,s.useEffect)(()=>{t.container&&z(t.container)},[t.container]),(0,s.useEffect)(()=>()=>{r&&(r.destroy(),d(void 0)),c.current&&(c.current=(c.current.cancel(),null))},[r]),(0,s.useEffect)(()=>{w&&r&&r.focus()},[w,r]),(0,s.useEffect)(()=>{r&&r.dispatch({effects:mt.reconfigure.of(m)})},[E,n,T,v,W,M,L,N,B,H,O,K,D,o,l]),(0,s.useEffect)(()=>{if(i!==void 0){var h=r?r.state.doc.toString():"";if(r&&i!==h){var u=c.current&&!c.current.isDone,x=()=>{r&&i!==r.state.doc.toString()&&r.dispatch({changes:{from:0,to:r.state.doc.toString().length,insert:i||""},annotations:[st.of(!0)]})};u?g.current=x:x()}}},[i,r]),{state:k,setState:y,view:r,setView:d,container:S,setContainer:z}}var $t=P(ht()),te=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],ct=(0,s.forwardRef)((t,i)=>{var{className:a,value:o="",selection:f,extensions:p=[],onChange:l,onStatistics:n,onCreateEditor:w,onUpdate:E,autoFocus:T,theme:v="light",height:W,minHeight:M,maxHeight:L,width:N,minWidth:B,maxWidth:H,basicSetup:O,placeholder:K,indentWithTab:D,editable:_,readOnly:C,root:S,initialState:z}=t,r=Dt(t,te),d=(0,s.useRef)(null),{state:k,view:y,container:c,setContainer:g}=Zt({root:S,value:o,autoFocus:T,theme:v,height:W,minHeight:M,maxHeight:L,width:N,minWidth:B,maxWidth:H,basicSetup:O,placeholder:K,indentWithTab:D,editable:_,readOnly:C,selection:f,onChange:l,onStatistics:n,onCreateEditor:w,onUpdate:E,extensions:p,initialState:z});(0,s.useImperativeHandle)(i,()=>({editor:d.current,state:k,view:y}),[d,c,k,y]);var I=(0,s.useCallback)(m=>{d.current=m,g(m)},[g]);if(typeof o!="string")throw Error("value must be typeof string but got "+typeof o);return(0,$t.jsx)("div",Kt({ref:I,className:(typeof v=="string"?"cm-theme-"+v:"cm-theme")+(a?" "+a:"")},r))});ct.displayName="CodeMirror";var ee=ct;export{it as n,zt as r,ee as t};
