import{s as w}from"./chunk-DZLz74EQ.js";import"./jotai-DDOP7CKM.js";import{t as P}from"./react-BcIddLXZ.js";import{E as W}from"./cells-B6jS0AIj.js";import"./react-dom-D6bRRS5R.js";import"./zod-U2NFpcFA.js";import{n as T,t as H}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-D5Z9rM2X.js";import"./isSymbol-xTSywenE.js";import"./_arrayMap-DQI2GUNb.js";import"./toString-CBnct2wx.js";import"./toNumber-CTOPJrpu.js";import"./toInteger-Bor4StOs.js";import"./isArrayLikeObject-DKyJYtr8.js";import"./_getTag-CVRrQL_Q.js";import"./_baseIsEqual-BF8660ot.js";import"./merge-BgA7kxZb.js";import"./_baseSlice-B27Cqkm6.js";import"./upperFirst-DOlTOwhh.js";import"./_hasUnicode-CPHpt5EV.js";import"./_arrayReduce-DDpPg0Qh.js";import"./startCase-DOk4LYuA.js";import"./_baseProperty-CIKnF2iY.js";import"./now-B6JN1xKT.js";import"./debounce-70y9MzDK.js";import"./hotkeys-Lbk6RHir.js";import"./invariant-DPGusy7Z.js";import"./utils-DnJCRgaX.js";import{t as M}from"./constants-DIZnpo2K.js";import"./config-BjdJmdrN.js";import{n as G}from"./useEventListener-C5BS4xuN.js";import{t as J}from"./cn-C5VTNYKf.js";import{t as S}from"./button-nRVaalxL.js";import{rt as $}from"./dist-BPcMnGQn.js";import"./dist-pZAIwcZo.js";import"./once-Co7xi2Ip.js";import"./capabilities-DdXtcIOa.js";import"./createReducer-80xvKyHq.js";import{r as A}from"./requests-D3Z6okhb.js";import"./preload-helper-BpItL31i.js";import"./dist-C13bkrcz.js";import"./dist-DZNGKufD.js";import"./dist-DBeOBCHw.js";import"./dist-Ba10OKR3.js";import"./dist-D-CsU-_R.js";import"./dist-ClBFnEcy.js";import"./stex-LEaAsvUb.js";import"./Deferred-zIiWPYX3.js";import"./uuid-Dj56ryH_.js";import"./key-DWQdrH_J.js";import{t as B}from"./use-toast-BiL_AQz9.js";import"./main-CD7jouuS.js";import"./marked.esm-DCf1d_lA.js";import"./connection-DnLUBy9M.js";import"./dist-Q3T6mWQ0.js";import{r as D}from"./useTheme-BMknLtnH.js";import"./createLucideIcon-DA8ZBm4D.js";import{t as E}from"./between-horizontal-start-T2r-KWkg.js";import"./type-Cpth3na1.js";import"./check-BUgsJwxM.js";import{h as K}from"./select-DJ0A_oCR.js";import"./toDate-sQp07c5U.js";import"./copy-CWjpIcfl.js";import{t as L}from"./spinner-FaMZ5NTl.js";import{t as R}from"./plus-CmzxQYgQ.js";import{r as U}from"./input-BPw9p_8N.js";import"./useNonce-DECX9FAH.js";import"./badge-CFi0nvIx.js";import"./Combination-DR4iFoRS.js";import"./dist-Cei_8ikW.js";import{t as V}from"./tooltip-BQKXsEoT.js";import"./useLifecycle-CuZnZLRp.js";import"./menu-items-DOc2hwO2.js";import"./tslib.es6-sakIzgHM.js";import"./mode-BdfAcJv1.js";import"./alert-dialog-DM1h8RhU.js";import{a as Q,c as X,i as Y,n as Z,r as ee}from"./dialog-CEqVOFHc.js";import"./context-BMtIGcq8.js";import"./useNumberFormatter-DynX1ecE.js";import"./numbers-Hxwz5HuE.js";import"./useEvent-d8iQXgui.js";import"./useDebounce-BDmbJDbT.js";import{n as te}from"./ImperativeModal-CmOSTULR.js";import"./strings-DSmr2a_p.js";import"./errors-5BnWGoql.js";import"./copy-DAqXDCGN.js";import"./copy-icon-5DWltDxB.js";import"./purify.es-D83HMRRD.js";import"./useRunCells-uzADaSkg.js";import{t as re}from"./RenderHTML-CUSvJfTV.js";import{n as oe}from"./useAsyncData-CsBCDF11.js";import{n as ie}from"./error-banner-RIuTelB8.js";import{t as F}from"./LazyAnyLanguageCodeMirror-PGusm5pp.js";import{a as se,o as le,r as me,t as ne,u as ae}from"./command-BqJiTpIC.js";import{o as pe}from"./focus-NSCHuycv.js";import{r as ce}from"./textarea-CuEW04Ze.js";import{t as de}from"./empty-state-NyXKwoVS.js";import{t as q}from"./kiosk-mode-C-flD8ND.js";var O=w(T(),1),C=w(P(),1),r=w(H(),1);const he=t=>{let e=(0,O.c)(6),{children:o}=t,{openModal:l,closeModal:m}=te(),s;e[0]!==m||e[1]!==l?(s=()=>l((0,r.jsx)(xe,{onClose:m})),e[0]=m,e[1]=l,e[2]=s):s=e[2];let i;return e[3]!==o||e[4]!==s?(i=(0,r.jsx)(G,{onClick:s,children:o}),e[3]=o,e[4]=s,e[5]=i):i=e[5],i};var fe=[$.lineWrapping],xe=t=>{let e=(0,O.c)(23),{onClose:o}=t,[l,m]=(0,C.useState)(""),{theme:s}=D(),i;e[0]===o?i=e[1]:(i=async a=>{a.preventDefault();let g=new FormData(a.target),k=g.get("title"),_=g.get("description"),N=g.get("code");fetch("https://marimo.io/api/suggest-snippet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:k,description:_,code:N})}),o(),B({title:"Snippet Submitted",description:"Thank you for contributing! We will review your snippet shortly."})},e[0]=o,e[1]=i);let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=(0,r.jsx)(X,{children:"Contribute a Snippet"}),e[2]=p):p=e[2];let y;e[3]===Symbol.for("react.memo_cache_sentinel")?(y=(0,r.jsxs)(Q,{children:[p,(0,r.jsxs)(ee,{children:["Have a useful snippet you want to share with the community? Submit it here or make a pull request"," ",(0,r.jsx)("a",{href:M.githubPage,target:"_blank",className:"underline",children:"on GitHub"}),"."]})]}),e[3]=y):y=e[3];let b,u;e[4]===Symbol.for("react.memo_cache_sentinel")?(b=(0,r.jsx)(U,{id:"title",name:"title",autoFocus:!0,placeholder:"Title",required:!0,autoComplete:"off"}),u=(0,r.jsx)(ce,{id:"description",name:"description",autoFocus:!0,placeholder:"Description",rows:5,required:!0,autoComplete:"off"}),e[4]=b,e[5]=u):(b=e[4],u=e[5]);let c;e[6]===l?c=e[7]:(c=(0,r.jsx)("input",{type:"hidden",name:"code",value:l}),e[6]=l,e[7]=c);let v=s==="dark"?"dark":"light",d;e[8]!==l||e[9]!==v?(d=(0,r.jsx)(F,{theme:v,language:"python",className:"cm border rounded overflow-hidden",extensions:fe,value:l,onChange:m}),e[8]=l,e[9]=v,e[10]=d):d=e[10];let h;e[11]!==c||e[12]!==d?(h=(0,r.jsxs)("div",{className:"flex flex-col gap-6 py-4",children:[b,u,c,d]}),e[11]=c,e[12]=d,e[13]=h):h=e[13];let f;e[14]===o?f=e[15]:(f=(0,r.jsx)(S,{"data-testid":"snippet-cancel-button",variant:"secondary",onClick:o,children:"Cancel"}),e[14]=o,e[15]=f);let x;e[16]===Symbol.for("react.memo_cache_sentinel")?(x=(0,r.jsx)(S,{"data-testid":"snippet-send-button","aria-label":"Save",variant:"default",type:"submit",children:"Send"}),e[16]=x):x=e[16];let n;e[17]===f?n=e[18]:(n=(0,r.jsxs)(Y,{children:[f,x]}),e[17]=f,e[18]=n);let j;return e[19]!==i||e[20]!==n||e[21]!==h?(j=(0,r.jsx)(Z,{className:"w-fit",children:(0,r.jsxs)("form",{onSubmit:i,children:[y,h,n]})}),e[19]=i,e[20]=n,e[21]=h,e[22]=j):j=e[22],j},I=w(T(),1),ue=[$.lineWrapping],je=()=>{let t=(0,I.c)(22),{readSnippets:e}=A(),[o,l]=C.useState(),m;t[0]===e?m=t[1]:(m=()=>e(),t[0]=e,t[1]=m);let s;t[2]===Symbol.for("react.memo_cache_sentinel")?(s=[],t[2]=s):s=t[2];let{data:i,error:p,isPending:y}=oe(m,s);if(p){let a;return t[3]===p?a=t[4]:(a=(0,r.jsx)(ie,{error:p}),t[3]=p,t[4]=a),a}if(y||!i){let a;return t[5]===Symbol.for("react.memo_cache_sentinel")?(a=(0,r.jsx)(L,{size:"medium",centered:!0}),t[5]=a):a=t[5],a}let b=o?"h-1/3":"h-full",u;t[6]===b?u=t[7]:(u=J("border-b rounded-none",b),t[6]=b,t[7]=u);let c;t[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,r.jsx)(se,{placeholder:"Search snippets...",className:"h-6 m-1",rootClassName:"flex-1 border-r"}),t[8]=c):c=t[8];let v,d;t[9]===Symbol.for("react.memo_cache_sentinel")?(v=(0,r.jsxs)("div",{className:"flex items-center w-full",children:[c,(0,r.jsx)(he,{children:(0,r.jsx)("button",{className:"float-right border-b px-2 m-0 h-full hover:bg-accent hover:text-accent-foreground",children:(0,r.jsx)(R,{className:"h-4 w-4"})})})]}),d=(0,r.jsx)(me,{children:"No results"}),t[9]=v,t[10]=d):(v=t[9],d=t[10]);let h;t[11]===Symbol.for("react.memo_cache_sentinel")?(h=a=>l(a),t[11]=h):h=t[11];let f;t[12]===i.snippets?f=t[13]:(f=(0,r.jsx)(ve,{onSelect:h,snippets:i.snippets}),t[12]=i.snippets,t[13]=f);let x;t[14]!==u||t[15]!==f?(x=(0,r.jsxs)(ne,{className:u,children:[v,d,f]}),t[14]=u,t[15]=f,t[16]=x):x=t[16];let n;t[17]===o?n=t[18]:(n=(0,r.jsx)(C.Suspense,{children:(0,r.jsx)("div",{className:"h-2/3 snippet-viewer flex flex-col",children:o?(0,r.jsx)(be,{snippet:o,onClose:()=>l(void 0)},o.title):(0,r.jsx)(de,{title:"",description:"Click on a snippet to view its content."})})}),t[17]=o,t[18]=n);let j;return t[19]!==n||t[20]!==x?(j=(0,r.jsxs)("div",{className:"flex-1 overflow-hidden",children:[x,n]}),t[19]=n,t[20]=x,t[21]=j):j=t[21],j},be=t=>{let e=(0,I.c)(33),{snippet:o,onClose:l}=t,{theme:m}=D(),{createNewCell:s}=W(),i=pe(),p;e[0]!==s||e[1]!==i||e[2]!==o.sections?(p=()=>{for(let g of[...o.sections].reverse())g.code&&s({code:g.code,before:!1,cellId:i??"__end__",skipIfCodeExists:!0})},e[0]=s,e[1]=i,e[2]=o.sections,e[3]=p):p=e[3];let y=p,b;e[4]!==s||e[5]!==i?(b=g=>{s({code:g,before:!1,cellId:i??"__end__"})},e[4]=s,e[5]=i,e[6]=b):b=e[6];let u=b,c;e[7]===o.title?c=e[8]:(c=(0,r.jsx)("span",{children:o.title}),e[7]=o.title,e[8]=c);let v;e[9]===Symbol.for("react.memo_cache_sentinel")?(v=(0,r.jsx)(K,{className:"h-4 w-4"}),e[9]=v):v=e[9];let d;e[10]===l?d=e[11]:(d=(0,r.jsx)(S,{size:"sm",variant:"ghost",onClick:l,className:"h-6 w-6 p-0 hover:bg-muted-foreground/10",children:v}),e[10]=l,e[11]=d);let h;e[12]!==c||e[13]!==d?(h=(0,r.jsxs)("div",{className:"text-sm font-semibold bg-muted border-y px-2 py-1 flex justify-between items-center",children:[c,d]}),e[12]=c,e[13]=d,e[14]=h):h=e[14];let f;e[15]===Symbol.for("react.memo_cache_sentinel")?(f=(0,r.jsx)(E,{className:"ml-2 h-4 w-4"}),e[15]=f):f=e[15];let x;e[16]===y?x=e[17]:(x=(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(q,{children:(0,r.jsxs)(S,{className:"float-right",size:"xs",variant:"outline",onClick:y,children:["Insert snippet",f]})})}),e[16]=y,e[17]=x);let n;if(e[18]!==u||e[19]!==o.sections||e[20]!==o.title||e[21]!==m){let g;e[23]!==u||e[24]!==o.title||e[25]!==m?(g=k=>{let{code:_,html:N,id:z}=k;return N?(0,r.jsx)("div",{children:re({html:N})},`${o.title}-${z}`):_?(0,r.jsxs)("div",{className:"relative hover-actions-parent pr-2",children:[(0,r.jsx)(q,{children:(0,r.jsx)(V,{content:"Insert snippet",children:(0,r.jsx)(S,{className:"absolute -top-2 -right-1 z-10 hover-action px-2 bg-background",size:"sm",variant:"outline",onClick:()=>{u(_)},children:(0,r.jsx)(E,{className:"h-5 w-5"})})})}),(0,r.jsx)(C.Suspense,{children:(0,r.jsx)(F,{theme:m==="dark"?"dark":"light",language:"python",className:"cm border rounded overflow-hidden",extensions:ue,value:_,readOnly:!0},`${o.title}-${z}`)})]},`${o.title}-${z}`):null},e[23]=u,e[24]=o.title,e[25]=m,e[26]=g):g=e[26],n=o.sections.map(g),e[18]=u,e[19]=o.sections,e[20]=o.title,e[21]=m,e[22]=n}else n=e[22];let j;e[27]!==x||e[28]!==n?(j=(0,r.jsxs)("div",{className:"px-2 py-2 space-y-4 overflow-auto flex-1",children:[x,n]}),e[27]=x,e[28]=n,e[29]=j):j=e[29];let a;return e[30]!==j||e[31]!==h?(a=(0,r.jsxs)(r.Fragment,{children:[h,j]}),e[30]=j,e[31]=h,e[32]=a):a=e[32],a},ve=t=>{let e=(0,I.c)(7),{snippets:o,onSelect:l}=t,m;if(e[0]!==l||e[1]!==o){let i;e[3]===l?i=e[4]:(i=p=>(0,r.jsx)(le,{className:"rounded-none",onSelect:()=>l(p),children:(0,r.jsx)("div",{className:"flex flex-row gap-2 items-center",children:(0,r.jsx)("span",{className:"mt-1 text-accent-foreground",children:p.title})})},p.title),e[3]=l,e[4]=i),m=o.map(i),e[0]=l,e[1]=o,e[2]=m}else m=e[2];let s;return e[5]===m?s=e[6]:(s=(0,r.jsx)(ae,{className:"flex flex-col overflow-auto",children:m}),e[5]=m,e[6]=s),s};export{je as default};
